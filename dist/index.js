function e(e,t,n,r,i,u,c){try{var s=e[u](c);var f=s.value}catch(e){n(e);return}if(s.done){t(f)}else{Promise.resolve(f).then(r,i)}}function t(t){return function(){var n=this,r=arguments;return new Promise(function(i,u){var c=t.apply(n,r);function s(t){e(c,i,u,s,o,"next",t)}function o(t){e(c,i,u,s,o,"throw",t)}s(undefined)})}}function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function r(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}function i(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};var i=Object.keys(n);if(typeof Object.getOwnPropertySymbols==="function"){i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))}i.forEach(function(t){r(e,t,n[t])})}return e}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);if(t){r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})}n.push.apply(n,r)}return n}function c(e,t){t=t!=null?t:{};if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}else{u(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function s(e,t){var n,r,i,u,c={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]};return u={next:s(0),"throw":s(1),"return":s(2)},typeof Symbol==="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(e){return function(t){return f([e,t])}}function f(u){if(n)throw new TypeError("Generator is already executing.");while(c)try{if(n=1,r&&(i=u[0]&2?r["return"]:u[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;if(r=0,i)u=[u[0]&2,i.value];switch(u[0]){case 0:case 1:i=u;break;case 4:c.label++;return{value:u[1],done:false};case 5:c.label++;r=u[1];u=[0];continue;case 7:u=c.ops.pop();c.trys.pop();continue;default:if(!(i=c.trys,i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){c=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){c.label=u[1];break}if(u[0]===6&&c.label<i[1]){c.label=i[1];i=u;break}if(i&&c.label<i[2]){c.label=i[2];c.ops.push(u);break}if(i[2])c.ops.pop();c.trys.pop();continue}u=t.call(e,c)}catch(e){u=[6,e];r=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:true}}}import o,{Duration as l}from"edgedb";import{createClient as a}from"edgedb";var f=function e(r){"use strict";n(this,e);this.config=r;var u=this;var a=this;this.create=function(){var e=t(function(e){return s(this,function(n){switch(n.label){case 0:return[4,a.client.transaction(function(){var n=t(function(t){var n,r;return s(this,function(s){switch(s.label){case 0:return[4,u.e.insert(u.eType,e).run(t)];case 1:n=s.sent(),r=n.id;return[4,u.e.select(u.eType,function(){return c(i({},u.eFields),{filter_single:{id:r}})}).run(t)];case 2:return[2,s.sent()]}})});return function(e){return n.apply(this,arguments)}}())];case 1:return[2,n.sent()]}})});return function(t){return e.apply(this,arguments)}}();var f=this;this.updateById=function(){var e=t(function(e,t){return s(this,function(n){switch(n.label){case 0:return[4,f.e.update(f.eType,function(){return{set:t,filter_single:{id:e}}}).run(f.client)];case 1:return[2,n.sent()]}})});return function(t,n){return e.apply(this,arguments)}}();var h=this;this.findAll=t(function(){return s(this,function(e){switch(e.label){case 0:return[4,h.e.select(h.eType,function(){return i({},h.eFields)}).run(h.client)];case 1:return[2,e.sent()]}})});var p=this;this.findById=function(){var e=t(function(e){return s(this,function(t){switch(t.label){case 0:return[4,p.e.select(p.eType,function(){return c(i({},p.eFields),{filter_single:{id:e}})}).run(p.client)];case 1:return[2,t.sent()]}})});return function(t){return e.apply(this,arguments)}}();var y=this;this.deleteById=function(){var e=t(function(e){return s(this,function(t){switch(t.label){case 0:return[4,y.e.delete(y.eType,function(){return{filter_single:{id:e}}}).run(y.client)];case 1:return[2,t.sent()]}})});return function(t){return e.apply(this,arguments)}}();var b=this;this.findByField=function(){var e=t(function(e,t){return s(this,function(n){switch(n.label){case 0:return[4,b.e.select(b.eType,function(n){return c(i({},b.eFields),{filter_single:b.e.op(n[e],"=",b.e.uuid(t))})}).run(b.client)];case 1:return[2,n.sent()]}})});return function(t,n){return e.apply(this,arguments)}}();var d=this;this.findAllByField=function(){var e=t(function(e,t){return s(this,function(n){switch(n.label){case 0:return[4,d.e.select(d.eType,function(n){return c(i({},d.eFields),{filter:d.e.op(n[e],"=",d.e.uuid(t))})}).run(d.client)];case 1:return[2,n.sent()]}})});return function(t,n){return e.apply(this,arguments)}}();var v=this;this.findByFields=function(){var e=t(function(e){return s(this,function(t){switch(t.label){case 0:return[4,v.e.select(v.eType,function(){return c(i({},v.eFields),{filter_single:e})}).run(v.client)];case 1:return[2,t.sent()]}})});return function(t){return e.apply(this,arguments)}}();r.client&&("options"in r.client||(this.client=o(r.client)),this.client=this.client.withConfig({session_idle_transaction_timeout:l.from({seconds:10}),allow_bare_ddl:"AlwaysAllow"}).withRetryOptions({attempts:3,backoff:function(e){return Math.pow(2,e)*100+Math.random()*100}})),this.e=this.config.edgedb,this.typeName=this.config.type,this.eType=this.e[this.typeName],this.eFields=this.eType["*"]};export{f as CRUDService,a as createClient};//# sourceMappingURL=index.js.map