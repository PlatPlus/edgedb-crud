function e(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function t(e){if(Array.isArray(e))return e}function r(t){if(Array.isArray(t))return e(t)}function n(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function i(e,t,r,n,i,a,o){try{var u=e[a](o);var s=u.value}catch(e){r(e);return}if(u.done){t(s)}else{Promise.resolve(s).then(n,i)}}function a(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function u(e){i(o,n,a,u,s,"next",e)}function s(e){i(o,n,a,u,s,"throw",e)}u(undefined)})}}function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t,r){if(N()){u=Reflect.construct}else{u=function e(e,t,r){var n=[null];n.push.apply(n,t);var i=Function.bind.apply(e,n);var a=new i;if(r)k(a,r.prototype);return a}}return u.apply(null,arguments)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function c(e,t,r){if(t)s(e.prototype,t);if(r)s(e,r);return e}function l(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function f(e,t,r){if(typeof Reflect!=="undefined"&&Reflect.get){f=Reflect.get}else{f=function e(e,t,r){var n=M(e,t);if(!n)return;var i=Object.getOwnPropertyDescriptor(n,t);if(i.get){return i.get.call(r||e)}return i.value}}return f(e,t,r||e)}function d(e){d=Object.setPrototypeOf?Object.getPrototypeOf:function e(e){return e.__proto__||Object.getPrototypeOf(e)};return d(e)}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)k(e,t)}function v(e,t){if(t!=null&&typeof Symbol!=="undefined"&&t[Symbol.hasInstance]){return!!t[Symbol.hasInstance](e)}else{return e instanceof t}}function p(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function y(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function b(e,t){var r=e==null?null:typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r==null)return;var n=[];var i=true;var a=false;var o,u;try{for(r=r.call(e);!(i=(o=r.next()).done);i=true){n.push(o.value);if(t&&n.length===t)break}}catch(e){a=true;u=e}finally{try{if(!i&&r["return"]!=null)r["return"]()}finally{if(a)throw u}}return n}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};var n=Object.keys(r);if(typeof Object.getOwnPropertySymbols==="function"){n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))}n.forEach(function(t){l(e,t,r[t])})}return e}function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);if(t){n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})}r.push.apply(r,n)}return r}function E(e,t){t=t!=null?t:{};if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}else{_(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function O(e,t){if(e==null)return{};var r=C(e,t);var n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++){n=a[i];if(t.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;r[n]=e[n]}}return r}function C(e,t){if(e==null)return{};var r={};var n=Object.keys(e);var i,a;for(a=0;a<n.length;a++){i=n[a];if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function S(e,t){if(t&&(D(t)==="object"||typeof t==="function")){return t}return n(e)}function k(e,t){k=Object.setPrototypeOf||function e(e,t){e.__proto__=t;return e};return k(e,t)}function I(e,r){return t(e)||b(e,r)||A(e,r)||g()}function M(e,t){while(!Object.prototype.hasOwnProperty.call(e,t)){e=d(e);if(e===null)break}return e}function P(e){return t(e)||y(e)||A(e)||g()}function T(e){return r(e)||y(e)||A(e)||w()}function D(e){"@swc/helpers - typeof";return e&&typeof Symbol!=="undefined"&&e.constructor===Symbol?"symbol":typeof e}function A(t,r){if(!t)return;if(typeof t==="string")return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor)n=t.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,r)}function j(e){var t=typeof Map==="function"?new Map:undefined;j=function e(e){if(e===null||!p(e))return e;if(typeof e!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof t!=="undefined"){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return u(e,arguments,d(this).constructor)}r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:false,writable:true,configurable:true}});return k(r,e)};return j(e)}function N(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function U(e){var t=N();return function r(){var r=d(e),n;if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else{n=r.apply(this,arguments)}return S(this,n)}}function B(e,t){var r,n,i,a,o={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),"throw":u(1),"return":u(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(e){return function(t){return s([e,t])}}function s(a){if(r)throw new TypeError("Generator is already executing.");while(o)try{if(r=1,n&&(i=a[0]&2?n["return"]:a[0]?n["throw"]||((i=n["return"])&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;if(n=0,i)a=[a[0]&2,i.value];switch(a[0]){case 0:case 1:i=a;break;case 4:o.label++;return{value:a[1],done:false};case 5:o.label++;n=a[1];a=[0];continue;case 7:a=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){o=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(a[0]===6&&o.label<i[1]){o.label=i[1];i=a;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(a);break}if(i[2])o.ops.pop();o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e];n=0}finally{r=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}}var L=Object.create;var R=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var q=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty;var W=function(e){return(typeof require==="undefined"?"undefined":D(require))<"u"?require:(typeof Proxy==="undefined"?"undefined":D(Proxy))<"u"?new Proxy(e,{get:function(e,t){return((typeof require==="undefined"?"undefined":D(require))<"u"?require:e)[t]}}):e}(function(e){if((typeof require==="undefined"?"undefined":D(require))<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var $=function(e,t){return function(){return t||e((t={exports:{}}).exports,t),t.exports}};var Y=function(e,t,r,n){var i=true,a=false,o=undefined;if(t&&typeof t=="object"||typeof t=="function")try{var u=function(){var i=c.value;!H.call(e,i)&&i!==r&&R(e,i,{get:function(){return t[i]},enumerable:!(n=F(t,i))||n.enumerable})};for(var s=x(t)[Symbol.iterator](),c;!(i=(c=s.next()).done);i=true)u()}catch(e){a=true;o=e}finally{try{if(!i&&s.return!=null){s.return()}}finally{if(a){throw o}}}return e};var K=function(e,t,r){return r=e!=null?L(q(e)):{},Y(t||!e||!e.__esModule?R(r,"default",{value:e,enumerable:!0}):r,e)};var V=$(function(e){"use strict";var t=function e(e){var t=e.charCodeAt(0);if(t<=0||t>=255)throw new TypeError('char "'.concat(t,'" is outside ASCII'));return t&255};var r=function e(e){if(e<=0||e>=255)throw new TypeError('char "'.concat(e,'" is outside ASCII'));return String.fromCharCode(e)};Object.defineProperty(e,"__esModule",{value:!0});e.chr=e.ord=e.$v=e.$s=e.$r=e.$p=e.$o=e.$n=e.$m=e.$j=e.$b=e.$Z=e.$Y=e.$X=e.$V=e.$T=e.$S=e.$R=e.$Q=e.$P=e.$O=e.$M=e.$L=e.$K=e.$I=e.$H=e.$E=e.$D=e.$C=e.$A=e.$1=e.$0=void 0;e.$0=t("0");e.$1=t("1");e.$A=t("A");e.$C=t("C");e.$D=t("D");e.$E=t("E");e.$H=t("H");e.$I=t("I");e.$K=t("K");e.$L=t("L");e.$M=t("M");e.$O=t("O");e.$P=t("P");e.$Q=t("Q");e.$R=t("R");e.$S=t("S");e.$T=t("T");e.$V=t("V");e.$X=t("X");e.$Y=t("Y");e.$Z=t("Z");e.$b=t("b");e.$j=t("j");e.$m=t("m");e.$n=t("n");e.$o=t("o");e.$p=t("p");e.$r=t("r");e.$s=t("s");e.$v=t("v");e.ord=t;e.chr=r});var J=$(function(e){"use strict";var t=function e(e){n=e};var r=function e(){if(n==null)throw new Error("JSBI library is required to polyfill BigInt");return n};Object.defineProperty(e,"__esModule",{value:!0});e.remainder=e.lt=e.gte=e.bitand=e.rshift=e.mul=e.div=e.sub=e.add=e.make=e.isBigInt=e.plugJSBI=e.hasNativeBigInt=void 0;var n=null;e.hasNativeBigInt=(typeof BigInt==="undefined"?"undefined":D(BigInt))<"u";e.plugJSBI=t;var i,a,o,u,s,c,l,f,d,h,p;e.hasNativeBigInt?(i=function(e){return(typeof e==="undefined"?"undefined":D(e))=="bigint"},a=function(e){return BigInt(e)},o=function(e,t){return e+t},s=function(e,t){return e-t},u=function(e,t){return e/t},c=function(e,t){return e*t},l=function(e,t){return e>>t},f=function(e,t){return e&t},d=function(e,t){return e>=t},h=function(e,t){return e<t},p=function(e,t){return e%t}):(i=function(e){var t=r();return v(e,t)},a=function(e){return r().BigInt(e)},o=function(e,t){return r().add(e,t)},s=function(e,t){return r().subtract(e,t)},u=function(e,t){return r().divide(e,t)},c=function(e,t){return r().multiply(e,t)},l=function(e,t){return r().signedRightShift(e,t)},f=function(e,t){return r().bitwiseAnd(e,t)},d=function(e,t){return r().greaterThanOrEqual(e,t)},h=function(e,t){return r().lessThan(e,t)},p=function(e,t){return r().remainder(e,t)});e.isBigInt=i;e.make=a;e.add=o;e.sub=s;e.div=u;e.mul=c;e.rshift=l;e.bitand=f;e.gte=d;e.lt=h;e.remainder=p});var G=$(function(e){"use strict";var t=function e(e){if(e.length!==8)throw new Error("expected 8 bytes buffer");var t=Array.from(e),r=!1;t[0]&128&&(t=t.map(function(e){return e^255}),t[t.length-1]++,r=!0);var n="0";var i=true,a=false,o=undefined;try{for(var u=t[Symbol.iterator](),s;!(i=(s=u.next()).done);i=true){var c=s.value;var l=c,f="";for(var d=n.length-1;d>=0;d--){var h=parseInt(n[d],10)*256+l;f=h%10+f,l=Math.floor(h/10)}n=l?l+f:f}}catch(e){a=true;o=e}finally{try{if(!i&&u.return!=null){u.return()}}finally{if(a){throw o}}}return r?"-".concat(n):n};Object.defineProperty(e,"__esModule",{value:!0});e.decodeInt64ToString=void 0;e.decodeInt64ToString=t});var z=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0});e.LegacyHeaderCodes=e.Cardinality=e.OutputFormat=void 0;var i=n(V()),a;(function(e){e[e.BINARY=i.$b]="BINARY",e[e.JSON=i.$j]="JSON",e[e.NONE=i.$n]="NONE"})(a=e.OutputFormat||(e.OutputFormat={}));var o;(function(e){e[e.NO_RESULT=i.$n]="NO_RESULT",e[e.AT_MOST_ONE=i.$o]="AT_MOST_ONE",e[e.ONE=i.$A]="ONE",e[e.MANY=i.$m]="MANY",e[e.AT_LEAST_ONE=i.$M]="AT_LEAST_ONE"})(o=e.Cardinality||(e.Cardinality={}));e.LegacyHeaderCodes={implicitLimit:65281,implicitTypenames:65282,implicitTypeids:65283,allowCapabilities:65284,capabilities:4097,explicitObjectids:65285}});var Q=$(function(e){"use strict";var t=function e(e){var t=new Uint8Array(16);for(var r=0;r<16;r++)t[r]=parseInt(e.slice(r*2,r*2+2),16);return t};var r=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t};Object.defineProperty(e,"__esModule",{value:!0});e.ReadBuffer=e.ReadMessageBuffer=e.uuidToBuffer=e.WriteMessageBuffer=e.WriteBuffer=e.BufferError=e.encodeB64=e.decodeB64=e.utf8Decoder=e.utf8Encoder=void 0;var a=i(V()),u=i(J()),s=i(G()),l=z(),f=4096,d=new Uint8Array(0);e.utf8Encoder=new TextEncoder;e.utf8Decoder=new TextDecoder("utf8");var p;e.decodeB64=p;var y;e.encodeB64=y;(typeof btoa==="undefined"?"undefined":D(btoa))>"u"?(e.decodeB64=p=function(e){return Buffer.from(e,"base64")},e.encodeB64=y=function(e){return Buffer.from(e).toString("base64")}):(e.decodeB64=p=function(e){var t=atob(e),r=t.length,n=new Uint8Array(r);for(var i=0;i<r;i++)n[i]=t.charCodeAt(i);return n},e.encodeB64=y=function(e){var t;var r=(t=String).fromCharCode.apply(t,T(e));return btoa(r)});var b=D(DataView.prototype.getBigInt64)>"u",g=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}return r}(j(Error));e.BufferError=g;var w=function(){function t(){o(this,t);Object.defineProperty(this,"_rawBuffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pos",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.size=f,this.pos=0,this._rawBuffer=new Uint8Array(this.size),this.buffer=new DataView(this._rawBuffer.buffer)}c(t,[{key:"position",get:function e(){return this.pos}},{key:"reset",value:function e(){this.pos=0}},{key:"ensureAlloced",value:function e(e){var t=this.pos+e;t>this.size&&this.__realloc(t)}},{key:"__realloc",value:function e(e){e+=f;var t=new Uint8Array(e);t.set(this._rawBuffer),this._rawBuffer=t,this.buffer=new DataView(this._rawBuffer.buffer),this.size=e}},{key:"writeChar",value:function e(e){return this.ensureAlloced(1),this.buffer.setUint8(this.pos,e),this.pos++,this}},{key:"writeString",value:function t(t){return this.writeBytes(e.utf8Encoder.encode(t))}},{key:"writeBytes",value:function e(e){return this.ensureAlloced(e.length+4),this.buffer.setInt32(this.pos,e.length),this.pos+=4,this._rawBuffer.set(e,this.pos),this.pos+=e.length,this}},{key:"writeInt16",value:function e(e){return this.ensureAlloced(2),this.buffer.setInt16(this.pos,e),this.pos+=2,this}},{key:"writeInt32",value:function e(e){return this.ensureAlloced(4),this.buffer.setInt32(this.pos,e),this.pos+=4,this}},{key:"writeFloat32",value:function e(e){return this.ensureAlloced(4),this.buffer.setFloat32(this.pos,e),this.pos+=4,this}},{key:"writeFloat64",value:function e(e){return this.ensureAlloced(8),this.buffer.setFloat64(this.pos,e),this.pos+=8,this}},{key:"writeUInt8",value:function e(e){return this.ensureAlloced(1),this.buffer.setUint8(this.pos,e),this.pos+=1,this}},{key:"writeUInt16",value:function e(e){return this.ensureAlloced(2),this.buffer.setUint16(this.pos,e),this.pos+=2,this}},{key:"writeUInt32",value:function e(e){return this.ensureAlloced(4),this.buffer.setUint32(this.pos,e),this.pos+=4,this}},{key:"writeInt64",value:function e(e){this.ensureAlloced(8);var t=Math.floor(e/4294967296),r=e-t*4294967296;return this.buffer.setInt32(this.pos,t),this.buffer.setUint32(this.pos+4,r),this.pos+=8,this}},{key:"writeBigInt64",value:function e(e){var t=e;u.lt(t,u.make(0))&&(t=u.add(u.make("18446744073709551616"),e));var r=u.rshift(t,u.make(32)),n=u.bitand(t,u.make(4294967295));return this.writeUInt32(Number(r)),this.writeUInt32(Number(n)),this}},{key:"writeBuffer",value:function e(e){var t=e.length;return this.ensureAlloced(t),this._rawBuffer.set(e,this.pos),this.pos+=t,this}},{key:"unwrap",value:function e(){return this._rawBuffer.subarray(0,this.pos)}}]);return t}();e.WriteBuffer=w;var m=function(){function e(){o(this,e);Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messagePos",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messagePos=-1,this.buffer=new w}c(e,[{key:"reset",value:function e(){return this.messagePos=-1,this.buffer.reset(),this}},{key:"beginMessage",value:function e(e){if(this.messagePos>=0)throw new g("cannot begin a new message: the previous message is not finished");return this.messagePos=this.buffer.position,this.buffer.writeChar(e),this.buffer.writeInt32(0),this}},{key:"endMessage",value:function e(){if(this.messagePos<0)throw new g("cannot end the message: no current message");return this.buffer.buffer.setInt32(this.messagePos+1,this.buffer.position-this.messagePos-1),this.messagePos=-1,this}},{key:"writeLegacyHeaders",value:function e(e){if(this.messagePos<0)throw new g("cannot writeHeaders: no current message");if(!e)return this.buffer.writeUInt16(0),this;var t=Object.entries(e).filter(function(e){var t=I(e,2),r=t[0],n=t[1];return n!==void 0});this.buffer.writeUInt16(t.length);var r=true,n=false,i=undefined;try{for(var a=t[Symbol.iterator](),o;!(r=(o=a.next()).done);r=true){var u=I(o.value,2),s=u[0],c=u[1];if(this.buffer.writeUInt16(l.LegacyHeaderCodes[s]),v(c,Uint8Array))this.buffer.writeUInt32(c.byteLength),this.buffer.writeBuffer(c);else if(typeof c=="string")this.buffer.writeString(c);else throw new g("cannot write header: value is not a Uint8Array or string")}}catch(e){n=true;i=e}finally{try{if(!r&&a.return!=null){a.return()}}finally{if(n){throw i}}}return this}},{key:"writeChar",value:function e(e){if(this.messagePos<0)throw new g("cannot writeChar: no current message");return this.buffer.writeChar(e),this}},{key:"writeString",value:function e(e){if(this.messagePos<0)throw new g("cannot writeString: no current message");return this.buffer.writeString(e),this}},{key:"writeBytes",value:function e(e){if(this.messagePos<0)throw new g("cannot writeBytes: no current message");return this.buffer.writeBytes(e),this}},{key:"writeInt16",value:function e(e){if(this.messagePos<0)throw new g("cannot writeInt16: no current message");return this.buffer.writeInt16(e),this}},{key:"writeInt32",value:function e(e){if(this.messagePos<0)throw new g("cannot writeInt32: no current message");return this.buffer.writeInt32(e),this}},{key:"writeUInt16",value:function e(e){if(this.messagePos<0)throw new g("cannot writeInt16: no current message");return this.buffer.writeUInt16(e),this}},{key:"writeUInt32",value:function e(e){if(this.messagePos<0)throw new g("cannot writeInt32: no current message");return this.buffer.writeUInt32(e),this}},{key:"writeBigInt64",value:function e(e){if(this.messagePos<0)throw new g("cannot writeChar: no current message");return this.buffer.writeBigInt64(e),this}},{key:"writeFlags",value:function e(e,t){if(this.messagePos<0)throw new g("cannot writeChar: no current message");return this.buffer.writeUInt32(e),this.buffer.writeUInt32(t),this}},{key:"writeBuffer",value:function e(e){if(this.messagePos<0)throw new g("cannot writeBuffer: no current message");return this.buffer.writeBuffer(e),this}},{key:"writeSync",value:function e(){if(this.messagePos>=0)throw new g("cannot writeSync: the previous message is not finished");return this.buffer.writeBuffer(_),this}},{key:"writeFlush",value:function e(){if(this.messagePos>=0)throw new g("cannot writeFlush: the previous message is not finished");return this.buffer.writeBuffer(E),this}},{key:"unwrap",value:function e(){if(this.messagePos>=0)throw new g("cannot unwrap: an unfinished message is in the buffer");return this.buffer.unwrap()}}]);return e}();e.WriteMessageBuffer=m;var _=new m().beginMessage(a.$S).endMessage().unwrap(),E=new m().beginMessage(a.$H).endMessage().unwrap(),O=[];for(var C=0;C<256;++C)O.push((C+256).toString(16).slice(1));e.uuidToBuffer=t;var S=function(){function t(){o(this,t);Object.defineProperty(this,"bufs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"len",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buf0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pos0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"len0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"curMessageType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"curMessageLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"curMessageLenUnread",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"curMessageReady",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bufs=[],this.buf0=null,this.pos0=0,this.len0=0,this.len=0,this.curMessageType=0,this.curMessageLen=0,this.curMessageLenUnread=0,this.curMessageReady=!1}c(t,[{key:"length",get:function e(){return this.len}},{key:"feed",value:function e(e){this.buf0==null||this.pos0===this.len0&&this.bufs.length===0?(this.buf0=new DataView(e.buffer,e.byteOffset,e.byteLength),this.len0=e.byteLength,this.pos0=0,this.len=this.len0):this.feedEnqueue(e)}},{key:"feedEnqueue",value:function e(e){this.bufs.push(e),this.len+=e.byteLength}},{key:"ensureFirstBuf",value:function e(){this.pos0===this.len0&&this.__nextBuf();var e=this.buf0;if(e==null||e.byteLength<1)throw new g("empty buffer");return e}},{key:"checkOverread",value:function e(e){if(this.curMessageLenUnread<e||e>this.len)throw new g("buffer overread")}},{key:"__nextBuf",value:function e(){var e=this.bufs.shift();if(e==null)throw new g("buffer overread");this.buf0=new DataView(e.buffer,e.byteOffset,e.byteLength),this.pos0=0,this.len0=e.byteLength}},{key:"discardBuffer",value:function e(e){for(this.ensureFirstBuf();;)if(this.pos0+e>this.len0){var t=this.len0-this.pos0;this.pos0=this.len0,this.len-=t,e-=t,this.ensureFirstBuf()}else{this.pos0+=e,this.len-=e;break}}},{key:"_finishMessage",value:function e(){this.curMessageLen=0,this.curMessageLenUnread=0,this.curMessageReady=!1,this.curMessageType=0}},{key:"__readBufferCopy",value:function e(e,t){var r=new Uint8Array(t),n=0;for(;;)if(this.pos0+t>this.len0){var i=this.len0-this.pos0;r.set(new Uint8Array(e.buffer,e.byteOffset+this.pos0,i),n),n+=i,this.pos0=this.len0,this.len-=i,t-=i,e=this.ensureFirstBuf()}else{r.set(new Uint8Array(e.buffer,e.byteOffset+this.pos0,t),n),this.pos0+=t,this.len-=t;break}return r}},{key:"_readBuffer",value:function e(e){if(e===0)return d;var t=this.ensureFirstBuf();if(this.pos0+e<=this.len0){var r=new Uint8Array(t.buffer,t.byteOffset+this.pos0,e);return this.pos0+=e,this.len-=e,r}return this.__readBufferCopy(t,e)}},{key:"readBuffer",value:function e(e){this.checkOverread(e);var t=this._readBuffer(e);return this.curMessageLenUnread-=e,t}},{key:"readUUID",value:function e(){var e=this.readBuffer(16);return O[e[0]]+O[e[1]]+O[e[2]]+O[e[3]]+O[e[4]]+O[e[5]]+O[e[6]]+O[e[7]]+O[e[8]]+O[e[9]]+O[e[10]]+O[e[11]]+O[e[12]]+O[e[13]]+O[e[14]]+O[e[15]]}},{key:"readChar",value:function e(){this.checkOverread(1);var e=this.ensureFirstBuf().getUint8(this.pos0);return this.pos0++,this.curMessageLenUnread--,this.len--,e}},{key:"readInt16",value:function e(){this.checkOverread(2);var e=this.ensureFirstBuf();if(this.pos0+2<=this.len0){var t=e.getInt16(this.pos0);return this.pos0+=2,this.curMessageLenUnread-=2,this.len-=2,t}var r=this._readBuffer(2);return this.curMessageLenUnread-=2,new DataView(r.buffer,r.byteOffset,r.byteLength).getInt16(0)}},{key:"readInt32",value:function e(){this.checkOverread(4);var e=this.ensureFirstBuf();if(this.pos0+4<=this.len0){var t=e.getInt32(this.pos0);return this.pos0+=4,this.curMessageLenUnread-=4,this.len-=4,t}var r=this._readBuffer(4);return this.curMessageLenUnread-=4,new DataView(r.buffer,r.byteOffset,r.byteLength).getInt32(0)}},{key:"readUInt16",value:function e(){this.checkOverread(2);var e=this.ensureFirstBuf();if(this.pos0+2<=this.len0){var t=e.getUint16(this.pos0);return this.pos0+=2,this.curMessageLenUnread-=2,this.len-=2,t}var r=this._readBuffer(2);return this.curMessageLenUnread-=2,new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0)}},{key:"readUInt32",value:function e(){this.checkOverread(4);var e=this.ensureFirstBuf();if(this.pos0+4<=this.len0){var t=e.getUint32(this.pos0);return this.pos0+=4,this.curMessageLenUnread-=4,this.len-=4,t}var r=this._readBuffer(4);return this.curMessageLenUnread-=4,new DataView(r.buffer,r.byteOffset,r.byteLength).getUint32(0)}},{key:"readBigInt64",value:function e(){this.checkOverread(8);var e=this.ensureFirstBuf();if(this.pos0+8<=this.len0){var t=e.getBigInt64(this.pos0);return this.pos0+=8,this.curMessageLenUnread-=8,this.len-=8,t}var r=this._readBuffer(8);return this.curMessageLenUnread-=8,new DataView(r.buffer,r.byteOffset,r.byteLength).getBigInt64(0)}},{key:"readString",value:function t(){var t=this.readInt32(),r=this.readBuffer(t);return e.utf8Decoder.decode(r)}},{key:"readLenPrefixedBuffer",value:function e(){var e=this.readInt32();return this.readBuffer(e)}},{key:"takeMessage",value:function e(){if(this.curMessageReady)return!0;if(this.curMessageType===0){if(this.len<1)return!1;var e=this.ensureFirstBuf();this.curMessageType=e.getUint8(this.pos0),this.pos0++,this.len--}if(this.curMessageLen===0){if(this.len<4)return!1;var t=this.ensureFirstBuf();if(this.pos0+4<=this.len0)this.curMessageLen=t.getInt32(this.pos0),this.pos0+=4,this.len-=4;else{var r=this._readBuffer(4);this.curMessageLen=new DataView(r.buffer,r.byteOffset,r.byteLength).getInt32(0)}this.curMessageLenUnread=this.curMessageLen-4}return this.len<this.curMessageLenUnread?!1:(this.curMessageReady=!0,!0)}},{key:"getMessageType",value:function e(){return this.curMessageType}},{key:"takeMessageType",value:function e(e){if(this.curMessageReady)return this.curMessageType===e;if(this.len>=1){var t=this.ensureFirstBuf().getUint8(this.pos0);return e===t&&this.takeMessage()}return!1}},{key:"putMessage",value:function e(){if(!this.curMessageReady)throw new g("cannot put message: no message taken");if(this.curMessageLenUnread!==this.curMessageLen-4)throw new g("cannot put message: message is partially read");this.curMessageReady=!1}},{key:"discardMessage",value:function e(){if(!this.curMessageReady)throw new g("no message to discard");this.curMessageLenUnread>0&&this.discardBuffer(this.curMessageLenUnread),this._finishMessage()}},{key:"consumeMessage",value:function e(){if(!this.curMessageReady)throw new g("no message to consume");var e;return this.curMessageLenUnread>0?(e=this._readBuffer(this.curMessageLenUnread),this.curMessageLenUnread=0):e=d,this._finishMessage(),e}},{key:"consumeMessageInto",value:function e(e){if(!this.curMessageReady)throw new g("no message to consume");if(this.curMessageLenUnread>0){if(this.pos0+this.curMessageLenUnread<=this.len0)k.init(e,new Uint8Array(this.buf0.buffer,this.buf0.byteOffset+this.pos0,this.curMessageLenUnread)),this.pos0+=this.curMessageLenUnread,this.len-=this.curMessageLenUnread;else{var t=this._readBuffer(this.curMessageLenUnread);k.init(e,t)}this.curMessageLenUnread=0}else k.init(e,d);this._finishMessage()}},{key:"finishMessage",value:function e(){if(!(this.curMessageType===0||!this.curMessageReady)){if(this.curMessageLenUnread)throw new g('cannot finishMessage: unread data in message "'.concat(a.chr(this.curMessageType),'"'));this._finishMessage()}}}]);return t}();e.ReadMessageBuffer=S;var k=function(){function t(e){o(this,t);Object.defineProperty(this,"_rawBuffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pos",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"len",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._rawBuffer=e,this.buffer=new DataView(e.buffer,e.byteOffset,e.byteLength),this.len=e.length,this.pos=0}c(t,[{key:"position",get:function e(){return this.pos}},{key:"length",get:function e(){return this.len-this.pos}},{key:"finish",value:function e(){if(this.len!==this.pos)throw new g("unexpected trailing data in buffer")}},{key:"discard",value:function e(e){if(this.pos+e>this.len)throw new g("buffer overread");this.pos+=e}},{key:"readUInt8",value:function e(){if(this.pos+1>this.len)throw new g("buffer overread");var e=this.buffer.getUint8(this.pos);return this.pos++,e}},{key:"readUInt16",value:function e(){if(this.pos+2>this.len)throw new g("buffer overread");var e=this.buffer.getUint16(this.pos);return this.pos+=2,e}},{key:"readInt8",value:function e(){if(this.pos+1>this.len)throw new g("buffer overread");var e=this.buffer.getInt8(this.pos);return this.pos++,e}},{key:"readInt16",value:function e(){if(this.pos+2>this.len)throw new g("buffer overread");var e=this.buffer.getInt16(this.pos);return this.pos+=2,e}},{key:"readInt32",value:function e(){if(this.pos+4>this.len)throw new g("buffer overread");var e=this.buffer.getInt32(this.pos);return this.pos+=4,e}},{key:"readFloat32",value:function e(){if(this.pos+4>this.len)throw new g("buffer overread");var e=this.buffer.getFloat32(this.pos);return this.pos+=4,e}},{key:"readFloat64",value:function e(){if(this.pos+8>this.len)throw new g("buffer overread");var e=this.buffer.getFloat64(this.pos);return this.pos+=8,e}},{key:"readUInt32",value:function e(){if(this.pos+4>this.len)throw new g("buffer overread");var e=this.buffer.getUint32(this.pos);return this.pos+=4,e}},{key:"reportInt64Overflow",value:function e(e,t){var r=u.make(e),n=u.make(t>>>0),i=u.add(u.mul(r,u.make(4294967296)),n);throw new g("integer overflow: cannot unpack <std::int64>'".concat(i.toString(),"' into JavaScript Number type without losing precision"))}},{key:"readInt64",value:function e(){if(this.pos+8>this.len)throw new g("buffer overread");var e=this.buffer.getInt32(this.pos),t=this.buffer.getInt32(this.pos+4);return this.pos+=8,e===0?t>>>0:e>=-2097152&&e<2097152?e*4294967296+(t>>>0):this.reportInt64Overflow(e,t)}},{key:"readBigInt64Fallback",value:function e(){if(u.hasNativeBigInt){var e=this.buffer.getUint32(this.pos),t=this.buffer.getUint32(this.pos+4);this.pos+=8;var r=(BigInt(e)<<BigInt(32))+BigInt(t);return e>=2147483648&&(r=BigInt("-18446744073709551616")+r),r}else{var n=this.readBuffer(8),i=s.decodeInt64ToString(n);return u.make(i)}}},{key:"readBigInt64",value:function e(){if(this.pos+8>this.len)throw new g("buffer overread");if(b)return this.readBigInt64Fallback();{var e=this.buffer.getBigInt64(this.pos);return this.pos+=8,e}}},{key:"readBuffer",value:function e(e){if(this.pos+e>this.len)throw new g("buffer overread");var t=this._rawBuffer.subarray(this.pos,this.pos+e);return this.pos+=e,t}},{key:"readUUID",value:function e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(this.pos+16>this.len)throw new g("buffer overread");var t=this._rawBuffer,r=this.pos,n=O[t[r+0]]+O[t[r+1]]+O[t[r+2]]+O[t[r+3]]+e+O[t[r+4]]+O[t[r+5]]+e+O[t[r+6]]+O[t[r+7]]+e+O[t[r+8]]+O[t[r+9]]+e+O[t[r+10]]+O[t[r+11]]+O[t[r+12]]+O[t[r+13]]+O[t[r+14]]+O[t[r+15]];return this.pos+=16,n}},{key:"readString",value:function t(){var t=this.readUInt32(),r=this.readBuffer(t);return e.utf8Decoder.decode(r)}},{key:"consumeAsString",value:function t(){if(this.pos===this.len)return"";var t=e.utf8Decoder.decode(this._rawBuffer.subarray(this.pos,this.len));return this.pos=this.len,t}},{key:"consumeAsBuffer",value:function e(){var e=this._rawBuffer.subarray(this.pos,this.len);return this.pos=this.len,e}},{key:"sliceInto",value:function e(e,t){if(this.pos+t>this.len)throw new g("buffer overread");e._rawBuffer=this._rawBuffer,e.buffer=this.buffer,e.pos=this.pos,e.len=this.pos+t,this.pos+=t}}],[{key:"init",value:function e(e,t){e._rawBuffer=t,e.buffer=new DataView(t.buffer,t.byteOffset,t.byteLength),e.pos=0,e.len=t.byteLength}},{key:"alloc",value:function e(){return new this(d)}}]);return t}();e.ReadBuffer=k});var X=$(function(e){"use strict";var t=function e(e){if(v(e,Uint8Array))try{return parseInt(i.utf8Decoder.decode(e),10)}catch(e){}return null};var r=function e(e,r){var n=t(e.get(u.lineStart)),a=t(e.get(u.lineEnd)),o=t(e.get(u.utf16ColumnStart)),s=t(e.get(u.utf16ColumnEnd));if(n==null||a==null||o==null||s==null)return"";var c=r.split("\n"),l=a.toString().length,f="\n";f+="|".padStart(l+3)+"\n";for(var d=n;d<a+1;d++){var h=c[d-1],v=d===n?o:0,p=d===a?s:h.length;f+=" ".concat(d.toString().padStart(l)," | ").concat(h,"\n"),f+="".concat("|".padStart(l+3)," ").concat("".padStart(p-v,"^").padStart(p),"\n")}return e.has(u.hint)&&(f+="Hint: ".concat(i.utf8Decoder.decode(e.get(u.hint)),"\n")),f};Object.defineProperty(e,"__esModule",{value:!0});e.prettyPrintError=e.EdgeDBError=void 0;var i=Q(),a=function(e){h(i,e);var t=U(i);function i(e,r){o(this,i);var a;a=t.call(this,void 0,r),Object.defineProperty(n(a),"source",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(a),"_message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(a),"_query",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(a),"_attrs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperties(n(a),{_message:{writable:!0,enumerable:!1},_query:{writable:!0,enumerable:!1},_attrs:{writable:!0,enumerable:!1}}),a._message=e!==null&&e!==void 0?e:"";return S(a)}c(i,[{key:"message",get:function e(){return this._message+(this._query&&this._attrs?r(this._attrs,this._query):"")}},{key:"name",get:function e(){return this.constructor.name}},{key:"hasTag",value:function e(e){var t;return!!(!((t=this.constructor.tags)===null||t===void 0)&&t[e])}}]);return i}(j(Error));Object.defineProperty(a,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{}});e.EdgeDBError=a;var u;(function(e){e[e.hint=1]="hint",e[e.details=2]="details",e[e.serverTraceback=257]="serverTraceback",e[e.positionStart=-15]="positionStart",e[e.positionEnd=-14]="positionEnd",e[e.lineStart=-13]="lineStart",e[e.columnStart=-12]="columnStart",e[e.utf16ColumnStart=-11]="utf16ColumnStart",e[e.lineEnd=-10]="lineEnd",e[e.columnEnd=-9]="columnEnd",e[e.utf16ColumnEnd=-8]="utf16ColumnEnd",e[e.characterStart=-7]="characterStart",e[e.characterEnd=-6]="characterEnd"})(u||(u={}));e.prettyPrintError=r});var Z=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SHOULD_RETRY=e.SHOULD_RECONNECT=void 0;e.SHOULD_RECONNECT=Symbol("SHOULD_RECONNECT");e.SHOULD_RETRY=Symbol("SHOULD_RETRY")});var ee=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n},i=e&&e.__exportStar||function(e,r){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0});e.DuplicateDatabaseDefinitionError=e.DuplicateUserDefinitionError=e.DuplicatePropertyDefinitionError=e.DuplicateLinkDefinitionError=e.DuplicateModuleDefinitionError=e.DuplicateDefinitionError=e.InvalidCastDefinitionError=e.InvalidConstraintDefinitionError=e.InvalidFunctionDefinitionError=e.InvalidAliasDefinitionError=e.InvalidOperatorDefinitionError=e.InvalidDatabaseDefinitionError=e.InvalidUserDefinitionError=e.InvalidPropertyDefinitionError=e.InvalidLinkDefinitionError=e.InvalidModuleDefinitionError=e.InvalidDefinitionError=e.SchemaDefinitionError=e.SchemaError=e.UnknownParameterError=e.UnknownDatabaseError=e.UnknownUserError=e.UnknownPropertyError=e.UnknownLinkError=e.UnknownModuleError=e.InvalidReferenceError=e.InvalidPropertyTargetError=e.InvalidLinkTargetError=e.InvalidTargetError=e.InvalidTypeError=e.GraphQLSyntaxError=e.SchemaSyntaxError=e.EdgeQLSyntaxError=e.InvalidSyntaxError=e.QueryError=e.DisabledCapabilityError=e.UnsupportedCapabilityError=e.CapabilityError=e.ResultCardinalityMismatchError=e.StateMismatchError=e.ParameterTypeMismatchError=e.InputDataError=e.UnexpectedMessageError=e.TypeSpecNotFoundError=e.UnsupportedProtocolVersionError=e.BinaryProtocolError=e.ProtocolError=e.UnsupportedFeatureError=e.InternalServerError=e.EdgeDBError=void 0;e.InternalClientError=e.NoDataError=e.InvalidArgumentError=e.UnknownArgumentError=e.MissingArgumentError=e.QueryArgumentError=e.InterfaceError=e.ClientConnectionClosedError=e.ClientConnectionTimeoutError=e.ClientConnectionFailedTemporarilyError=e.ClientConnectionFailedError=e.ClientConnectionError=e.ClientError=e.WarningMessage=e.LogMessage=e.UnsupportedBackendFeatureError=e.BackendError=e.BackendUnavailableError=e.AvailabilityError=e.AuthenticationError=e.AccessError=e.ConfigurationError=e.WatchError=e.TransactionDeadlockError=e.TransactionSerializationError=e.TransactionConflictError=e.TransactionError=e.MissingRequiredError=e.CardinalityViolationError=e.ConstraintViolationError=e.IntegrityError=e.QueryAssertionError=e.AccessPolicyError=e.NumericOutOfRangeError=e.DivisionByZeroError=e.InvalidValueError=e.ExecutionError=e.IdleTransactionTimeoutError=e.TransactionTimeoutError=e.QueryTimeoutError=e.IdleSessionTimeoutError=e.SessionTimeoutError=e.DuplicateMigrationError=e.DuplicateCastDefinitionError=e.DuplicateConstraintDefinitionError=e.DuplicateFunctionDefinitionError=e.DuplicateViewDefinitionError=e.DuplicateOperatorDefinitionError=void 0;var a=X(),u=n(Z()),s=X();Object.defineProperty(e,"EdgeDBError",{enumerable:!0,get:function e(){return s.EdgeDBError}});i(Z(),e);var f=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 16777216}}]);return r}(a.EdgeDBError);e.InternalServerError=f;var d=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 33554432}}]);return r}(a.EdgeDBError);e.UnsupportedFeatureError=d;var v=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50331648}}]);return r}(a.EdgeDBError);e.ProtocolError=v;var p=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50397184}}]);return r}(v);e.BinaryProtocolError=p;var y=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50397185}}]);return r}(p);e.UnsupportedProtocolVersionError=y;var b=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50397186}}]);return r}(p);e.TypeSpecNotFoundError=b;var g=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50397187}}]);return r}(p);e.UnexpectedMessageError=g;var w=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50462720}}]);return r}(v);e.InputDataError=w;var m=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50462976}}]);return r}(w);e.ParameterTypeMismatchError=m;var _=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50463232}}]);return r}(w);Object.defineProperty(_,"tags",{enumerable:!0,configurable:!0,writable:!0,value:l({},u.SHOULD_RETRY,!0)});e.StateMismatchError=_;var E=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50528256}}]);return r}(v);e.ResultCardinalityMismatchError=E;var O=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50593792}}]);return r}(v);e.CapabilityError=O;var C=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50594048}}]);return r}(O);e.UnsupportedCapabilityError=C;var S=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 50594304}}]);return r}(O);e.DisabledCapabilityError=S;var k=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67108864}}]);return r}(a.EdgeDBError);e.QueryError=k;var I=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67174400}}]);return r}(k);e.InvalidSyntaxError=I;var M=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67174656}}]);return r}(I);e.EdgeQLSyntaxError=M;var P=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67174912}}]);return r}(I);e.SchemaSyntaxError=P;var T=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67175168}}]);return r}(I);e.GraphQLSyntaxError=T;var D=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67239936}}]);return r}(k);e.InvalidTypeError=D;var A=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67240192}}]);return r}(D);e.InvalidTargetError=A;var j=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67240193}}]);return r}(A);e.InvalidLinkTargetError=j;var N=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67240194}}]);return r}(A);e.InvalidPropertyTargetError=N;var B=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67305472}}]);return r}(k);e.InvalidReferenceError=B;var L=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67305473}}]);return r}(B);e.UnknownModuleError=L;var R=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67305474}}]);return r}(B);e.UnknownLinkError=R;var F=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67305475}}]);return r}(B);e.UnknownPropertyError=F;var x=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67305476}}]);return r}(B);e.UnknownUserError=x;var q=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67305477}}]);return r}(B);e.UnknownDatabaseError=q;var H=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67305478}}]);return r}(B);e.UnknownParameterError=H;var W=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67371008}}]);return r}(k);e.SchemaError=W;var $=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436544}}]);return r}(k);e.SchemaDefinitionError=$;var Y=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436800}}]);return r}($);e.InvalidDefinitionError=Y;var K=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436801}}]);return r}(Y);e.InvalidModuleDefinitionError=K;var V=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436802}}]);return r}(Y);e.InvalidLinkDefinitionError=V;var J=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436803}}]);return r}(Y);e.InvalidPropertyDefinitionError=J;var G=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436804}}]);return r}(Y);e.InvalidUserDefinitionError=G;var z=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436805}}]);return r}(Y);e.InvalidDatabaseDefinitionError=z;var Q=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436806}}]);return r}(Y);e.InvalidOperatorDefinitionError=Q;var ee=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436807}}]);return r}(Y);e.InvalidAliasDefinitionError=ee;var et=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436808}}]);return r}(Y);e.InvalidFunctionDefinitionError=et;var er=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436809}}]);return r}(Y);e.InvalidConstraintDefinitionError=er;var en=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67436810}}]);return r}(Y);e.InvalidCastDefinitionError=en;var ei=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437056}}]);return r}($);e.DuplicateDefinitionError=ei;var ea=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437057}}]);return r}(ei);e.DuplicateModuleDefinitionError=ea;var eo=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437058}}]);return r}(ei);e.DuplicateLinkDefinitionError=eo;var eu=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437059}}]);return r}(ei);e.DuplicatePropertyDefinitionError=eu;var es=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437060}}]);return r}(ei);e.DuplicateUserDefinitionError=es;var ec=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437061}}]);return r}(ei);e.DuplicateDatabaseDefinitionError=ec;var el=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437062}}]);return r}(ei);e.DuplicateOperatorDefinitionError=el;var ef=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437063}}]);return r}(ei);e.DuplicateViewDefinitionError=ef;var ed=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437064}}]);return r}(ei);e.DuplicateFunctionDefinitionError=ed;var eh=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437065}}]);return r}(ei);e.DuplicateConstraintDefinitionError=eh;var ev=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437066}}]);return r}(ei);e.DuplicateCastDefinitionError=ev;var ep=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67437067}}]);return r}(ei);e.DuplicateMigrationError=ep;var ey=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67502080}}]);return r}(k);e.SessionTimeoutError=ey;var eb=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67502336}}]);return r}(ey);Object.defineProperty(eb,"tags",{enumerable:!0,configurable:!0,writable:!0,value:l({},u.SHOULD_RETRY,!0)});e.IdleSessionTimeoutError=eb;var eg=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67502592}}]);return r}(ey);e.QueryTimeoutError=eg;var ew=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67504640}}]);return r}(ey);e.TransactionTimeoutError=ew;var em=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 67504641}}]);return r}(ew);e.IdleTransactionTimeoutError=em;var e_=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 83886080}}]);return r}(a.EdgeDBError);e.ExecutionError=e_;var eE=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 83951616}}]);return r}(e_);e.InvalidValueError=eE;var eO=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 83951617}}]);return r}(eE);e.DivisionByZeroError=eO;var eC=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 83951618}}]);return r}(eE);e.NumericOutOfRangeError=eC;var eS=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 83951619}}]);return r}(eE);e.AccessPolicyError=eS;var ek=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 83951620}}]);return r}(eE);e.QueryAssertionError=ek;var eI=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 84017152}}]);return r}(e_);e.IntegrityError=eI;var eM=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 84017153}}]);return r}(eI);e.ConstraintViolationError=eM;var eP=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 84017154}}]);return r}(eI);e.CardinalityViolationError=eP;var eT=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 84017155}}]);return r}(eI);e.MissingRequiredError=eT;var eD=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 84082688}}]);return r}(e_);e.TransactionError=eD;var eA=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 84082944}}]);return r}(eD);Object.defineProperty(eA,"tags",{enumerable:!0,configurable:!0,writable:!0,value:l({},u.SHOULD_RETRY,!0)});e.TransactionConflictError=eA;var ej=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 84082945}}]);return r}(eA);Object.defineProperty(ej,"tags",{enumerable:!0,configurable:!0,writable:!0,value:l({},u.SHOULD_RETRY,!0)});e.TransactionSerializationError=ej;var eN=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 84082946}}]);return r}(eA);Object.defineProperty(eN,"tags",{enumerable:!0,configurable:!0,writable:!0,value:l({},u.SHOULD_RETRY,!0)});e.TransactionDeadlockError=eN;var eU=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 84148224}}]);return r}(e_);e.WatchError=eU;var eB=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 100663296}}]);return r}(a.EdgeDBError);e.ConfigurationError=eB;var eL=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 117440512}}]);return r}(a.EdgeDBError);e.AccessError=eL;var eR=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 117506048}}]);return r}(eL);e.AuthenticationError=eR;var eF=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 134217728}}]);return r}(a.EdgeDBError);e.AvailabilityError=eF;var ex=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 134217729}}]);return r}(eF);Object.defineProperty(ex,"tags",{enumerable:!0,configurable:!0,writable:!0,value:l({},u.SHOULD_RETRY,!0)});e.BackendUnavailableError=ex;var eq=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 150994944}}]);return r}(a.EdgeDBError);e.BackendError=eq;var eH=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 150995200}}]);return r}(eq);e.UnsupportedBackendFeatureError=eH;var eW=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4026531840}}]);return r}(a.EdgeDBError);e.LogMessage=eW;var e$=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4026597376}}]);return r}(eW);e.WarningMessage=e$;var eY=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278190080}}]);return r}(a.EdgeDBError);e.ClientError=eY;var eK=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278255616}}]);return r}(eY);e.ClientConnectionError=eK;var eV=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278255872}}]);return r}(eK);e.ClientConnectionFailedError=eV;var eJ=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278255873}}]);return r}(eV);var eG;Object.defineProperty(eJ,"tags",{enumerable:!0,configurable:!0,writable:!0,value:(eG={},l(eG,u.SHOULD_RECONNECT,!0),l(eG,u.SHOULD_RETRY,!0),eG)});e.ClientConnectionFailedTemporarilyError=eJ;var ez=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278256128}}]);return r}(eK);var eQ;Object.defineProperty(ez,"tags",{enumerable:!0,configurable:!0,writable:!0,value:(eQ={},l(eQ,u.SHOULD_RECONNECT,!0),l(eQ,u.SHOULD_RETRY,!0),eQ)});e.ClientConnectionTimeoutError=ez;var eX=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278256384}}]);return r}(eK);var eZ;Object.defineProperty(eX,"tags",{enumerable:!0,configurable:!0,writable:!0,value:(eZ={},l(eZ,u.SHOULD_RECONNECT,!0),l(eZ,u.SHOULD_RETRY,!0),eZ)});e.ClientConnectionClosedError=eX;var e0=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278321152}}]);return r}(eY);e.InterfaceError=e0;var e1=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278321408}}]);return r}(e0);e.QueryArgumentError=e1;var e2=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278321409}}]);return r}(e1);e.MissingArgumentError=e2;var e4=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278321410}}]);return r}(e1);e.UnknownArgumentError=e4;var e3=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278321411}}]);return r}(e1);e.InvalidArgumentError=e3;var e6=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278386688}}]);return r}(eY);e.NoDataError=e6;var e5=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"code",get:function e(){return 4278452224}}]);return r}(eY);e.InternalClientError=e5});var et=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=ee(),r=function e(t,r){o(this,e);Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.key=t,this.value=r,this.next=null,this.prev=null},n=function(){function e(){o(this,e);Object.defineProperty(this,"head",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tail",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"len",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.head=null,this.tail=null,this.len=0}c(e,[{key:"length",get:function e(){return this.len}},{key:"push",value:function e(e,t){var n=new r(e,t);return this.head==null?(this.head=n,this.tail=n):(this.head.prev=n,n.next=this.head,this.head=n),this.len++,n}},{key:"moveToTop",value:function e(e){if(e.prev==null)return;var t=e.prev,r=e.next;t.next=r,r!=null&&(r.prev=t),this.tail===e&&(this.tail=t),e.prev=null,e.next=this.head,this.head.prev=e,this.head=e}},{key:"deleteBottom",value:function e(){if(!this.len||!this.tail||!this.head)return null;if(this.tail===this.head){this.len=0;var e=this.tail;return this.tail=null,this.head=null,e}var t=this.tail,r=this.tail.prev;return r.next=null,this.tail.prev=null,this.tail.next=null,this.tail=r,this.len--,t}}]);return e}(),i=function(){function e(t){var r=t.capacity;o(this,e);if(Object.defineProperty(this,"capacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"map",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"deque",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r<=0)throw new TypeError("capacity is expected to be greater than 0");this.capacity=r,this.map=new Map,this.deque=new n}c(e,[{key:"length",get:function e(){var e=this.map.size;if(e!==this.deque.length)throw new t.InternalClientError("deque & map disagree on elements count");return e}},{key:"has",value:function e(e){return this.map.has(e)}},{key:"get",value:function e(e){var t=this.map.get(e);if(t!=null)return this.deque.moveToTop(t),t.value}},{key:"set",value:function e(e,t){var r=this.map.get(e);if(r!=null)r.value=t,this.deque.moveToTop(r);else{var n=this.deque.push(e,t);for(this.map.set(e,n);this.deque.length>this.capacity;){var i=this.deque.deleteBottom();this.map.delete(i.key)}}}},{key:"keys",value:function e(){var e;return B(this,function(t){switch(t.label){case 0:e=this.deque.head;t.label=1;case 1:if(!(e!=null))return[3,4];return[4,e.key];case 2:t.sent(),e=e.next;t.label=3;case 3:return[3,1];case 4:return[2]}})}},{key:"entries",value:function e(){var e;return B(this,function(t){switch(t.label){case 0:e=this.deque.head;t.label=1;case 1:if(!(e!=null))return[3,4];return[4,[e.key,e.value]];case 2:t.sent(),e=e.next;t.label=3;case 3:return[3,1];case 4:return[2]}})}},{key:"values",value:function e(){var e;return B(this,function(t){switch(t.label){case 0:e=this.deque.head;t.label=1;case 1:if(!(e!=null))return[3,4];return[4,e.value];case 2:t.sent(),e=e.next;t.label=3;case 3:return[3,1];case 4:return[2]}})}}]);return e}();e.default=i});var er=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.AT_LEAST_ONE=e.MANY=e.ONE=e.AT_MOST_ONE=e.NO_RESULT=e.KNOWN_TYPENAMES=e.KNOWN_TYPES=e.INVALID_CODEC_ID=e.NULL_CODEC_ID=void 0;e.NULL_CODEC_ID="00000000000000000000000000000000";e.INVALID_CODEC_ID="ffffffffffffffffffffffffffffffff";e.KNOWN_TYPES=new Map([["00000000000000000000000000000001","anytype"],["00000000000000000000000000000002","anytuple"],["000000000000000000000000000000f0","std"],["000000000000000000000000000000ff","empty-tuple"],["00000000000000000000000000000100","std::uuid"],["00000000000000000000000000000101","std::str"],["00000000000000000000000000000102","std::bytes"],["00000000000000000000000000000103","std::int16"],["00000000000000000000000000000104","std::int32"],["00000000000000000000000000000105","std::int64"],["00000000000000000000000000000106","std::float32"],["00000000000000000000000000000107","std::float64"],["00000000000000000000000000000108","std::decimal"],["00000000000000000000000000000109","std::bool"],["0000000000000000000000000000010a","std::datetime"],["0000000000000000000000000000010b","cal::local_datetime"],["0000000000000000000000000000010c","cal::local_date"],["0000000000000000000000000000010d","cal::local_time"],["0000000000000000000000000000010e","std::duration"],["0000000000000000000000000000010f","std::json"],["00000000000000000000000000000110","std::bigint"],["00000000000000000000000000000111","cal::relative_duration"],["00000000000000000000000000000112","cal::date_duration"],["00000000000000000000000000000130","cfg::memory"],["9565dd8804f511eea6910b6ebe179825","ext::pgvector::vector"]]);e.KNOWN_TYPENAMES=function(){var t=new Map;var r=true,n=false,i=undefined;try{for(var a=e.KNOWN_TYPES.entries()[Symbol.iterator](),o;!(r=(o=a.next()).done);r=true){var u=I(o.value,2),s=u[0],c=u[1];t.set(c,s)}}catch(e){n=true;i=e}finally{try{if(!r&&a.return!=null){a.return()}}finally{if(n){throw i}}}return t}();e.NO_RESULT=110;e.AT_MOST_ONE=111;e.ONE=65;e.MANY=109;e.AT_LEAST_ONE=77});var en=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ScalarCodec=e.Codec=void 0;var t=Q(),r=er(),i=function(){function e(r){o(this,e);Object.defineProperty(this,"tid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tidBuffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tid=r,this.tidBuffer=(0,t.uuidToBuffer)(r)}c(e,[{key:"getKnownTypeName",value:function e(){return"anytype"}}]);return e}();e.Codec=i;var a=function(e){h(i,e);var t=U(i);function i(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;o(this,i);var a;a=t.call(this,e),Object.defineProperty(n(a),"derivedFromTid",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(n(a),"typeName",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(n(a),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"unknown"}),Object.defineProperty(n(a),"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!1}),a.derivedFromTid=r;return S(a)}c(i,[{key:"setTypeName",value:function e(e){this.typeName=e}},{key:"derive",value:function e(e){var t=this.constructor;return new t(e,this.tid)}},{key:"getSubcodecs",value:function e(){return[]}},{key:"getKind",value:function e(){return"scalar"}},{key:"getKnownTypeName",value:function e(){return this.typeName?this.typeName:this.derivedFromTid?r.KNOWN_TYPES.get(this.derivedFromTid):r.KNOWN_TYPES.get(this.tid)||"anytype"}}]);return i}(i);e.ScalarCodec=a});var ei=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.BoolCodec=void 0;var t=en(),r=ee(),i=function(e){h(i,e);var t=U(i);function i(){o(this,i);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"boolean"});return S(e)}c(i,[{key:"encode",value:function e(e,t){var n=typeof t==="undefined"?"undefined":D(t);if(n!=="boolean"&&n!=="number")throw new r.InvalidArgumentError('a boolean or a number was expected, got "'.concat(t,'"'));e.writeInt32(1),e.writeChar(t?1:0)}},{key:"decode",value:function e(e){return e.readUInt8()!==0}}]);return i}(t.ScalarCodec);e.BoolCodec=i});var ea=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0});e.Float64Codec=e.Float32Codec=e.Int16Codec=e.Int32Codec=e.Int64BigintCodec=e.Int64Codec=void 0;var a=i(J()),u=en(),s=ee(),l=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"number"});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(typeof t!="number")throw new s.InvalidArgumentError('a number was expected, got "'.concat(t,'"'));e.writeInt32(8),e.writeInt64(t)}},{key:"decode",value:function e(e){return e.readInt64()}}]);return r}(u.ScalarCodec);e.Int64Codec=l;var f=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"encode",value:function e(e,t){if(!a.isBigInt(t))throw new s.InvalidArgumentError('a bigint was expected, got "'.concat(t,'"'));e.writeInt32(8),e.writeBigInt64(t)}},{key:"decode",value:function e(e){return e.readBigInt64()}}]);return r}(u.ScalarCodec);e.Int64BigintCodec=f;var d=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"number"});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(typeof t!="number")throw new s.InvalidArgumentError('a number was expected, got "'.concat(t,'"'));e.writeInt32(4),e.writeInt32(t)}},{key:"decode",value:function e(e){return e.readInt32()}}]);return r}(u.ScalarCodec);e.Int32Codec=d;var v=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"number"});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(typeof t!="number")throw new s.InvalidArgumentError('a number was expected, got "'.concat(t,'"'));e.writeInt32(2),e.writeInt16(t)}},{key:"decode",value:function e(e){return e.readInt16()}}]);return r}(u.ScalarCodec);e.Int16Codec=v;var p=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"number"});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(typeof t!="number")throw new s.InvalidArgumentError('a number was expected, got "'.concat(t,'"'));e.writeInt32(4),e.writeFloat32(t)}},{key:"decode",value:function e(e){return e.readFloat32()}}]);return r}(u.ScalarCodec);e.Float32Codec=p;var y=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"number"});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(typeof t!="number")throw new s.InvalidArgumentError('a number was expected, got "'.concat(t,'"'));e.writeInt32(8),e.writeFloat64(t)}},{key:"decode",value:function e(e){return e.readFloat64()}}]);return r}(u.ScalarCodec);e.Float64Codec=y});var eo=$(function(e){"use strict";var t=function e(e){var t=e.readUInt16(),r=e.readInt16(),n=e.readUInt16(),i=e.readUInt16(),o="";switch(n){case u:break;case s:o+="-";break;default:throw new a.ProtocolError("bad bigint sign data")}if(i!==0)throw new a.ProtocolError("bigint data has fractional part");if(t===0)return"0";var c=r,l=0;for(;c>=0;){if(c<=r&&l<t){var f=e.readUInt16().toString();o+=l>0?f.padStart(4,"0"):f,l++}else o+="0000";c--}return o};var r=function e(e){var t=e.readUInt16(),r=e.readInt16(),n=e.readUInt16(),i=e.readUInt16(),o="";switch(n){case u:break;case s:o+="-";break;default:throw new a.ProtocolError("bad decimal sign data")}var c=0;if(r<0)c=r+1,o+="0";else for(c=0;c<=r;c++){var l=(c<t?e.readUInt16():0).toString();c>0&&(l=l.padStart(4,"0")),o+=l}if(i>0){o+=".";var f=o.length+i;for(var d=0;d<i;c++,d+=4){var h=c>=0&&c<t?e.readUInt16():0;o+=h.toString().padStart(4,"0")}o=o.slice(0,f)}return o};Object.defineProperty(e,"__esModule",{value:!0});e.DecimalStringCodec=e.BigIntCodec=void 0;var i=en(),a=ee(),u=0,s=16384,l=function(e){h(i,e);var r=U(i);function i(){o(this,i);var e;e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"bigint"});return S(e)}c(i,[{key:"encode",value:function e(e,t){if((typeof t==="undefined"?"undefined":D(t))!="bigint")throw new a.InvalidArgumentError('a bigint was expected, got "'.concat(t,'"'));var r=BigInt("10000"),n=BigInt("0"),i=[],o=u,c=t;if(t===n){e.writeUInt32(8),e.writeUInt32(0),e.writeUInt16(u),e.writeUInt16(0);return}for(t<n&&(o=s,c=-c);c;){var l=c%r;c/=r,i.push(l)}e.writeUInt32(8+i.length*2),e.writeUInt16(i.length),e.writeUInt16(i.length-1),e.writeUInt16(o),e.writeUInt16(0);for(var f=i.length-1;f>=0;f--)e.writeUInt16(Number(i[f]))}},{key:"decode",value:function e(e){return BigInt(t(e))}}]);return i}(i.ScalarCodec);e.BigIntCodec=l;var f=function(e){h(i,e);var t=U(i);function i(){o(this,i);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"string"});return S(e)}c(i,[{key:"encode",value:function e(e,t){if(typeof t!="string")throw new a.InvalidArgumentError('a string was expected, got "'.concat(t,'"'));var r=t.match(/^(-?)([0-9]+)(?:\.([0-9]+))?(?:[eE]([-+]?[0-9]+))?$/);if(!r)throw new a.InvalidArgumentError('invalid decimal string "'.concat(t,'"'));var n=I(r,5),i=n[0],o=n[1],c=n[2],l=n[3],f=n[4],d=l!==null&&l!==void 0?l:"",h=f?parseInt(f,10):0,v=c.padStart(Math.ceil(c.length/4)*4,"0")+d.padEnd(Math.ceil(d.length/4)*4,"0"),p=[];for(var y=0,b=v.length;y<b;y+=4)p.push(parseInt(v.slice(y,y+4),10));e.writeUInt32(8+p.length*2),e.writeUInt16(p.length),e.writeInt16(Math.ceil((c.length+h)/4)-1),e.writeUInt16(o==="-"?s:u),e.writeUInt16(Math.max(d.length-h,0));for(var g=0,w=p.length;g<w;g++)e.writeUInt16(p[g])}},{key:"decode",value:function e(e){return r(e)}}]);return i}(i.ScalarCodec);e.DecimalStringCodec=f});var eu=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.StrCodec=void 0;var t=Q(),r=en(),i=ee(),a=function(e){h(a,e);var r=U(a);function a(){o(this,a);var e;e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"string"});return S(e)}c(a,[{key:"encode",value:function e(e,r){if(typeof r!="string")throw new i.InvalidArgumentError('a string was expected, got "'.concat(r,'"'));var n=r,a=t.utf8Encoder.encode(n);e.writeInt32(a.length),e.writeBuffer(a)}},{key:"decode",value:function e(e){return e.consumeAsString()}}]);return a}(r.ScalarCodec);e.StrCodec=a});var es=$(function(e){"use strict";var t=function e(e){var t=e;if(t.length!==32&&(t=t.replace(/\-/g,""),t.length!==32))throw new TypeError('invalid UUID "'.concat(e,'"'));try{return(0,r.uuidToBuffer)(t)}catch(t){throw new TypeError('invalid UUID "'.concat(e,'"'))}};Object.defineProperty(e,"__esModule",{value:!0});e.UUIDCodec=void 0;var r=Q(),i=en(),a=ee();var u=function(e){h(i,e);var r=U(i);function i(){o(this,i);var e;e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"string"});return S(e)}c(i,[{key:"encode",value:function e(e,r){if(typeof r=="string"){var n=t(r);e.writeInt32(16),e.writeBuffer(n)}else throw new a.InvalidArgumentError('cannot encode UUID "'.concat(r,'": invalid type'))}},{key:"decode",value:function e(e){return e.readUUID("-")}}]);return i}(i.ScalarCodec);e.UUIDCodec=u});var ec=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.BytesCodec=void 0;var t=en(),r=ee(),i=function(e){h(i,e);var t=U(i);function i(){o(this,i);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"Uint8Array"});return S(e)}c(i,[{key:"encode",value:function e(e,t){if(!v(t,Uint8Array))throw new r.InvalidArgumentError('a Uint8Array or Buffer was expected, got "'.concat(t,'"'));e.writeInt32(t.length),e.writeBuffer(t)}},{key:"decode",value:function e(e){return e.consumeAsBuffer()}}]);return i}(t.ScalarCodec);e.BytesCodec=i});var el=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.JSONStringCodec=e.JSONCodec=void 0;var t=Q(),r=en(),i=ee(),a=function(e){h(a,e);var r=U(a);function a(){o(this,a);var e;e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"unknown"});return S(e)}c(a,[{key:"encode",value:function e(e,r){var n;try{n=JSON.stringify(r)}catch(e){throw new i.InvalidArgumentError('a JSON-serializable value was expected, got "'.concat(r,'"'))}if(typeof n!="string")throw new i.InvalidArgumentError('a JSON-serializable value was expected, got "'.concat(r,'"'));var a=t.utf8Encoder.encode(n);e.writeInt32(a.length+1),e.writeChar(1),e.writeBuffer(a)}},{key:"decode",value:function e(e){var t=e.readUInt8();if(t!==1)throw new i.ProtocolError("unexpected JSON format ".concat(t));return JSON.parse(e.consumeAsString())}}]);return a}(r.ScalarCodec);e.JSONCodec=a;var u=function(e){h(n,e);var r=U(n);function n(){o(this,n);return r.apply(this,arguments)}c(n,[{key:"encode",value:function e(e,r){if(typeof r!="string")throw new i.InvalidArgumentError('a string was expected, got "'.concat(r,'"'));var n=t.utf8Encoder.encode(r);e.writeInt32(n.length+1),e.writeChar(1),e.writeBuffer(n)}},{key:"decode",value:function e(e){var t=e.readUInt8();if(t!==1)throw new i.ProtocolError("unexpected JSON format ".concat(t));return e.consumeAsString()}}]);return n}(r.ScalarCodec);e.JSONStringCodec=u});var ef=$(function(e){"use strict";var t=function e(e){return e%4===0&&(e%100!==0||e%400===0)};var r=function e(e,r){return r===2&&t(e)?29:f[r]};var n=function e(e){var t=e-1;return t*365+Math.trunc(t/4)-Math.trunc(t/100)+Math.trunc(t/400)};var i=function e(e,r){return d[r]+(r>2&&t(e)?1:0)};var a=function e(e,t,r){return n(e)+i(e,t)+r};var o=function e(e,t){var r=Math.floor(e/t);return[r,e-t*r]};var u=function e(e){e--;var t;var r;r=I(o(e,s),2),t=r[0],e=r[1],r;var n=t*400+1,i;var a;a=I(o(e,c),2),i=a[0],e=a[1],a;var u;var h;h=I(o(e,l),2),u=h[0],e=h[1],h;var v;var p;if(p=I(o(e,365),2),v=p[0],e=p[1],p,n+=i*100+u*4+v,v===4||i===4)return[n-1,12,31];var y=v===3&&(u!==24||i===3),b=e+50>>5,g=d[b]+(b>2&&y?1:0);return g>e&&(b-=1,g-=f[b]+(b===2&&y?1:0)),e-=g,[n,b,e+1]};Object.defineProperty(e,"__esModule",{value:!0});e.ord2ymd=e.ymd2ord=e.daysBeforeMonth=e.daysInMonth=e.isLeapYear=void 0;e.isLeapYear=t;e.daysInMonth=r;e.daysBeforeMonth=i;var s=n(401),c=n(101),l=n(5),f=[-1,31,28,31,30,31,30,31,31,30,31,30,31],d=function(){var e=[-1],t=0;for(var r=1;r<f.length;r++){var n=f[r];e.push(t),t+=n}return e}();e.ymd2ord=a;e.ord2ymd=u});var ed=$(function(e){"use strict";var t=function e(e){var t=Number(e);return Number.isNaN(t)?0:t};var r=function e(e){if(!Number.isInteger(e))throw new RangeError("unsupported fractional value ".concat(e));return e};var i=function e(e){return(0,b.ymd2ord)(e.year,e.month,e.day)};var a=function e(e){var t=I((0,b.ord2ymd)(e),3),r=t[0],n=t[1],i=t[2];return new w(r,n,i)};var u=function e(e){var t=/(\d+|\d+\.\d+|\.\d+)\s*(hours?|minutes?|seconds?|milliseconds?|ms|h|m|s)\s*/g,r=0,n=new Set,i=t.exec(e),a=0;for(;i;){if(i.index!==a)throw new Error('invalid duration "'.concat(e,'"'));var o=k[i[2].slice(0,3)];if(n.has(o))throw new Error('invalid duration "'.concat(e,'"'));r+=Number(i[1])*o,n.add(o),a=t.lastIndex,i=t.exec(e)}if(a!==e.length)throw new Error('invalid duration "'.concat(e,'"'));return r};var s=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),l=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),p=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return l(t,e),t};Object.defineProperty(e,"__esModule",{value:!0});e.parseHumanDurationString=e.DateDuration=e.RelativeDuration=e.Duration=e.LocalDateTime=e.LocalDateFromOrdinal=e.LocalDateToOrdinal=e.LocalDate=e.LocalTime=e.DATE_PRIVATE=void 0;var y=p(J()),b=ef();e.DATE_PRIVATE=Symbol.for("edgedb.datetime");var g=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;o(this,e);if(Object.defineProperty(this,"_hour",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_minute",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_second",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_millisecond",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_microsecond",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nanosecond",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r=Math.floor(t(r)),n=Math.floor(t(n)),i=Math.floor(t(i)),a=Math.floor(t(a)),u=Math.floor(t(u)),s=Math.floor(t(s)),r<0||r>23)throw new RangeError("invalid number of hours ".concat(r,": expected a value in 0-23 range"));if(n<0||n>59)throw new RangeError("invalid number of minutes ".concat(n,": expected a value in 0-59 range"));if(i<0||i>59)throw new RangeError("invalid number of seconds ".concat(i,": expected a value in 0-59 range"));if(a<0||a>999)throw new RangeError("invalid number of milliseconds ".concat(a,": expected a value in 0-999 range"));if(u<0||u>999)throw new RangeError("invalid number of microseconds ".concat(u,": expected a value in 0-999 range"));if(s<0||s>999)throw new RangeError("invalid number of nanoseconds ".concat(s,": expected a value in 0-999 range"));this._hour=r,this._minute=n,this._second=i,this._millisecond=a,this._microsecond=u,this._nanosecond=s}c(e,[{key:"hour",get:function e(){return this._hour}},{key:"minute",get:function e(){return this._minute}},{key:"second",get:function e(){return this._second}},{key:"millisecond",get:function e(){return this._millisecond}},{key:"microsecond",get:function e(){return this._microsecond}},{key:"nanosecond",get:function e(){return this._nanosecond}},{key:"toString",value:function e(){var e=this._hour.toString().padStart(2,"0"),t=this._minute.toString().padStart(2,"0"),r=this._second.toString().padStart(2,"0"),n="".concat(e,":").concat(t,":").concat(r);return(this._millisecond||this._microsecond||this._nanosecond)&&(n+=".".concat(this._millisecond.toString().padStart(3,"0")).concat(this._microsecond.toString().padStart(3,"0")).concat(this._nanosecond.toString().padStart(3,"0")).replace(/(?:0+)$/,"")),n}},{key:"toJSON",value:function e(){return this.toString()}},{key:"valueOf",value:function e(){throw new TypeError("Not possible to compare LocalTime")}}]);return e}();e.LocalTime=g;var w=function(){function e(r,n,i){o(this,e);if(Object.defineProperty(this,"_date",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r=Math.trunc(t(r)),n=Math.floor(t(n)),i=Math.floor(t(i)),r<-271820||r>275759)throw new RangeError("invalid year ".concat(r,": expected a value in -271820-275759 range"));if(n<1||n>12)throw new RangeError("invalid month ".concat(n,": expected a value in 1-12 range"));var a=(0,b.daysInMonth)(r,n);if(i<1||i>a)throw new RangeError("invalid number of days ".concat(i,": expected a value in 1-").concat(a," range"));this._date=new Date(Date.UTC(r,n-1,i)),r>=0&&r<=99&&this._date.setUTCFullYear(r)}c(e,[{key:"year",get:function e(){return this._date.getUTCFullYear()}},{key:"month",get:function e(){return this._date.getUTCMonth()+1}},{key:"day",get:function e(){return this._date.getUTCDate()}},{key:"dayOfWeek",get:function e(){return(this._date.getUTCDay()+6)%7+1}},{key:"dayOfYear",get:function e(){return(0,b.daysBeforeMonth)(this._date.getUTCFullYear(),this._date.getUTCMonth()+1)+this._date.getUTCDate()}},{key:"daysInWeek",get:function e(){return 7}},{key:"daysInMonth",get:function e(){return(0,b.daysInMonth)(this._date.getUTCFullYear(),this._date.getUTCMonth()+1)}},{key:"daysInYear",get:function e(){return(0,b.isLeapYear)(this._date.getUTCFullYear())?366:365}},{key:"monthsInYear",get:function e(){return 12}},{key:"inLeapYear",get:function e(){return(0,b.isLeapYear)(this._date.getUTCFullYear())}},{key:"toString",value:function e(){var e=this.year<0||this.year>9999?(this.year<0?"-":"+")+Math.abs(this.year).toString().padStart(6,"0"):this.year.toString().padStart(4,"0"),t=this.month.toString().padStart(2,"0"),r=this.day.toString().padStart(2,"0");return"".concat(e,"-").concat(t,"-").concat(r)}},{key:"toJSON",value:function e(){return this.toString()}},{key:"valueOf",value:function e(){throw new TypeError("Not possible to compare LocalDate")}}]);return e}();e.LocalDate=w;e.LocalDateToOrdinal=i;e.LocalDateFromOrdinal=a;var m=function(e){h(r,e);var t=U(r);function r(e,i,a){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,f=arguments.length>7&&arguments[7]!==void 0?arguments[7]:0,d=arguments.length>8&&arguments[8]!==void 0?arguments[8]:0;o(this,r);var h;h=t.call(this,e,i,a),Object.defineProperty(n(h),"_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),h._time=new g(u,s,c,l,f,d);return S(h)}c(r,[{key:"hour",get:function e(){return this._time._hour}},{key:"minute",get:function e(){return this._time._minute}},{key:"second",get:function e(){return this._time._second}},{key:"millisecond",get:function e(){return this._time._millisecond}},{key:"microsecond",get:function e(){return this._time._microsecond}},{key:"nanosecond",get:function e(){return this._time._nanosecond}},{key:"toString",value:function e(){return"".concat(f(d(r.prototype),"toString",this).call(this),"T").concat(this._time.toString())}},{key:"valueOf",value:function e(){throw new TypeError("Not possible to compare LocalDateTime")}}]);return r}(w);e.LocalDateTime=m;var _=new RegExp("^(\\-|\\+)?P(?:(\\d+)Y)?(?:(\\d+)M)?(?:(\\d+)W)?(?:(\\d+)D)?(T(?:(\\d+)(\\.\\d{1,10})?H)?(?:(\\d+)(\\.\\d{1,10})?M)?(?:(\\d+)(\\.\\d{1,9})?S)?)?$","i"),E=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,f=arguments.length>7&&arguments[7]!==void 0?arguments[7]:0,d=arguments.length>8&&arguments[8]!==void 0?arguments[8]:0,h=arguments.length>9&&arguments[9]!==void 0?arguments[9]:0;o(this,e);Object.defineProperty(this,"_years",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_months",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_weeks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_days",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_hours",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_minutes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_seconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_milliseconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_microseconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nanoseconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_sign",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n=r(t(n)),i=r(t(i)),a=r(t(a)),u=r(t(u)),s=r(t(s)),c=r(t(c)),l=r(t(l)),f=r(t(f)),d=r(t(d)),h=r(t(h));var v=[n,i,a,u,s,c,l,f,d,h],p=0;var y=true,b=false,g=undefined;try{for(var w=v[Symbol.iterator](),m;!(y=(m=w.next()).done);y=true){var _=m.value;if(_===1/0||_===-1/0)throw new RangeError("infinite values not allowed as duration fields");var E=Math.sign(_);if(p&&E&&E!==p)throw new RangeError("mixed-sign values not allowed as duration fields");p=p||E}}catch(e){b=true;g=e}finally{try{if(!y&&w.return!=null){w.return()}}finally{if(b){throw g}}}this._years=n||0,this._months=i||0,this._weeks=a||0,this._days=u||0,this._hours=s||0,this._minutes=c||0,this._seconds=l||0,this._milliseconds=f||0,this._microseconds=d||0,this._nanoseconds=h||0,this._sign=p||0}c(e,[{key:"years",get:function e(){return this._years}},{key:"months",get:function e(){return this._months}},{key:"weeks",get:function e(){return this._weeks}},{key:"days",get:function e(){return this._days}},{key:"hours",get:function e(){return this._hours}},{key:"minutes",get:function e(){return this._minutes}},{key:"seconds",get:function e(){return this._seconds}},{key:"milliseconds",get:function e(){return this._milliseconds}},{key:"microseconds",get:function e(){return this._microseconds}},{key:"nanoseconds",get:function e(){return this._nanoseconds}},{key:"sign",get:function e(){return this._sign}},{key:"blank",get:function e(){return this._sign===0}},{key:"toString",value:function e(){var e="";this._years&&(e+=y.make(Math.abs(this._years))+"Y"),this._months&&(e+=y.make(Math.abs(this._months))+"M"),this._weeks&&(e+=y.make(Math.abs(this._weeks))+"W"),this._days&&(e+=y.make(Math.abs(this._days))+"D");var t="";if(this._hours&&(t+=y.make(Math.abs(this._hours))+"H"),this._minutes&&(t+=y.make(Math.abs(this._minutes))+"M"),!e&&!t||this._seconds||this._milliseconds||this._microseconds||this._nanoseconds){var r=y.add(y.add(y.add(y.mul(y.make(Math.abs(this._seconds)),y.make(1e9)),y.mul(y.make(Math.abs(this._milliseconds)),y.make(1e6))),y.mul(y.make(Math.abs(this._microseconds)),y.make(1e3))),y.make(Math.abs(this._nanoseconds))).toString().padStart(10,"0"),n=r.slice(0,-9),i=r.slice(-9).replace(/0+$/,"");t+=n+(i.length?"."+i:"")+"S"}return(this._sign===-1?"-":"")+"P"+e+(t?"T"+t:"")}},{key:"toJSON",value:function e(){return this.toString()}},{key:"valueOf",value:function e(){throw new TypeError("Not possible to compare TemporalDuration")}}],[{key:"from",value:function r(r){var n;if(v(r,e)&&(n=r),typeof r=="object"){if(r.years===void 0&&r.months===void 0&&r.weeks===void 0&&r.days===void 0&&r.hours===void 0&&r.minutes===void 0&&r.seconds===void 0&&r.milliseconds===void 0&&r.microseconds===void 0&&r.nanoseconds===void 0)throw new TypeError("invalid duration-like");n=r}else{var i=String(r),a=i.match(_);if(!a)throw new RangeError("invalid duration: ".concat(i));var o=I(a,13),u=o[0],s=o[1],c=o[2],l=o[3],f=o[4],d=o[5],h=o[6],p=o[7],y=o[8],b=o[9],g=o[10],w=o[11],m=o[12];if(u.length<3||h.length===1)throw new RangeError("invalid duration: ".concat(i));var E=s==="-"?-1:1;if(n={},c&&(n.years=E*Number(c)),l&&(n.months=E*Number(l)),f&&(n.weeks=E*Number(f)),d&&(n.days=E*Number(d)),p&&(n.hours=E*Number(p)),y){if(b||g||w||m)throw new RangeError("only the smallest unit can be fractional");n.minutes=Number(y)*60}else n.minutes=t(b);if(g){if(w||m)throw new RangeError("only the smallest unit can be fractional");n.seconds=Number(g)*60}else w?n.seconds=Number(w):n.seconds=n.minutes%1*60;if(m){var O=m.slice(1).padEnd(9,"0");n.milliseconds=Number(O.slice(0,3)),n.microseconds=Number(O.slice(3,6)),n.nanoseconds=E*Number(O.slice(6))}else n.milliseconds=n.seconds%1*1e3,n.microseconds=n.milliseconds%1*1e3,n.nanoseconds=E*Math.floor(n.microseconds%1*1e3);n.minutes=E*Math.floor(n.minutes),n.seconds=E*Math.floor(n.seconds),n.milliseconds=E*Math.floor(n.milliseconds),n.microseconds=E*Math.floor(n.microseconds)}return new e(n.years,n.months,n.weeks,n.days,n.hours,n.minutes,n.seconds,n.milliseconds,n.microseconds,n.nanoseconds)}}]);return e}();e.Duration=E;var O=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:0,l=arguments.length>8&&arguments[8]!==void 0?arguments[8]:0;o(this,e);Object.defineProperty(this,"_years",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_months",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_weeks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_days",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_hours",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_minutes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_seconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_milliseconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_microseconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._years=Math.trunc(t)||0,this._months=Math.trunc(r)||0,this._weeks=Math.trunc(n)||0,this._days=Math.trunc(i)||0,this._hours=Math.trunc(a)||0,this._minutes=Math.trunc(u)||0,this._seconds=Math.trunc(s)||0,this._milliseconds=Math.trunc(c)||0,this._microseconds=Math.trunc(l)||0}c(e,[{key:"years",get:function e(){return this._years}},{key:"months",get:function e(){return this._months}},{key:"weeks",get:function e(){return this._weeks}},{key:"days",get:function e(){return this._days}},{key:"hours",get:function e(){return this._hours}},{key:"minutes",get:function e(){return this._minutes}},{key:"seconds",get:function e(){return this._seconds}},{key:"milliseconds",get:function e(){return this._milliseconds}},{key:"microseconds",get:function e(){return this._microseconds}},{key:"toString",value:function e(){var e="P";this._years&&(e+="".concat(this._years,"Y")),this._months&&(e+="".concat(this._months,"M"));var t=this._days+7*this._weeks;t&&(e+="".concat(t,"D"));var r="";this._hours&&(r+="".concat(this._hours,"H")),this._minutes&&(r+="".concat(this._minutes,"M"));var n=this._seconds+this._milliseconds/1e3+this._microseconds/1e6;return n!==0&&(r+="".concat(n,"S")),r&&(e+="T".concat(r)),e==="P"?"PT0S":e}},{key:"toJSON",value:function e(){return this.toString()}},{key:"valueOf",value:function e(){throw new TypeError("Not possible to compare RelativeDuration")}}]);return e}();e.RelativeDuration=O;var C=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;o(this,e);Object.defineProperty(this,"_years",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_months",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_weeks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_days",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._years=Math.trunc(t)||0,this._months=Math.trunc(r)||0,this._weeks=Math.trunc(n)||0,this._days=Math.trunc(i)||0}c(e,[{key:"years",get:function e(){return this._years}},{key:"months",get:function e(){return this._months}},{key:"weeks",get:function e(){return this._weeks}},{key:"days",get:function e(){return this._days}},{key:"toString",value:function e(){var e="P";this._years&&(e+="".concat(this._years,"Y")),this._months&&(e+="".concat(this._months,"M"));var t=this._days+7*this._weeks;return t&&(e+="".concat(t,"D")),e==="P"?"PT0S":e}},{key:"toJSON",value:function e(){return this.toString()}},{key:"valueOf",value:function e(){throw new TypeError("Not possible to compare DateDuration")}}]);return e}();e.DateDuration=C;var k={h:36e5,hou:36e5,m:6e4,min:6e4,s:1e3,sec:1e3,ms:1,mil:1};e.parseHumanDurationString=u});var eh=$(function(e){"use strict";var t=function e(e){var t=true,r=false,n=undefined;try{for(var i=_[Symbol.iterator](),a;!(t=(a=i.next()).done);t=true){var o=a.value;if(e[o]!==0)return o}}catch(e){r=true;n=e}finally{try{if(!t&&i.return!=null){i.return()}}finally{if(r){throw n}}}return null};var r=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),i=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e,"__esModule",{value:!0});e.DateDurationCodec=e.RelativeDurationCodec=e.DurationCodec=e.checkValidEdgeDBDuration=e.LocalTimeCodec=e.LocalDateCodec=e.LocalDateTimeCodec=e.DateTimeCodec=void 0;var u=en(),s=a(J()),l=ed(),f=ef(),d=ee(),p=9466848e5,y=(0,f.ymd2ord)(2e3,1,1),b=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"Date"});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(!v(t,Date))throw new d.InvalidArgumentError('a Date instance was expected, got "'.concat(t,'"'));var r=(t.getTime()-p)*1e3;e.writeInt32(8),e.writeInt64(r)}},{key:"decode",value:function e(e){var t=Number(e.readBigInt64()),r=Math.round(t/1e3);return Math.abs(t%1e3)===500&&Math.abs(r)%2===1&&(r-=1),new Date(r+p)}}]);return r}(u.ScalarCodec);e.DateTimeCodec=b;var g=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"LocalDateTime"}),Object.defineProperty(n(e),"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(!v(t,l.LocalDateTime))throw new d.InvalidArgumentError('a LocalDateTime instance was expected, got "'.concat(t,'"'));var r=s.make(t._date.getTime()-p),n=s.add(s.mul(r,s.make(1e3)),s.make(t.hour*36e8+t.minute*6e7+t.second*1e6+t.millisecond*1e3+t.microsecond));(t.nanosecond===500&&Math.abs(t.microsecond)%2===1||t.nanosecond>500)&&(n=s.add(n,s.make(1))),e.writeInt32(8),e.writeBigInt64(n)}},{key:"decode",value:function e(e){var t=s.make(1e3),r=e.readBigInt64(),n=s.div(r,t),i=Number(s.sub(r,s.mul(n,t))),a=Number(n);i<0&&(i+=1e3,a-=1);var o=new Date(Number(a)+p);return new l.LocalDateTime(o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCMilliseconds(),i)}}]);return r}(u.ScalarCodec);e.LocalDateTimeCodec=g;var w=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"LocalDate"}),Object.defineProperty(n(e),"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(!v(t,l.LocalDate))throw new d.InvalidArgumentError('a LocalDate instance was expected, got "'.concat(t,'"'));e.writeInt32(4),e.writeInt32((0,l.LocalDateToOrdinal)(t)-y)}},{key:"decode",value:function e(e){var t=e.readInt32();return(0,l.LocalDateFromOrdinal)(t+y)}}]);return r}(u.ScalarCodec);e.LocalDateCodec=w;var m=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"LocalTime"}),Object.defineProperty(n(e),"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(!v(t,l.LocalTime))throw new d.InvalidArgumentError('a LocalTime instance was expected, got "'.concat(t,'"'));var r=t.hour*36e8+t.minute*6e7+t.second*1e6+t.millisecond*1e3+t.microsecond;(t.nanosecond===500&&r%2===1||t.nanosecond>500)&&(r+=1),e.writeInt32(8),e.writeInt64(r)}},{key:"decode",value:function e(e){var t=Number(e.readBigInt64()),r=Math.floor(t/1e6),n=Math.floor(t%1e6/1e3);t=t%1e6-n*1e3;var i=Math.floor(r/60);r=Math.floor(r%60);var a=Math.floor(i/60);return i=Math.floor(i%60),new l.LocalTime(a,i,r,n,t)}}]);return r}(u.ScalarCodec);e.LocalTimeCodec=m;var _=["years","months","weeks","days"];e.checkValidEdgeDBDuration=t;var E=function(e){h(i,e);var r=U(i);function i(){o(this,i);var e;e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"Duration"}),Object.defineProperty(n(e),"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0});return S(e)}c(i,[{key:"encode",value:function e(e,r){if(!v(r,l.Duration))throw new d.InvalidArgumentError('a Duration instance was expected, got "'.concat(r,'"'));var n=t(r);if(n)throw new d.InvalidArgumentError("Cannot encode a 'Duration' with a non-zero number of ".concat(n));var i=s.make(Math.abs(r.microseconds));i=s.add(i,s.mul(s.make(Math.abs(r.milliseconds)),s.make(1e3))),i=s.add(i,s.mul(s.make(Math.abs(r.seconds)),s.make(1e6))),i=s.add(i,s.mul(s.make(Math.abs(r.minutes)),s.make(6e7))),i=s.add(i,s.mul(s.make(Math.abs(r.hours)),s.make(36e8))),(Math.abs(r.nanoseconds)===500&&Math.abs(r.microseconds)%2===1||Math.abs(r.nanoseconds)>500)&&(i=s.add(i,s.make(1))),r.sign<0&&(i=s.mul(i,s.make(-1))),e.writeInt32(16),e.writeBigInt64(i),e.writeInt32(0),e.writeInt32(0)}},{key:"decode",value:function e(e){var t=e.readBigInt64(),r=e.readInt32(),n=e.readInt32();if(r!==0)throw new d.ProtocolError("non-zero reserved bytes in duration");if(n!==0)throw new d.ProtocolError("non-zero reserved bytes in duration");var i=1;Number(t)<0&&(i=-1,t=s.mul(s.make(-1),t));var a=s.make(1e6),o=s.div(t,a),u=Number(s.sub(t,s.mul(o,a))),c=Math.floor(u/1e3);u=u%1e3;var f=Number(o),h=Math.floor(f/60);f=Math.floor(f%60);var v=Math.floor(h/60);return h=Math.floor(h%60),new l.Duration(0,0,0,0,v*i,h*i,f*i,c*i,u*i)}}]);return i}(u.ScalarCodec);e.DurationCodec=E;var O=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"RelativeDuration"}),Object.defineProperty(n(e),"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(!v(t,l.RelativeDuration))throw new d.InvalidArgumentError('\n        a RelativeDuration instance was expected, got "'.concat(t,'"\n      '));var r=s.make(t.microseconds);r=s.add(r,s.mul(s.make(t.milliseconds),s.make(1e3))),r=s.add(r,s.mul(s.make(t.seconds),s.make(1e6))),r=s.add(r,s.mul(s.make(t.minutes),s.make(6e7))),r=s.add(r,s.mul(s.make(t.hours),s.make(36e8))),e.writeInt32(16),e.writeBigInt64(r),e.writeInt32(t.days+7*t.weeks),e.writeInt32(t.months+12*t.years)}},{key:"decode",value:function e(e){var t=e.readBigInt64(),r=e.readInt32(),n=e.readInt32(),i=1;Number(t)<0&&(i=-1,t=s.mul(s.make(-1),t));var a=s.make(1e6),o=s.div(t,a),u=Number(s.sub(t,s.mul(o,a))),c=Math.trunc(u/1e3);u=u%1e3;var f=Number(o),d=Math.trunc(f/60);f=Math.trunc(f%60);var h=Math.trunc(d/60);d=Math.trunc(d%60);var v=Math.trunc(r/7);r=Math.trunc(r%7);var p=Math.trunc(n/12);return n=Math.trunc(n%12),new l.RelativeDuration(p,n,v,r,h*i,d*i,f*i,c*i,u*i)}}]);return r}(u.ScalarCodec);e.RelativeDurationCodec=O;var C=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"DateDuration"}),Object.defineProperty(n(e),"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0});return S(e)}c(r,[{key:"encode",value:function e(e,t){if(!v(t,l.DateDuration))throw new d.InvalidArgumentError('\n        a DateDuration instance was expected, got "'.concat(t,'"\n      '));e.writeInt32(16),e.writeInt64(0),e.writeInt32(t.days+7*t.weeks),e.writeInt32(t.months+12*t.years)}},{key:"decode",value:function e(e){e.discard(8);var t=e.readInt32(),r=e.readInt32(),n=Math.trunc(t/7);t=Math.trunc(t%7);var i=Math.trunc(r/12);return r=Math.trunc(r%12),new l.DateDuration(i,r,n,t)}}]);return r}(u.ScalarCodec);e.DateDurationCodec=C});var ev=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0});e.ConfigMemory=void 0;var i=n(J()),a=1024,u=1024*a,s=1024*u,l=1024*s,f=1024*l,d=function(){function e(t){o(this,e);Object.defineProperty(this,"_bytes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._bytes=t}c(e,[{key:"bytes",get:function e(){return Number(this._bytes)}},{key:"bytesBigInt",get:function e(){return this._bytes}},{key:"kibibytes",get:function e(){return Number(this._bytes)/a}},{key:"mebibytes",get:function e(){return Number(this._bytes)/u}},{key:"gibibytes",get:function e(){return Number(this._bytes)/s}},{key:"tebibytes",get:function e(){return Number(this._bytes)/l}},{key:"pebibytes",get:function e(){return Number(this._bytes)/f}},{key:"toString",value:function e(){var e=this._bytes,t=i.make(f);if(i.gte(e,t)&&Number(i.remainder(e,t))===0)return"".concat(i.div(e,t),"PiB");var r=i.make(l);if(i.gte(e,r)&&Number(i.remainder(e,r))===0)return"".concat(i.div(e,r),"TiB");var n=i.make(s);if(i.gte(e,n)&&Number(i.remainder(e,n))===0)return"".concat(i.div(e,n),"GiB");var o=i.make(u);if(i.gte(e,o)&&Number(i.remainder(e,o))===0)return"".concat(i.div(e,o),"MiB");var c=i.make(a);return i.gte(e,c)&&Number(i.remainder(e,c))===0?"".concat(i.div(e,c),"KiB"):"".concat(e,"B")}}]);return e}();e.ConfigMemory=d});var ep=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ConfigMemoryCodec=void 0;var t=en(),r=ev(),i=ee(),a=function(e){h(a,e);var t=U(a);function a(){o(this,a);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"ConfigMemory"}),Object.defineProperty(n(e),"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0});return S(e)}c(a,[{key:"encode",value:function e(e,t){if(!v(t,r.ConfigMemory))throw new i.InvalidArgumentError('a ConfigMemory instance was expected, got "'.concat(t,'"'));e.writeInt32(8),e.writeBigInt64(t._bytes)}},{key:"decode",value:function e(e){return new r.ConfigMemory(e.readBigInt64())}}]);return a}(t.ScalarCodec);e.ConfigMemoryCodec=a});var ey=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.PgVectorCodec=e.PG_VECTOR_MAX_DIM=void 0;var t=en(),r=ee();e.PG_VECTOR_MAX_DIM=65536-1;var i=function(t){h(a,t);var i=U(a);function a(){o(this,a);var e;e=i.call.apply(i,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"Float32Array"});return S(e)}c(a,[{key:"encode",value:function t(t,n){if(!(v(n,Float32Array)||Array.isArray(n)))throw new r.InvalidArgumentError('a Float32Array or array of numbers was expected, got "'.concat(n,'"'));if(n.length>e.PG_VECTOR_MAX_DIM)throw new r.InvalidArgumentError("too many elements in array to encode into pgvector");var i=true,a=false,o=undefined,u=true,s=false,c=undefined;if(t.writeInt32(4+n.length*4).writeUInt16(n.length).writeUInt16(0),v(n,Float32Array))try{for(var l=n[Symbol.iterator](),f;!(i=(f=l.next()).done);i=true){var d=f.value;t.writeFloat32(d)}}catch(e){a=true;o=e}finally{try{if(!i&&l.return!=null){l.return()}}finally{if(a){throw o}}}else try{for(var h=n[Symbol.iterator](),p;!(u=(p=h.next()).done);u=true){var y=p.value;if(typeof y!="number")throw new r.InvalidArgumentError('elements of vector array expected to be a numbers, got "'.concat(y,'"'));t.writeFloat32(y)}}catch(e){s=true;c=e}finally{try{if(!u&&h.return!=null){h.return()}}finally{if(s){throw c}}}}},{key:"decode",value:function e(e){var t=e.readUInt16();e.discard(2);var r=e.readBuffer(t*4),n=new DataView(r.buffer,r.byteOffset,r.byteLength),i=new Float32Array(t);for(var a=0;a<t;a++)i[a]=n.getFloat32(a*4);return i}}]);return a}(t.ScalarCodec);e.PgVectorCodec=i});var eb=$(function(e){"use strict";var t=function t(t,r){var n=g.KNOWN_TYPENAMES.get(t);if(n==null)throw new b.InternalClientError("unknown type name");e.SCALAR_CODECS.set(n,new r(n))};Object.defineProperty(e,"__esModule",{value:!0});e.INVALID_CODEC=e.NULL_CODEC=e.SCALAR_CODECS=e.NullCodec=void 0;var r=Q(),n=ei(),i=en(),a=ea(),u=eo(),s=eu(),l=es(),f=ec(),d=el(),v=eh(),p=ep(),y=ey(),b=ee(),g=er(),w=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"encode",value:function e(e,t){throw new b.InternalClientError("null codec cannot used to encode data")}},{key:"decode",value:function e(e){throw new b.InternalClientError("null codec cannot used to decode data")}},{key:"getSubcodecs",value:function e(){return[]}},{key:"getKind",value:function e(){return"scalar"}}]);return r}(i.Codec);Object.defineProperty(w,"BUFFER",{enumerable:!0,configurable:!0,writable:!0,value:new r.WriteBuffer().writeInt32(0).unwrap()});e.NullCodec=w;e.SCALAR_CODECS=new Map;e.NULL_CODEC=new w(g.NULL_CODEC_ID);e.INVALID_CODEC=new w(g.INVALID_CODEC_ID);t("std::int16",a.Int16Codec);t("std::int32",a.Int32Codec);t("std::int64",a.Int64Codec);t("std::float32",a.Float32Codec);t("std::float64",a.Float64Codec);t("std::bigint",u.BigIntCodec);t("std::decimal",u.DecimalStringCodec);t("std::bool",n.BoolCodec);t("std::json",d.JSONCodec);t("std::str",s.StrCodec);t("std::bytes",f.BytesCodec);t("std::uuid",l.UUIDCodec);t("cal::local_date",v.LocalDateCodec);t("cal::local_time",v.LocalTimeCodec);t("cal::local_datetime",v.LocalDateTimeCodec);t("std::datetime",v.DateTimeCodec);t("std::duration",v.DurationCodec);t("cal::relative_duration",v.RelativeDurationCodec);t("cal::date_duration",v.DateDurationCodec);t("cfg::memory",p.ConfigMemoryCodec);t("ext::pgvector::vector",y.PgVectorCodec)});var eg=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.EMPTY_TUPLE_CODEC=e.EMPTY_TUPLE_CODEC_ID=e.EmptyTupleCodec=e.TupleCodec=void 0;var t=er(),r=en(),i=Q(),a=ee(),u=function(e){h(r,e);var t=U(r);function r(e,i){o(this,r);var a;a=t.call(this,e),Object.defineProperty(n(a),"subCodecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.subCodecs=i;return S(a)}c(r,[{key:"encode",value:function e(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!Array.isArray(t))throw new a.InvalidArgumentError('an array was expected, got "'.concat(t,'"'));var n=this.subCodecs,o=n.length;if(t.length!==o)throw new a.InvalidArgumentError("expected ".concat(o," tuple item").concat(o===1?"":"s",", got ").concat(t.length));o||e.writeBuffer(s.BUFFER);var u=new i.WriteBuffer;for(var c=0;c<o;c++){var l=t[c];if(u.writeInt32(0),l==null)if(r)u.writeInt32(-1);else throw new a.MissingArgumentError("element at index ".concat(c," in tuple cannot be 'null'"));else try{n[c].encode(u,l)}catch(e){throw v(e,a.QueryArgumentError)?new a.InvalidArgumentError("invalid element at index ".concat(c," in tuple: ").concat(e.message)):e}}var f=u.unwrap();e.writeInt32(4+f.length),e.writeInt32(o),e.writeBuffer(f)}},{key:"encodeArgs",value:function e(e){if(!Array.isArray(e))throw new a.InvalidArgumentError("an array of arguments was expected");var t=this.subCodecs.length;if(e.length!==t)throw new a.InvalidArgumentError("expected ".concat(t," argument").concat(t===1?"":"s",", got ").concat(e.length));var r=new i.WriteBuffer;return this.encode(r,e,!0),r.unwrap()}},{key:"decode",value:function e(e){var t=e.readUInt32(),r=this.subCodecs;if(t!==r.length)throw new a.ProtocolError("cannot decode Tuple: expected ".concat(r.length," elements, got ").concat(t));var n=i.ReadBuffer.alloc(),o=new Array(t);for(var u=0;u<t;u++){e.discard(4);var s=e.readInt32();s===-1?o[u]=null:(e.sliceInto(n,s),o[u]=r[u].decode(n),n.finish())}return o}},{key:"getSubcodecs",value:function e(){return Array.from(this.subCodecs)}},{key:"getKind",value:function e(){return"tuple"}}]);return r}(r.Codec);e.TupleCodec=u;var s=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"encode",value:function e(e,t){if(!Array.isArray(t))throw new a.InvalidArgumentError("cannot encode empty Tuple: expected an array");if(t.length)throw new a.InvalidArgumentError("cannot encode empty Tuple: expected 0 elements got ".concat(t.length));e.writeInt32(4),e.writeInt32(0)}},{key:"decode",value:function e(e){var t=e.readInt32();if(t!==0)throw new a.ProtocolError("cannot decode empty Tuple: expected 0 elements, received ".concat(t));return[]}},{key:"getSubcodecs",value:function e(){return[]}},{key:"getKind",value:function e(){return"tuple"}}]);return r}(r.Codec);Object.defineProperty(s,"BUFFER",{enumerable:!0,configurable:!0,writable:!0,value:new i.WriteBuffer().writeInt32(4).writeInt32(0).unwrap()});e.EmptyTupleCodec=s;e.EMPTY_TUPLE_CODEC_ID=t.KNOWN_TYPENAMES.get("empty-tuple");e.EMPTY_TUPLE_CODEC=new s(e.EMPTY_TUPLE_CODEC_ID)});var ew=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Range=void 0;var t=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;o(this,e);Object.defineProperty(this,"_lower",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_upper",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_incLower",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_incUpper",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_isEmpty",{enumerable:!0,configurable:!0,writable:!0,value:!1})}c(e,[{key:"lower",get:function e(){return this._lower}},{key:"upper",get:function e(){return this._upper}},{key:"incLower",get:function e(){return this._incLower}},{key:"incUpper",get:function e(){return this._incUpper}},{key:"isEmpty",get:function e(){return this._isEmpty}},{key:"toJSON",value:function e(){return this.isEmpty?{empty:!0}:{lower:this._lower,upper:this._upper,inc_lower:this._incLower,inc_upper:this._incUpper}}}],[{key:"empty",value:function t(){var t=new e(null,null);return t._isEmpty=!0,t}}]);return e}();e.Range=t});var em=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.RangeCodec=void 0;var t=en(),r=Q(),i=ew(),a=ee(),u;(function(e){e[e.EMPTY=1]="EMPTY",e[e.INC_LOWER=2]="INC_LOWER",e[e.INC_UPPER=4]="INC_UPPER",e[e.EMPTY_LOWER=8]="EMPTY_LOWER",e[e.EMPTY_UPPER=16]="EMPTY_UPPER"})(u||(u={}));var s=function(e){h(s,e);var t=U(s);function s(e,r){o(this,s);var i;i=t.call(this,e),Object.defineProperty(n(i),"subCodec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.subCodec=r;return S(i)}c(s,[{key:"encode",value:function e(e,t){if(!v(t,i.Range))throw new a.InvalidArgumentError("a Range was expected");var n=this.subCodec,o=new r.WriteBuffer;t.lower!==null&&n.encode(o,t.lower),t.upper!==null&&n.encode(o,t.upper);var s=o.unwrap();e.writeInt32(1+s.length),e.writeUInt8(t.isEmpty?u.EMPTY:(t.incLower?u.INC_LOWER:0)|(t.incUpper?u.INC_UPPER:0)|(t.lower===null?u.EMPTY_LOWER:0)|(t.upper===null?u.EMPTY_UPPER:0)),e.writeBuffer(s)}},{key:"decode",value:function e(e){var t=e.readUInt8();if(t&u.EMPTY)return i.Range.empty();var n=r.ReadBuffer.alloc(),a=this.subCodec,o=null,s=null;return t&u.EMPTY_LOWER||(e.sliceInto(n,e.readInt32()),o=a.decode(n),n.finish()),t&u.EMPTY_UPPER||(e.sliceInto(n,e.readInt32()),s=a.decode(n),n.finish()),new i.Range(o,s,!!(t&u.INC_LOWER),!!(t&u.INC_UPPER))}},{key:"getSubcodecs",value:function e(){return[this.subCodec]}},{key:"getKind",value:function e(){return"range"}}]);return s}(t.Codec);e.RangeCodec=s});var e_=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.NamedTupleCodec=void 0;var t=en(),r=Q(),i=eg(),a=ee(),u=function(e){h(u,e);var t=U(u);function u(e,r,i){o(this,u);var a;a=t.call(this,e),Object.defineProperty(n(a),"subCodecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(a),"names",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(a),"namesSet",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.subCodecs=r,a.names=i,a.namesSet=new Set(i);return S(a)}c(u,[{key:"encode",value:function e(e,t){if(typeof t!="object"||Array.isArray(t))throw new a.InvalidArgumentError('an object was expected, got "'.concat(t,'"'));var n=this.subCodecs.length;if(Object.keys(t).length!==n)throw new a.QueryArgumentError("expected ".concat(n," element").concat(n===1?"":"s"," in named tuple, got ").concat(Object.keys(t).length));var i=new r.WriteBuffer;for(var o=0;o<n;o++){var u=this.names[o],s=t[u];if(s==null)throw new a.MissingArgumentError("element '".concat(u,"' in named tuple cannot be 'null'"));i.writeInt32(0);try{this.subCodecs[o].encode(i,s)}catch(e){throw v(e,a.QueryArgumentError)?new a.InvalidArgumentError("invalid element '".concat(u,"' in named tuple: ").concat(e.message)):e}}var c=i.unwrap();e.writeInt32(4+c.length),e.writeInt32(n),e.writeBuffer(c)}},{key:"encodeArgs",value:function e(e){if(e==null)throw new a.MissingArgumentError("One or more named arguments expected, received null");var t=Object.keys(e),n=this.names,o=this.namesSet,u=this.subCodecs,s=u.length;if(t.length>s){var c=t.filter(function(e){return!o.has(e)});throw new a.UnknownArgumentError("Unused named argument".concat(c.length===1?"":"s",': "').concat(c.join('", "'),'"'))}if(!s)return i.EmptyTupleCodec.BUFFER;var l=new r.WriteBuffer;for(var f=0;f<s;f++){var d=n[f],h=e[d];l.writeInt32(0),h==null?l.writeInt32(-1):u[f].encode(l,h)}var v=l.unwrap(),p=new r.WriteBuffer;return p.writeInt32(4+v.length),p.writeInt32(s),p.writeBuffer(v),p.unwrap()}},{key:"decode",value:function e(e){var t=e.readUInt32(),n=this.subCodecs;if(t!==n.length)throw new a.ProtocolError("cannot decode NamedTuple: expected ".concat(n.length," elements, got ").concat(t));var i=r.ReadBuffer.alloc(),o=this.names,u={};for(var s=0;s<t;s++){e.discard(4);var c=e.readInt32(),l=null;c!==-1&&(e.sliceInto(i,c),l=n[s].decode(i),i.finish()),u[o[s]]=l}return u}},{key:"getSubcodecs",value:function e(){return Array.from(this.subCodecs)}},{key:"getNames",value:function e(){return Array.from(this.names)}},{key:"getKind",value:function e(){return"namedtuple"}}]);return u}(t.Codec);e.NamedTupleCodec=u});var eE=$(function(e){"use strict";var t=function e(e){return!!(v(e.buffer,ArrayBuffer)&&e.BYTES_PER_ELEMENT)};Object.defineProperty(e,"__esModule",{value:!0});e.ArrayCodec=void 0;var r=en(),i=Q(),a=eg(),u=em(),s=ee(),l=e_(),f=function(e){h(d,e);var f=U(d);function d(e,t,r){o(this,d);var i;i=f.call(this,e),Object.defineProperty(n(i),"subCodec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(i),"len",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.subCodec=t,i.len=r;return S(i)}c(d,[{key:"encode",value:function e(e,n){if(!(v(this.subCodec,r.ScalarCodec)||v(this.subCodec,a.TupleCodec)||v(this.subCodec,l.NamedTupleCodec)||v(this.subCodec,u.RangeCodec)))throw new s.InvalidArgumentError("only arrays of scalars or tuples are supported");if(!Array.isArray(n)&&!t(n))throw new s.InvalidArgumentError("an array was expected");var o=this.subCodec,c=new i.WriteBuffer,f=n.length;if(f>2147483647)throw new s.InvalidArgumentError("too many elements in array");for(var d=0;d<f;d++){var h=n[d];h==null?c.writeInt32(-1):o.encode(c,h)}var p=c.unwrap();e.writeInt32(12+8+p.length),e.writeInt32(1),e.writeInt32(0),e.writeInt32(0),e.writeInt32(f),e.writeInt32(1),e.writeBuffer(p)}},{key:"decode",value:function e(e){var t=e.readInt32();if(e.discard(4),e.discard(4),t===0)return[];if(t!==1)throw new s.ProtocolError("only 1-dimensional arrays are supported");var r=e.readUInt32();if(this.len!==-1&&r!==this.len)throw new s.ProtocolError("invalid array size: received ".concat(r,", expected ").concat(this.len));e.discard(4);var n=new Array(r),a=i.ReadBuffer.alloc(),o=this.subCodec;for(var u=0;u<r;u++){var c=e.readInt32();c===-1?n[u]=null:(e.sliceInto(a,c),n[u]=o.decode(a),a.finish())}return n}},{key:"getSubcodecs",value:function e(){return[this.subCodec]}},{key:"getKind",value:function e(){return"array"}}]);return d}(r.Codec);e.ArrayCodec=f});var eO=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.EnumCodec=void 0;var t=eu(),r=function(e){h(r,e);var t=U(r);function r(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=arguments.length>2?arguments[2]:void 0;o(this,r);var u;u=t.call(this,e,i),Object.defineProperty(n(u),"values",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),u.values=a;return S(u)}return r}(t.StrCodec);e.EnumCodec=r});var eC=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ObjectCodec=void 0;var t=en(),r=Q(),i=er(),a=ee(),u=1,s=2,l=function(e){h(l,e);var t=U(l);function l(e,r,i,a,c){o(this,l);var f;f=t.call(this,e),Object.defineProperty(n(f),"codecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(f),"fields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(f),"namesSet",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(f),"cardinalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),f.codecs=r,f.fields=new Array(i.length),f.namesSet=new Set,f.cardinalities=c;for(var d=0;d<i.length;d++){var h=!!(a[d]&s),v=h?"@".concat(i[d]):i[d];f.fields[d]={name:v,implicit:!!(a[d]&u),linkprop:h,cardinality:c[d]},f.namesSet.add(v)}return S(f)}c(l,[{key:"encode",value:function e(e,t){throw new a.InvalidArgumentError("Objects cannot be passed as arguments")}},{key:"encodeArgs",value:function e(e){return this.fields[0].name==="0"?this._encodePositionalArgs(e):this._encodeNamedArgs(e)}},{key:"_encodePositionalArgs",value:function e(e){if(!Array.isArray(e))throw new a.InvalidArgumentError("an array of arguments was expected");var t=this.codecs,n=t.length;if(e.length!==n)throw new a.QueryArgumentError("expected ".concat(n," argument").concat(n===1?"":"s",", got ").concat(e.length));var o=new r.WriteBuffer;for(var u=0;u<n;u++){o.writeInt32(0);var s=e[u];if(s==null){var c=this.cardinalities[u];if(c===i.ONE||c===i.AT_LEAST_ONE)throw new a.MissingArgumentError("argument ".concat(this.fields[u].name," is required, but received ").concat(s));o.writeInt32(-1)}else t[u].encode(o,s)}var l=o.unwrap(),f=new r.WriteBuffer;return f.writeInt32(4+l.length),f.writeInt32(n),f.writeBuffer(l),f.unwrap()}},{key:"_encodeNamedArgs",value:function e(e){if(e==null)throw new a.MissingArgumentError("One or more named arguments expected, received null");var t=Object.keys(e),n=this.fields,o=this.namesSet,u=this.codecs,s=u.length;if(t.length>s){var c=t.filter(function(e){return!o.has(e)});throw new a.UnknownArgumentError("Unused named argument".concat(c.length===1?"":"s",': "').concat(c.join('", "'),'"'))}var l=new r.WriteBuffer;for(var f=0;f<s;f++){var d=n[f].name,h=e[d];if(l.writeInt32(0),h==null){var v=this.cardinalities[f];if(v===i.ONE||v===i.AT_LEAST_ONE)throw new a.MissingArgumentError("argument ".concat(this.fields[f].name," is required, but received ").concat(h));l.writeInt32(-1)}else u[f].encode(l,h)}var p=l.unwrap(),y=new r.WriteBuffer;return y.writeInt32(4+p.length),y.writeInt32(s),y.writeBuffer(p),y.unwrap()}},{key:"decode",value:function e(e){var t=this.codecs,n=this.fields,i=e.readUInt32();if(i!==t.length)throw new a.ProtocolError("cannot decode Object: expected ".concat(t.length," elements, got ").concat(i));var o=r.ReadBuffer.alloc(),u={};for(var s=0;s<i;s++){e.discard(4);var c=e.readInt32(),l=n[s].name,f=null;c!==-1&&(e.sliceInto(o,c),f=t[s].decode(o),o.finish()),u[l]=f}return u}},{key:"getSubcodecs",value:function e(){return Array.from(this.codecs)}},{key:"getFields",value:function e(){return Array.from(this.fields)}},{key:"getKind",value:function e(){return"object"}}]);return l}(t.Codec);e.ObjectCodec=l});var eS=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SetCodec=void 0;var t=en(),r=Q(),i=eE(),a=ee(),u=function(e){h(u,e);var t=U(u);function u(e,r){o(this,u);var i;i=t.call(this,e),Object.defineProperty(n(i),"subCodec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.subCodec=r;return S(i)}c(u,[{key:"encode",value:function e(e,t){throw new a.InvalidArgumentError("Sets cannot be passed in query arguments")}},{key:"decode",value:function e(e){return v(this.subCodec,i.ArrayCodec)?this.decodeSetOfArrays(e):this.decodeSet(e)}},{key:"decodeSetOfArrays",value:function e(e){var t=e.readInt32();if(e.discard(4),e.discard(4),t===0)return[];if(t!==1)throw new a.ProtocolError("expected 1-dimensional array of records of arrays");var n=e.readUInt32();e.discard(4);var i=new Array(n),o=r.ReadBuffer.alloc(),u=this.subCodec;for(var s=0;s<n;s++){if(e.discard(4),e.readUInt32()!==1)throw new a.ProtocolError("expected a record with a single element as an array set element envelope");e.discard(4);var c=e.readInt32();if(c===-1)throw new a.ProtocolError("unexpected NULL value in array set element");e.sliceInto(o,c),i[s]=u.decode(o),o.finish()}return i}},{key:"decodeSet",value:function e(e){var t=e.readInt32();if(e.discard(4),e.discard(4),t===0)return[];if(t!==1)throw new a.ProtocolError("invalid set dimensinality: ".concat(t));var n=e.readUInt32();e.discard(4);var i=new Array(n),o=r.ReadBuffer.alloc(),u=this.subCodec;for(var s=0;s<n;s++){var c=e.readInt32();c===-1?i[s]=null:(e.sliceInto(o,c),i[s]=u.decode(o),o.finish())}return i}},{key:"getSubcodecs",value:function e(){return[this.subCodec]}},{key:"getKind",value:function e(){return"set"}}]);return u}(t.Codec);e.SetCodec=u});var ek=$(function(e){"use strict";var t=function e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";a[e]||(a[e]=0);var t=++a[e];return"_edgedb_".concat(e,"_").concat(t.toString(16),"_")};var r=function e(e){return new Promise(function(t){setTimeout(function(){return t()},e)})};var n=function e(e,t){return e[0]>t[0]?!0:e[0]<t[0]?!1:e[1]>t[1]};var i=function e(e,t){return e[0]===t[0]&&e[1]===t[1]?!0:n(e,t)};Object.defineProperty(e,"__esModule",{value:!0});e.versionGreaterThanOrEqual=e.versionGreaterThan=e.sleep=e.getUniqueId=void 0;var a={};e.getUniqueId=t;e.sleep=r;e.versionGreaterThan=n;e.versionGreaterThanOrEqual=i});var eI=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SparseObjectCodec=void 0;var t=en(),r=Q(),i=ee(),a=function(e){h(a,e);var t=U(a);function a(e,r,i){o(this,a);var u;u=t.call(this,e),Object.defineProperty(n(u),"codecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(u),"names",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),u.codecs=r,u.names=i;return S(u)}c(a,[{key:"encode",value:function e(e,t){var n=new r.WriteBuffer,a=0;var o=true,u=false,s=undefined;try{for(var c=Object.entries(t)[Symbol.iterator](),l;!(o=(l=c.next()).done);o=true){var f=I(l.value,2),d=f[0],h=f[1];if(h!==void 0){var v=this.names.indexOf(d);if(v===-1)throw new i.UnknownArgumentError(this.names.length?"invalid global '".concat(d,"', valid globals are ").concat(this.names.map(function(e){return"'".concat(e,"'")}).join(", ")):"invalid global '".concat(d,"', no valid globals exist"));a+=1,n.writeInt32(v),h===null?n.writeInt32(-1):this.codecs[v].encode(n,h)}}}catch(e){u=true;s=e}finally{try{if(!o&&c.return!=null){c.return()}}finally{if(u){throw s}}}var p=n.unwrap();e.writeInt32(4+p.length),e.writeInt32(a),e.writeBuffer(p)}},{key:"decode",value:function e(e){var t=this.codecs,n=this.names,i=e.readUInt32(),a=r.ReadBuffer.alloc(),o={};for(var u=0;u<i;u++){var s=e.readUInt32(),c=e.readInt32(),l=n[s],f=null;c!==-1&&(e.sliceInto(a,c),f=t[s].decode(a),a.finish()),o[l]=f}return o}},{key:"getSubcodecs",value:function e(){return Array.from(this.codecs)}},{key:"getKind",value:function e(){return"sparse_object"}}]);return a}(t.Codec);e.SparseObjectCodec=a});var eM=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n},i=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.CodecsRegistry=void 0;var a=Q(),u=i(et()),s=en(),l=eb(),f=er(),d=eg(),h=n(ea()),p=n(eh()),y=el(),b=eE(),g=e_(),w=eO(),m=eC(),_=eS(),E=em(),O=ek(),C=eI(),S=ee(),k=1e3,I=200,M=0,P=1,T=2,D=3,A=4,j=5,N=6,U=7,B=8,L=9,R=f.KNOWN_TYPENAMES.get("std::int64"),F=f.KNOWN_TYPENAMES.get("std::datetime"),x=f.KNOWN_TYPENAMES.get("std::json"),q=function(){function e(){o(this,e);Object.defineProperty(this,"codecsBuildCache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"codecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"customScalarCodecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.codecs=new u.default({capacity:k}),this.codecsBuildCache=new u.default({capacity:I}),this.customScalarCodecs=new Map}c(e,[{key:"setCustomCodecs",value:function e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.int64_bigint,r=e.datetime_localDatetime,n=e.json_string;t?this.customScalarCodecs.set(R,new h.Int64BigintCodec(R)):this.customScalarCodecs.delete(R),r?this.customScalarCodecs.set(F,new p.LocalDateTimeCodec(F)):this.customScalarCodecs.delete(F),n?this.customScalarCodecs.set(x,new y.JSONStringCodec(x)):this.customScalarCodecs.delete(x)}},{key:"hasCodec",value:function e(e){return this.codecs.has(e)?!0:e===f.NULL_CODEC_ID||e===d.EMPTY_TUPLE_CODEC_ID}},{key:"getCodec",value:function e(e){var t=this.codecs.get(e);return t!==null&&t!==void 0?t:e===d.EMPTY_TUPLE_CODEC_ID?d.EMPTY_TUPLE_CODEC:e===f.NULL_CODEC_ID?l.NULL_CODEC:null}},{key:"buildCodec",value:function e(e,t){var r=new a.ReadBuffer(e),n=[],i=null;for(;r.length;)i=this._buildCodec(r,n,t),i!=null&&(n.push(i),this.codecs.set(i.tid,i));if(!n.length)throw new S.InternalClientError("could not build a codec");return n[n.length-1]}},{key:"_buildCodec",value:function e(e,t,r){var n;var i=e.readUInt8(),o=e.readUUID(),u=this.codecs.get(o);if(u==null&&(u=this.codecsBuildCache.get(o)),u!=null){switch(i){case M:{e.discard(2);break}case P:case B:{var c=e.readUInt16();for(var h=0;h<c;h++){(0,O.versionGreaterThanOrEqual)(r,[0,11])?e.discard(5):e.discard(1);var p=e.readUInt32();e.discard(p+2)}break}case T:break;case L:case D:{e.discard(2);break}case A:{var y=e.readUInt16();e.discard(2*y);break}case j:{var k=e.readUInt16();for(var I=0;I<k;I++){var R=e.readUInt32();e.discard(R+2)}break}case N:{if(e.discard(2),e.readUInt16()!==1)throw new S.ProtocolError("cannot handle arrays with more than one dimension");e.discard(4);break}case U:{var F=e.readUInt16();for(var x=0;x<F;x++){var q=e.readUInt32();e.discard(q)}break}default:if(i>=127&&i<=255){var H=e.readUInt32();if(i===255){var W=a.utf8Decoder.decode(e.readBuffer(H)),$=(n=this.codecs.get(o))!==null&&n!==void 0?n:this.codecsBuildCache.get(o);v($,s.ScalarCodec)&&$.setTypeName(W)}else e.discard(H);return null}else throw new S.InternalClientError("no codec implementation for EdgeDB data class ".concat(i))}return u}switch(i){case T:{if(u=this.customScalarCodecs.get(o),u!=null)break;if(u=l.SCALAR_CODECS.get(o),!u)throw f.KNOWN_TYPES.has(o)?new S.InternalClientError("no JS codec for ".concat(f.KNOWN_TYPES.get(o))):new S.InternalClientError("no JS codec for the type with ID ".concat(o));if(!v(u,s.ScalarCodec))throw new S.ProtocolError("could not build scalar codec: base scalar is a non-scalar codec");break}case P:case B:{var Y=e.readUInt16(),K=new Array(Y),V=new Array(Y),J=new Array(Y),G=new Array(Y);for(var z=0;z<Y;z++){var Q=void 0,X=void 0;(0,O.versionGreaterThanOrEqual)(r,[0,11])?(Q=e.readUInt32(),X=e.readUInt8()):(Q=e.readUInt8(),X=0);var Z=e.readString(),ee=e.readUInt16(),et=t[ee];if(et==null)throw new S.ProtocolError("could not build object codec: missing subcodec");K[z]=et,V[z]=Z,J[z]=Q,G[z]=X}u=i===B?new C.SparseObjectCodec(o,K,V):new m.ObjectCodec(o,K,V,J,G);break}case M:{var er=e.readUInt16(),en=t[er];if(en==null)throw new S.ProtocolError("could not build set codec: missing subcodec");u=new _.SetCodec(o,en);break}case D:{var ei=e.readUInt16();if(u=t[ei],u==null)throw new S.ProtocolError("could not build scalar codec: missing a codec for base scalar");if(!v(u,s.ScalarCodec))throw new S.ProtocolError("could not build scalar codec: base scalar has a non-scalar codec");u=u.derive(o);break}case N:{var ea=e.readUInt16();if(e.readUInt16()!==1)throw new S.ProtocolError("cannot handle arrays with more than one dimension");var eo=e.readInt32(),eu=t[ea];if(eu==null)throw new S.ProtocolError("could not build array codec: missing subcodec");u=new b.ArrayCodec(o,eu,eo);break}case A:{var es=e.readUInt16();if(es===0)u=d.EMPTY_TUPLE_CODEC;else{var ec=new Array(es);for(var el=0;el<es;el++){var ef=e.readUInt16(),ed=t[ef];if(ed==null)throw new S.ProtocolError("could not build tuple codec: missing subcodec");ec[el]=ed}u=new d.TupleCodec(o,ec)}break}case j:{var eh=e.readUInt16(),ev=new Array(eh),ep=new Array(eh);for(var ey=0;ey<eh;ey++){ep[ey]=e.readString();var eb=e.readUInt16(),eg=t[eb];if(eg==null)throw new S.ProtocolError("could not build namedtuple codec: missing subcodec");ev[ey]=eg}u=new g.NamedTupleCodec(o,ev,ep);break}case U:{var ew=e.readUInt16(),em=[];for(var e_=0;e_<ew;e_++)em.push(e.readString());u=new w.EnumCodec(o,null,em);break}case L:{var eE=e.readUInt16(),eO=t[eE];if(eO==null)throw new S.ProtocolError("could not build range codec: missing subcodec");u=new E.RangeCodec(o,eO);break}}if(u==null)throw f.KNOWN_TYPES.has(o)?new S.InternalClientError("could not build a codec for ".concat(f.KNOWN_TYPES.get(o)," type")):new S.InternalClientError("could not build a codec for ".concat(o," type"));return this.codecsBuildCache.set(o,u),u}}]);return e}();e.CodecsRegistry=q});var eP=$(function(e){"use strict";var t=function e(e){return Math.pow(2,e)*100+Math.random()*100};var r=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t};Object.defineProperty(e,"__esModule",{value:!0});e.Options=e.Session=e.TransactionOptions=e.RetryOptions=e.RetryCondition=e.IsolationLevel=e.defaultBackoff=void 0;var a=i(ee());e.defaultBackoff=t;var u;(function(e){e.Serializable="SERIALIZABLE"})(u=e.IsolationLevel||(e.IsolationLevel={}));var s;(function(e){e[e.TransactionConflict=0]="TransactionConflict",e[e.NetworkError=1]="NetworkError"})(s=e.RetryCondition||(e.RetryCondition={}));var l=function e(t,r){o(this,e);Object.defineProperty(this,"attempts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"backoff",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.attempts=t,this.backoff=r},f=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;o(this,e);Object.defineProperty(this,"default",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"overrides",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.default=new l(r,n),this.overrides=new Map}c(e,[{key:"withRule",value:function t(t,r,n){var i=this.default,a=new Map(this.overrides);a.set(t,new l(r!==null&&r!==void 0?r:i.attempts,n!==null&&n!==void 0?n:i.backoff));var o=Object.create(e.prototype);return o.default=i,o.overrides=a,o}},{key:"getRuleForException",value:function e(e){var t;return v(e,a.TransactionConflictError)?t=this.overrides.get(s.TransactionConflict):v(e,a.ClientError)&&(t=this.overrides.get(s.NetworkError)),t!==null&&t!==void 0?t:this.default}}],[{key:"defaults",value:function t(){return new e}}]);return e}();e.RetryOptions=f;var d=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.isolation,n=r===void 0?u.Serializable:r,i=t.readonly,a=i===void 0?!1:i,s=t.deferrable,c=s===void 0?!1:s;o(this,e);Object.defineProperty(this,"isolation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"readonly",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"deferrable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.isolation=n,this.readonly=a,this.deferrable=c}c(e,null,[{key:"defaults",value:function t(){return new e}}]);return e}();e.TransactionOptions=d;var h=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.module,n=r===void 0?"default":r,i=t.moduleAliases,a=i===void 0?{}:i,u=t.config,s=u===void 0?{}:u,c=t.globals,l=c===void 0?{}:c;o(this,e);Object.defineProperty(this,"module",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moduleAliases",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"globals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.module=n,this.moduleAliases=a,this.config=s,this.globals=l}c(e,[{key:"withModuleAliases",value:function t(t){var r=t.module,n=O(t,["module"]);return new e(E(m({},this),{module:r!==null&&r!==void 0?r:this.module,moduleAliases:m({},this.moduleAliases,n)}))}},{key:"withConfig",value:function t(t){return new e(E(m({},this),{config:m({},this.config,t)}))}},{key:"withGlobals",value:function t(t){return new e(E(m({},this),{globals:m({},this.globals,t)}))}},{key:"_serialise",value:function e(){var e=this;var t={};this.module!=="default"&&(t.module=this.module);var r=Object.entries(this.moduleAliases);r.length&&(t.aliases=r),Object.keys(this.config).length&&(t.config=this.config);var n=Object.entries(this.globals);return n.length&&(t.globals=n.reduce(function(t,r){var n=I(r,2),i=n[0],a=n[1];return t[i.includes("::")?i:"".concat(e.module,"::").concat(i)]=a,t},{})),t}}],[{key:"defaults",value:function e(){return p}}]);return e}();e.Session=h;var p=new h,y=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.retryOptions,n=r===void 0?f.defaults():r,i=t.transactionOptions,a=i===void 0?d.defaults():i,u=t.session,s=u===void 0?h.defaults():u;o(this,e);Object.defineProperty(this,"retryOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"transactionOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.retryOptions=n,this.transactionOptions=a,this.session=s}c(e,[{key:"withTransactionOptions",value:function t(t){return new e(E(m({},this),{transactionOptions:v(t,d)?t:new d(t)}))}},{key:"withRetryOptions",value:function t(t){return new e(E(m({},this),{retryOptions:v(t,f)?t:new f(t.attempts,t.backoff)}))}},{key:"withSession",value:function t(t){return new e(E(m({},this),{session:t}))}}],[{key:"defaults",value:function t(){return new e}}]);return e}();e.Options=y});var eT=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=ee(),r=function(){function e(){var r=this;o(this,e);Object.defineProperty(this,"_promise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_resolve",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_reject",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_done",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._done=!1;var n=null,i=null;if(this._promise=new Promise(function(e,t){n=function(e){r._done=!0,t(e)},i=function(t){r._done=!0,e(t)}}),!n||!i)throw new t.InternalClientError("Promise executor was not called synchronously");this._reject=n,this._resolve=i}c(e,[{key:"wait",value:function e(){var e=this;return a(function(){return B(this,function(t){switch(t.label){case 0:return[4,e._promise];case 1:t.sent();return[2]}})})()}},{key:"then",value:function e(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++){r[n]=arguments[n]}throw new t.InternalClientError("Event objects cannot be awaited on directly; use Event.wait()")}},{key:"done",get:function e(){return this._done}},{key:"set",value:function e(){if(this._done)throw new t.InternalClientError("emit(): the Event is already set");this._resolve(!0)}},{key:"setError",value:function e(e){if(this._done)throw new t.InternalClientError("emitError(): the Event is already set");this._reject(e)}}]);return e}();e.default=r});var eD=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.LifoQueue=void 0;var t=ee(),r=function(){function e(){o(this,e);Object.defineProperty(this,"_promises",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_resolvers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rejecters",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._resolvers=[],this._rejecters=[],this._promises=[]}c(e,[{key:"_add",value:function e(){var e=this;this._promises.push(new Promise(function(t,r){e._resolvers.push(t),e._rejecters.push(r)}))}},{key:"push",value:function e(e){this._resolvers.length||this._add();var r=this._resolvers.shift();if(this._rejecters.shift(),!r)throw new t.InternalClientError("resolve function was null or undefined when attempting to push.");r(e)}},{key:"get",value:function e(){this._promises.length||this._add();var e=this._promises.pop();if(!e)throw new t.InternalClientError("promise was null or undefined when attempting to get.");return e}},{key:"cancelAllPending",value:function e(e){var t=this._rejecters;this._rejecters=[],this._resolvers=[];var r=true,n=false,i=undefined;try{for(var a=t[Symbol.iterator](),o;!(r=(o=a.next()).done);r=true){var u=o.value;u(e)}}catch(e){n=true;i=e}finally{try{if(!r&&a.return!=null){a.return()}}finally{if(n){throw i}}}}},{key:"length",get:function e(){return this._promises.length-this._resolvers.length}},{key:"pending",get:function e(){return Math.max(0,this._resolvers.length-this._promises.length)}}]);return e}();e.LifoQueue=r});var eA=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0});e.retryingConnect=void 0;var i=n(ee()),o=ek(),u=0;function s(e,t,r){return c.apply(this,arguments)}function c(){c=a(function(e,t,r){var n,a,s,c,l,f;return B(this,function(d){switch(d.label){case 0:n=t.connectionParams.waitUntilAvailable===0?0:Date.now()+t.connectionParams.waitUntilAvailable;d.label=1;case 1:d.trys.push([1,3,,11]);return[4,e(t.connectionParams.address,t,r)];case 2:return[2,d.sent()];case 3:a=d.sent();if(!v(a,i.ClientConnectionError))return[3,9];if(!a.hasTag(i.SHOULD_RECONNECT))return[3,7];s=Date.now();if(s>n)throw a;if(!(t.logging&&(!u||s-u>5e3)))return[3,6];u=s;l=['A client connection error occurred; reconnecting because of "waitUntilAvailable='.concat(t.connectionParams.waitUntilAvailable,'".'),a];f=!t.fromProject&&!t.fromEnv;if(!f)return[3,5];return[4,t.inProject()];case 4:f=d.sent();d.label=5;case 5:f&&l.push('\n\n\nHint: it looks like the program is running from a directory initialized with "edgedb project init". Consider calling "edgedb.connect()" without arguments.\n'),(c=console).warn.apply(c,T(l));d.label=6;case 6:return[3,8];case 7:throw a;case 8:return[3,10];case 9:throw console.error("Unexpected connection error:",a),a;case 10:return[3,11];case 11:return[4,(0,o.sleep)(Math.trunc(10+Math.random()*200))];case 12:d.sent();d.label=13;case 13:return[3,1];case 14:return[2]}})});return c.apply(this,arguments)}e.retryingConnect=s});var ej=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0});e.Transaction=e.TransactionState=void 0;var i=n(ee()),u=z(),s;(function(e){e[e.ACTIVE=0]="ACTIVE",e[e.COMMITTED=1]="COMMITTED",e[e.ROLLEDBACK=2]="ROLLEDBACK",e[e.FAILED=3]="FAILED"})(s=e.TransactionState||(e.TransactionState={}));var l=function(){function e(t,r){o(this,e);Object.defineProperty(this,"_holder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rawConn",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_opInProgress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._holder=t,this._rawConn=r,this._state=s.ACTIVE,this._opInProgress=!1}c(e,[{key:"_waitForConnAbort",value:function e(){var e=this;return a(function(){var t;return B(this,function(r){switch(r.label){case 0:return[4,e._rawConn.connAbortWaiter.wait()];case 1:r.sent();t=e._rawConn.getConnAbortError();throw v(t,i.EdgeDBError)&&v(t.source,i.TransactionTimeoutError)?t.source:t}})})()}},{key:"_runOp",value:function e(e,t,r){var n=this;return a(function(){return B(this,function(a){switch(a.label){case 0:if(n._opInProgress)throw new i.InterfaceError(r!==null&&r!==void 0?r:"Another query is in progress. Use the query methods on 'Client' to run queries concurrently.");if(n._state!==s.ACTIVE)throw new i.InterfaceError("cannot ".concat(e,"; the transaction is ").concat(n._state===s.COMMITTED?"already committed":n._state===s.ROLLEDBACK?"already rolled back":"in error state"));n._opInProgress=!0;a.label=1;case 1:a.trys.push([1,,3,4]);return[4,t()];case 2:return[2,a.sent()];case 3:n._opInProgress=!1;return[7];case 4:return[2]}})})()}},{key:"_commit",value:function e(){var e=this;return a(function(){return B(this,function(t){switch(t.label){case 0:return[4,e._runOp("commit",a(function(){return B(this,function(t){switch(t.label){case 0:return[4,e._rawConn.fetch("COMMIT",void 0,u.OutputFormat.NONE,u.Cardinality.NO_RESULT,e._holder.options.session,!0)];case 1:t.sent(),e._state=s.COMMITTED;return[2]}})}),"A query is still in progress after transaction block has returned.")];case 1:t.sent();return[2]}})})()}},{key:"_rollback",value:function e(){var e=this;return a(function(){return B(this,function(t){switch(t.label){case 0:return[4,e._runOp("rollback",a(function(){return B(this,function(t){switch(t.label){case 0:return[4,e._rawConn.fetch("ROLLBACK",void 0,u.OutputFormat.NONE,u.Cardinality.NO_RESULT,e._holder.options.session,!0)];case 1:t.sent(),e._state=s.ROLLEDBACK;return[2]}})}),"A query is still in progress after transaction block has returned.")];case 1:t.sent();return[2]}})})()}},{key:"execute",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r._runOp("execute",function(){return r._rawConn.fetch(e,t,u.OutputFormat.NONE,u.Cardinality.NO_RESULT,r._holder.options.session)})]})})()}},{key:"query",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r._runOp("query",function(){return r._rawConn.fetch(e,t,u.OutputFormat.BINARY,u.Cardinality.MANY,r._holder.options.session)})]})})()}},{key:"queryJSON",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r._runOp("queryJSON",function(){return r._rawConn.fetch(e,t,u.OutputFormat.JSON,u.Cardinality.MANY,r._holder.options.session)})]})})()}},{key:"querySingle",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r._runOp("querySingle",function(){return r._rawConn.fetch(e,t,u.OutputFormat.BINARY,u.Cardinality.AT_MOST_ONE,r._holder.options.session)})]})})()}},{key:"querySingleJSON",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r._runOp("querySingleJSON",function(){return r._rawConn.fetch(e,t,u.OutputFormat.JSON,u.Cardinality.AT_MOST_ONE,r._holder.options.session)})]})})()}},{key:"queryRequiredSingle",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r._runOp("queryRequiredSingle",function(){return r._rawConn.fetch(e,t,u.OutputFormat.BINARY,u.Cardinality.ONE,r._holder.options.session)})]})})()}},{key:"queryRequiredSingleJSON",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r._runOp("queryRequiredSingleJSON",function(){return r._rawConn.fetch(e,t,u.OutputFormat.JSON,u.Cardinality.ONE,r._holder.options.session)})]})})()}}],[{key:"_startTransaction",value:function t(t){return a(function(){var r,n;return B(this,function(i){switch(i.label){case 0:return[4,t._getConnection()];case 1:r=i.sent();return[4,r.resetState()];case 2:i.sent();n=t.options.transactionOptions;return[4,r.fetch("START TRANSACTION ISOLATION ".concat(n.isolation,", ").concat(n.readonly?"READ ONLY":"READ WRITE",", ").concat(n.deferrable?"":"NOT ","DEFERRABLE;"),void 0,u.OutputFormat.NONE,u.Cardinality.NO_RESULT,t.options.session,!0)];case 3:return[2,(i.sent(),new e(t,r))]}})})()}}]);return e}();e.Transaction=l});var eN=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n},i=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.Client=e.BaseClientPool=e.ClientConnectionHolder=void 0;var u=eM(),s=n(ee()),l=z(),f=eP(),d=i(eT()),h=eD(),p=eA(),y=ej(),b=ek(),g=function(){function e(t){o(this,e);Object.defineProperty(this,"_pool",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_connection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inUse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._pool=t,this._connection=null,this._options=null,this._inUse=null}c(e,[{key:"options",get:function e(){var e;return(e=this._options)!==null&&e!==void 0?e:f.Options.defaults()}},{key:"_getConnection",value:function e(){var e=this;return a(function(){var t;return B(this,function(r){switch(r.label){case 0:t=!e._connection||e._connection.isClosed();if(!t)return[3,2];return[4,e._pool.getNewConnection()];case 1:t=e._connection=r.sent();r.label=2;case 2:return[2,(t,e._connection)]}})})()}},{key:"connectionOpen",get:function e(){return this._connection!==null&&!this._connection.isClosed()}},{key:"acquire",value:function e(e){var t=this;return a(function(){return B(this,function(r){if(t._inUse)throw new s.InternalClientError("ClientConnectionHolder cannot be acquired, already in use");return[2,(t._options=e,t._inUse=new d.default,t)]})})()}},{key:"release",value:function e(){var e=this;return a(function(){var t;return B(this,function(r){switch(r.label){case 0:if(e._inUse===null)throw new s.ClientError("ClientConnectionHolder.release() called on a free connection holder");e._options=null;return[4,(t=e._connection)===null||t===void 0?void 0:t.resetState()];case 1:r.sent(),e._inUse.done||e._inUse.set(),e._inUse=null,e._pool.enqueue(e);return[2]}})})()}},{key:"_waitUntilReleasedAndClose",value:function e(){var e=this;return a(function(){var t,r;return B(this,function(n){switch(n.label){case 0:r=e._inUse;if(!r)return[3,2];return[4,e._inUse.wait()];case 1:r=n.sent();n.label=2;case 2:r;return[4,(t=e._connection)===null||t===void 0?void 0:t.close()];case 3:n.sent();return[2]}})})()}},{key:"terminate",value:function e(){var e;(e=this._connection)===null||e===void 0||e.close()}},{key:"transaction",value:function e(e){var t=this;return a(function(){var r,n,i,a,o,u,c,l,f;return B(this,function(d){switch(d.label){case 0:n=0;d.label=1;case 1:return[4,y.Transaction._startTransaction(t)];case 2:i=d.sent(),a=!1;d.label=3;case 3:d.trys.push([3,9,,17]);return[4,Promise.race([e(i),i._waitForConnAbort()])];case 4:r=d.sent();d.label=5;case 5:d.trys.push([5,7,,8]);return[4,i._commit()];case 6:d.sent();return[3,8];case 7:o=d.sent();throw a=!0,o;case 8:return[3,17];case 9:u=d.sent();d.label=10;case 10:d.trys.push([10,13,,14]);c=a;if(c)return[3,12];return[4,i._rollback()];case 11:c=d.sent();d.label=12;case 12:c;return[3,14];case 13:l=d.sent();if(!v(l,s.EdgeDBError))throw l;return[3,14];case 14:if(!(v(u,s.EdgeDBError)&&u.hasTag(s.SHOULD_RETRY)&&!(a&&v(u,s.ClientConnectionError))))return[3,16];f=t.options.retryOptions.getRuleForException(u);if(n+1>=f.attempts)throw u;return[4,(0,b.sleep)(f.backoff(n+1))];case 15:d.sent();return[3,18];case 16:throw u;case 17:return[2,r];case 18:++n;return[3,1];case 19:return[2]}})})()}},{key:"retryingFetch",value:function e(e,t,r,n){var i=this;return a(function(){var a,o,u,c,l;return B(this,function(f){switch(f.label){case 0:o=0;f.label=1;case 1:return[4,i._getConnection()];case 2:u=f.sent();f.label=3;case 3:f.trys.push([3,5,,8]);return[4,u.fetch(e,t,r,n,i.options.session)];case 4:a=f.sent();return[3,8];case 5:c=f.sent();if(!(v(c,s.EdgeDBError)&&c.hasTag(s.SHOULD_RETRY)&&(u.getQueryCapabilities(e,r,n)===0||v(c,s.TransactionConflictError))))return[3,7];l=i.options.retryOptions.getRuleForException(c);if(o+1>=l.attempts)throw c;return[4,(0,b.sleep)(l.backoff(o+1))];case 6:f.sent();return[3,9];case 7:throw c;case 8:return[2,a];case 9:++o;return[3,1];case 10:return[2]}})})()}},{key:"execute",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r.retryingFetch(e,t,l.OutputFormat.NONE,l.Cardinality.NO_RESULT)]})})()}},{key:"query",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r.retryingFetch(e,t,l.OutputFormat.BINARY,l.Cardinality.MANY)]})})()}},{key:"queryJSON",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r.retryingFetch(e,t,l.OutputFormat.JSON,l.Cardinality.MANY)]})})()}},{key:"querySingle",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r.retryingFetch(e,t,l.OutputFormat.BINARY,l.Cardinality.AT_MOST_ONE)]})})()}},{key:"querySingleJSON",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r.retryingFetch(e,t,l.OutputFormat.JSON,l.Cardinality.AT_MOST_ONE)]})})()}},{key:"queryRequiredSingle",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r.retryingFetch(e,t,l.OutputFormat.BINARY,l.Cardinality.ONE)]})})()}},{key:"queryRequiredSingleJSON",value:function e(e,t){var r=this;return a(function(){return B(this,function(n){return[2,r.retryingFetch(e,t,l.OutputFormat.JSON,l.Cardinality.ONE)]})})()}}]);return e}();e.ClientConnectionHolder=g;var w=function(){function e(t,r){o(this,e);var n;Object.defineProperty(this,"_parseConnectArguments",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_closing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_holders",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_userConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_suggestedConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_connectConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_codecsRegistry",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__normalizedConnectConfig",{enumerable:!0,configurable:!0,writable:!0,value:null}),this.validateClientOptions(r),this._codecsRegistry=new u.CodecsRegistry,this._queue=new h.LifoQueue,this._holders=[],this._userConcurrency=(n=r.concurrency)!==null&&n!==void 0?n:null,this._suggestedConcurrency=null,this._closing=null,this._connectConfig=m({},r),this._resizeHolderPool()}c(e,[{key:"validateClientOptions",value:function e(e){if(e.concurrency!=null&&(typeof e.concurrency!="number"||!Number.isInteger(e.concurrency)||e.concurrency<0))throw new s.InterfaceError("invalid 'concurrency' value: expected integer greater than 0 (got ".concat(JSON.stringify(e.concurrency),")"))}},{key:"_getStats",value:function e(){return{queueLength:this._queue.pending,openConnections:this._holders.filter(function(e){return e.connectionOpen}).length}}},{key:"ensureConnected",value:function e(){var e=this;return a(function(){var t;return B(this,function(r){switch(r.label){case 0:if(e._closing)throw new s.InterfaceError(e._closing.done?"The client is closed":"The client is closing");if(e._getStats().openConnections>0)return[2];return[4,e._queue.get()];case 1:t=r.sent();r.label=2;case 2:r.trys.push([2,,4,5]);return[4,t._getConnection()];case 3:r.sent();return[3,5];case 4:e._queue.push(t);return[7];case 5:return[2]}})})()}},{key:"_concurrency",get:function e(){var e,t;return(t=(e=this._userConcurrency)!==null&&e!==void 0?e:this._suggestedConcurrency)!==null&&t!==void 0?t:1}},{key:"_resizeHolderPool",value:function e(){var e=this._concurrency-this._holders.length;if(e>0)for(var t=0;t<e;t++){var r=new g(this);this._holders.push(r),this._queue.push(r)}else e<0}},{key:"_getNormalizedConnectConfig",value:function e(){var e;return(e=this.__normalizedConnectConfig)!==null&&e!==void 0?e:this.__normalizedConnectConfig=this._parseConnectArguments(this._connectConfig)}},{key:"getNewConnection",value:function e(){var e=this;return a(function(){var t,r,n,i;return B(this,function(a){switch(a.label){case 0:if(!((t=e._closing)===null||t===void 0)&&t.done)throw new s.InterfaceError("The client is closed");return[4,e._getNormalizedConnectConfig()];case 1:r=a.sent();return[4,(0,p.retryingConnect)(e._connectWithTimeout,r,e._codecsRegistry)];case 2:n=a.sent(),i=n.serverSettings.suggested_pool_concurrency;return[2,(i&&i!==e._suggestedConcurrency&&(e._suggestedConcurrency=i,e._resizeHolderPool()),n)]}})})()}},{key:"acquireHolder",value:function e(e){var t=this;return a(function(){var r,n;return B(this,function(i){switch(i.label){case 0:if(t._closing)throw new s.InterfaceError(t._closing.done?"The client is closed":"The client is closing");return[4,t._queue.get()];case 1:r=i.sent();i.label=2;case 2:i.trys.push([2,4,,5]);return[4,r.acquire(e)];case 3:return[2,i.sent()];case 4:n=i.sent();throw t._queue.push(r),n;case 5:return[2]}})})()}},{key:"enqueue",value:function e(e){this._queue.push(e)}},{key:"close",value:function e(){var e=this;return a(function(){var t,r;return B(this,function(n){switch(n.label){case 0:if(!e._closing)return[3,2];return[4,e._closing.wait()];case 1:return[2,n.sent()];case 2:e._closing=new d.default,e._queue.cancelAllPending(new s.InterfaceError("The client is closing"));t=setTimeout(function(){console.warn("Client.close() is taking over 60 seconds to complete. Check if you have any unreleased connections left.")},6e4);n.label=3;case 3:n.trys.push([3,5,6,7]);return[4,Promise.all(e._holders.map(function(e){return e._waitUntilReleasedAndClose()}))];case 4:n.sent();return[3,7];case 5:r=n.sent();throw e._terminate(),e._closing.setError(r),r;case 6:clearTimeout(t);return[7];case 7:e._closing.set();return[2]}})})()}},{key:"_terminate",value:function e(){var e=true,t=false,r=undefined;try{for(var n=this._holders[Symbol.iterator](),i;!(e=(i=n.next()).done);e=true){var a=i.value;a.terminate()}}catch(e){t=true;r=e}finally{try{if(!e&&n.return!=null){n.return()}}finally{if(t){throw r}}}}},{key:"terminate",value:function e(){var e;!((e=this._closing)===null||e===void 0)&&e.done||(this._queue.cancelAllPending(new s.InterfaceError("The client is closed")),this._terminate(),this._closing||(this._closing=new d.default,this._closing.set()))}},{key:"isClosed",value:function e(){return!!this._closing}}]);return e}();e.BaseClientPool=w;var _=function(){function e(t,r){o(this,e);Object.defineProperty(this,"pool",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pool=t,this.options=r}c(e,[{key:"withTransactionOptions",value:function t(t){return new e(this.pool,this.options.withTransactionOptions(t))}},{key:"withRetryOptions",value:function t(t){return new e(this.pool,this.options.withRetryOptions(t))}},{key:"withSession",value:function t(t){return new e(this.pool,this.options.withSession(t))}},{key:"withModuleAliases",value:function t(t){return new e(this.pool,this.options.withSession(this.options.session.withModuleAliases(t)))}},{key:"withConfig",value:function t(t){var r=this.options.session.withConfig(t);return new e(this.pool,this.options.withSession(r))}},{key:"withGlobals",value:function t(t){return new e(this.pool,this.options.withSession(this.options.session.withGlobals(t)))}},{key:"ensureConnected",value:function e(){var e=this;return a(function(){return B(this,function(t){switch(t.label){case 0:return[4,e.pool.ensureConnected()];case 1:return[2,(t.sent(),e)]}})})()}},{key:"isClosed",value:function e(){return this.pool.isClosed()}},{key:"close",value:function e(){var e=this;return a(function(){return B(this,function(t){switch(t.label){case 0:return[4,e.pool.close()];case 1:t.sent();return[2]}})})()}},{key:"terminate",value:function e(){this.pool.terminate()}},{key:"transaction",value:function e(e){var t=this;return a(function(){var r;return B(this,function(n){switch(n.label){case 0:if(t.pool.isStateless)throw new s.EdgeDBError("cannot use 'transaction()' API on HTTP client");return[4,t.pool.acquireHolder(t.options)];case 1:r=n.sent();n.label=2;case 2:n.trys.push([2,,4,6]);return[4,r.transaction(e)];case 3:return[2,n.sent()];case 4:return[4,r.release()];case 5:n.sent();return[7];case 6:return[2]}})})()}},{key:"execute",value:function e(e,t){var r=this;return a(function(){var n;return B(this,function(i){switch(i.label){case 0:return[4,r.pool.acquireHolder(r.options)];case 1:n=i.sent();i.label=2;case 2:i.trys.push([2,,4,6]);return[4,n.execute(e,t)];case 3:return[2,i.sent()];case 4:return[4,n.release()];case 5:i.sent();return[7];case 6:return[2]}})})()}},{key:"query",value:function e(e,t){var r=this;return a(function(){var n;return B(this,function(i){switch(i.label){case 0:return[4,r.pool.acquireHolder(r.options)];case 1:n=i.sent();i.label=2;case 2:i.trys.push([2,,4,6]);return[4,n.query(e,t)];case 3:return[2,i.sent()];case 4:return[4,n.release()];case 5:i.sent();return[7];case 6:return[2]}})})()}},{key:"queryJSON",value:function e(e,t){var r=this;return a(function(){var n;return B(this,function(i){switch(i.label){case 0:return[4,r.pool.acquireHolder(r.options)];case 1:n=i.sent();i.label=2;case 2:i.trys.push([2,,4,6]);return[4,n.queryJSON(e,t)];case 3:return[2,i.sent()];case 4:return[4,n.release()];case 5:i.sent();return[7];case 6:return[2]}})})()}},{key:"querySingle",value:function e(e,t){var r=this;return a(function(){var n;return B(this,function(i){switch(i.label){case 0:return[4,r.pool.acquireHolder(r.options)];case 1:n=i.sent();i.label=2;case 2:i.trys.push([2,,4,6]);return[4,n.querySingle(e,t)];case 3:return[2,i.sent()];case 4:return[4,n.release()];case 5:i.sent();return[7];case 6:return[2]}})})()}},{key:"querySingleJSON",value:function e(e,t){var r=this;return a(function(){var n;return B(this,function(i){switch(i.label){case 0:return[4,r.pool.acquireHolder(r.options)];case 1:n=i.sent();i.label=2;case 2:i.trys.push([2,,4,6]);return[4,n.querySingleJSON(e,t)];case 3:return[2,i.sent()];case 4:return[4,n.release()];case 5:i.sent();return[7];case 6:return[2]}})})()}},{key:"queryRequiredSingle",value:function e(e,t){var r=this;return a(function(){var n;return B(this,function(i){switch(i.label){case 0:return[4,r.pool.acquireHolder(r.options)];case 1:n=i.sent();i.label=2;case 2:i.trys.push([2,,4,6]);return[4,n.queryRequiredSingle(e,t)];case 3:return[2,i.sent()];case 4:return[4,n.release()];case 5:i.sent();return[7];case 6:return[2]}})})()}},{key:"queryRequiredSingleJSON",value:function e(e,t){var r=this;return a(function(){var n;return B(this,function(i){switch(i.label){case 0:return[4,r.pool.acquireHolder(r.options)];case 1:n=i.sent();i.label=2;case 2:i.trys.push([2,,4,6]);return[4,n.queryRequiredSingleJSON(e,t)];case 3:return[2,i.sent()];case 4:return[4,n.release()];case 5:i.sent();return[7];case 6:return[2]}})})()}}]);return e}();e.Client=_});var eU=$(function(e){"use strict";var t=function e(e){var t=e.port;if(t!=null&&(typeof t!="number"||t<1||t>65535))throw new n.InterfaceError("invalid `port` value");var i=e.user;if(i==null)throw new n.InterfaceError("`user` key is required");if(typeof i!="string")throw new n.InterfaceError("`user` must be string");var a={user:i,port:t},o=e.host;if(o!=null){if(typeof o!="string")throw new n.InterfaceError("`host` must be string");a.host=o}var u=e.database;if(u!=null){if(typeof u!="string")throw new n.InterfaceError("`database` must be string");a.database=u}var s=e.password;if(s!=null){if(typeof s!="string")throw new n.InterfaceError("`password` must be string");a.password=s}var c=e.tls_ca;if(c!=null){if(typeof c!="string")throw new n.InterfaceError("`tls_ca` must be string");a.tlsCAData=c}var l=e.tls_cert_data;if(l!=null){if(typeof l!="string")throw new n.InterfaceError("`tls_cert_data` must be string");if(c!=null&&l!==c)throw new n.InterfaceError("both 'tls_ca' and 'tls_cert_data' are defined, and are not in agreement");a.tlsCAData=l}var f=e.tls_verify_hostname,d=e.tls_security;if(f!=null)if(typeof f=="boolean")f=f?"strict":"no_host_verification";else throw new n.InterfaceError("`tls_verify_hostname` must be boolean");if(d!=null&&(typeof d!="string"||!r.validTlsSecurityValues.includes(d)))throw new n.InterfaceError("`tls_security` must be one of ".concat(r.validTlsSecurityValues.map(function(e){return'"'.concat(e,'"')}).join(", ")));if(f&&d&&f!==d&&!(f==="no_host_verification"&&d==="insecure"))throw new n.InterfaceError("both 'tls_security' and 'tls_verify_hostname' are defined, and are not in agreement");return(d||f)&&(a.tlsSecurity=d!==null&&d!==void 0?d:f),a};Object.defineProperty(e,"__esModule",{value:!0});e.validateCredentials=e.readCredentialsFile=e.getCredentialsPath=void 0;var r=eR(),n=ee();function i(e,t){return o.apply(this,arguments)}function o(){o=a(function(e,t){return B(this,function(r){return[2,t.searchConfigDir("credentials",e+".json")]})});return o.apply(this,arguments)}e.getCredentialsPath=i;function u(e,t){return s.apply(this,arguments)}function s(){s=a(function(e,r){var i,a;return B(this,function(o){switch(o.label){case 0:o.trys.push([0,2,,3]);return[4,r.readFileUtf8(e)];case 1:i=o.sent();return[2,t(JSON.parse(i))];case 2:a=o.sent();throw new n.InterfaceError("cannot read credentials file ".concat(e,": ").concat(a));case 3:return[2]}})});return s.apply(this,arguments)}e.readCredentialsFile=u;e.validateCredentials=t});var eB=$(function(e){"use strict";var t=function e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return process.env[e]};Object.defineProperty(e,"__esModule",{value:!0});e.getEnv=e.HMAC=e.H=e.randomBytes=void 0;var r;e.randomBytes=r;var n;e.H=n;var i;e.HMAC=i;if((typeof crypto==="undefined"?"undefined":D(crypto))>"u"){var o=W("crypto");e.randomBytes=r=function(e){return new Promise(function(t,r){o.randomBytes(e,function(e,n){e?r(e):t(n)})})},e.H=n=function(){var e=a(function(e){var t;return B(this,function(r){t=o.createHash("sha256");return[2,(t.update(e),t.digest())]})});return function(t){return e.apply(this,arguments)}}(),e.HMAC=i=function(){var e=a(function(e,t){var r;return B(this,function(n){r=o.createHmac("sha256",e);return[2,(r.update(t),r.digest())]})});return function(t,r){return e.apply(this,arguments)}}()}else e.randomBytes=r=function(){var e=a(function(e){return B(this,function(t){return[2,crypto.getRandomValues(new Uint8Array(e))]})});return function(t){return e.apply(this,arguments)}}(),e.H=n=function(){var e=a(function(e){var t;return B(this,function(r){switch(r.label){case 0:t=Uint8Array.bind;return[4,crypto.subtle.digest("SHA-256",e)];case 1:return[2,new(t.apply(Uint8Array,[void 0,r.sent()]))]}})});return function(t){return e.apply(this,arguments)}}(),e.HMAC=i=function(){var e=a(function(e,t){var r,n,i,a;return B(this,function(o){switch(o.label){case 0:r=Uint8Array.bind;i=(n=crypto.subtle).sign;a=["HMAC"];return[4,crypto.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"])];case 1:return[4,i.apply(n,a.concat([o.sent(),t]))];case 2:return[2,new(r.apply(Uint8Array,[void 0,o.sent()]))]}})});return function(t,r){return e.apply(this,arguments)}}();e.getEnv=t});var eL=$(function(e){"use strict";var t=function e(e,t){t&=65535;var n=e.length,i=0;for(;i<n;)t=t<<8&65280^r[t>>8^e[i++]];return t};Object.defineProperty(e,"__esModule",{value:!0});e.crcHqx=void 0;var r=new Uint16Array([0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920]);e.crcHqx=t});var eR=$(function(e){"use strict";var t=function e(e){return function(){var t=a(function(t){var r,n;return B(this,function(i){switch(i.label){case 0:n=[{}];return[4,S(t,e)];case 1:return[2,E.apply(void 0,[m.apply(void 0,n.concat([i.sent()])),{connectTimeout:t.timeout,logging:(r=t.logging)!==null&&r!==void 0?r:!0}])]}})});return function(e){return t.apply(this,arguments)}}()};var r=function e(e){var t;if(typeof e=="string"){if(!/^\d*$/.test(e))throw new g.InterfaceError("invalid port: ".concat(e));if(t=parseInt(e,10),Number.isNaN(t))throw new g.InterfaceError("invalid port: ".concat(e))}else t=e;if(!Number.isInteger(t)||t<1||t>65535)throw new g.InterfaceError("invalid port: ".concat(e));return t};var n=function e(e){if(e.includes("/"))throw new g.InterfaceError("unix socket paths not supported");if(!e.length||e.includes(","))throw new g.InterfaceError("invalid host: '".concat(e,"'"));return e};var i=function e(e){if(typeof e=="number"){if(e<0)throw new g.InterfaceError("invalid waitUntilAvailable duration, must be >= 0");return e}if(typeof e=="string")if(e.startsWith("P"))e=y.Duration.from(e);else return(0,y.parseHumanDurationString)(e);if(v(e,y.Duration)){var t=(0,b.checkValidEdgeDBDuration)(e);if(t)throw new g.InterfaceError("invalid waitUntilAvailable duration, cannot have a '".concat(t,"' value"));if(e.sign<0)throw new g.InterfaceError("invalid waitUntilAvailable duration, must be >= 0");return e.milliseconds+e.seconds*1e3+e.minutes*6e4+e.hours*36e5}throw new g.InterfaceError("invalid duration")};var u=function e(e){return JSON.parse(w.utf8Decoder.decode((0,w.decodeB64)(e.padEnd(Math.ceil(e.length/4)*4,"="))))};var s=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),l=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return l(t,e),t};Object.defineProperty(e,"__esModule",{value:!0});e.parseDuration=e.ResolvedConnectConfig=e.getConnectArgumentsParser=e.validTlsSecurityValues=void 0;var d=f(ee()),h=eU(),p=eB(),y=ed(),b=eh(),g=ee(),w=Q(),_=eL(),O=63;e.validTlsSecurityValues=["insecure","no_host_verification","strict","default"];e.getConnectArgumentsParser=t;var C=function(){function t(){o(this,t);Object.defineProperty(this,"_host",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_hostSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_port",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_portSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_database",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_databaseSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_user",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_userSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_password",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_passwordSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_secretKey",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_secretKeySource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_cloudProfile",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_cloudProfileSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tlsCAData",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tlsCADataSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tlsSecurity",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tlsSecuritySource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_waitUntilAvailable",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_waitUntilAvailableSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"serverSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this.setHost=this.setHost.bind(this),this.setPort=this.setPort.bind(this),this.setDatabase=this.setDatabase.bind(this),this.setUser=this.setUser.bind(this),this.setPassword=this.setPassword.bind(this),this.setSecretKey=this.setSecretKey.bind(this),this.setTlsCAData=this.setTlsCAData.bind(this),this.setTlsCAFile=this.setTlsCAFile.bind(this),this.setTlsSecurity=this.setTlsSecurity.bind(this),this.setWaitUntilAvailable=this.setWaitUntilAvailable.bind(this)}c(t,[{key:"_setParam",value:function e(e,t,r,n){return this["_".concat(e)]===null&&(this["_".concat(e,"Source")]=r,t!==null)?(this["_".concat(e)]=n?n(t):t,!0):!1}},{key:"_setParamAsync",value:function e(e,t,r,n){var i=this;return a(function(){var a,o,u;return B(this,function(s){switch(s.label){case 0:if(!(i["_".concat(e)]===null&&(i["_".concat(e,"Source")]=r,t!==null)))return[3,4];o="_".concat(e);if(!n)return[3,2];return[4,n(t)];case 1:u=s.sent();return[3,3];case 2:u=t;s.label=3;case 3:a=(i[o]=u,!0);return[3,5];case 4:a=!1;s.label=5;case 5:return[2,a]}})})()}},{key:"setHost",value:function e(e,t){return this._setParam("host",e,t,n)}},{key:"setPort",value:function e(e,t){return this._setParam("port",e,t,r)}},{key:"setDatabase",value:function e(e,t){return this._setParam("database",e,t,function(e){if(e==="")throw new g.InterfaceError("invalid database name: '".concat(e,"'"));return e})}},{key:"setUser",value:function e(e,t){return this._setParam("user",e,t,function(e){if(e==="")throw new g.InterfaceError("invalid user name: '".concat(e,"'"));return e})}},{key:"setPassword",value:function e(e,t){return this._setParam("password",e,t)}},{key:"setSecretKey",value:function e(e,t){return this._setParam("secretKey",e,t)}},{key:"setCloudProfile",value:function e(e,t){return this._setParam("cloudProfile",e,t)}},{key:"setTlsCAData",value:function e(e,t){return this._setParam("tlsCAData",e,t)}},{key:"setTlsCAFile",value:function e(e,t,r){return this._setParamAsync("tlsCAData",e,t,function(e){return r(e)})}},{key:"setTlsSecurity",value:function t(t,r){return this._setParam("tlsSecurity",t,r,function(t){if(!e.validTlsSecurityValues.includes(t))throw new g.InterfaceError("invalid 'tlsSecurity' value: '".concat(t,"', must be one of ").concat(e.validTlsSecurityValues.map(function(e){return"'".concat(e,"'")}).join(", ")));var r=(0,p.getEnv)("EDGEDB_CLIENT_SECURITY");if(r!==void 0){if(!["default","insecure_dev_mode","strict"].includes(r))throw new g.InterfaceError("invalid EDGEDB_CLIENT_SECURITY value: '".concat(r,"', must be one of 'default', 'insecure_dev_mode' or 'strict'"));if(r==="insecure_dev_mode")t==="default"&&(t="insecure");else if(r==="strict"){if(t==="insecure"||t==="no_host_verification")throw new g.InterfaceError("'tlsSecurity' value (".concat(t,") conflicts with EDGEDB_CLIENT_SECURITY value (").concat(r,"), 'tlsSecurity' value cannot be lower than security level set by EDGEDB_CLIENT_SECURITY"));t="strict"}}return t})}},{key:"setWaitUntilAvailable",value:function e(e,t){return this._setParam("waitUntilAvailable",e,t,i)}},{key:"addServerSettings",value:function e(e){this.serverSettings=m({},e,this.serverSettings)}},{key:"address",get:function e(){var e,t;return[(e=this._host)!==null&&e!==void 0?e:"localhost",(t=this._port)!==null&&t!==void 0?t:5656]}},{key:"database",get:function e(){var e;return(e=this._database)!==null&&e!==void 0?e:"edgedb"}},{key:"user",get:function e(){var e;return(e=this._user)!==null&&e!==void 0?e:"edgedb"}},{key:"password",get:function e(){var e;return(e=this._password)!==null&&e!==void 0?e:void 0}},{key:"secretKey",get:function e(){var e;return(e=this._secretKey)!==null&&e!==void 0?e:void 0}},{key:"cloudProfile",get:function e(){var e;return(e=this._cloudProfile)!==null&&e!==void 0?e:"default"}},{key:"tlsSecurity",get:function e(){return this._tlsSecurity&&this._tlsSecurity!=="default"?this._tlsSecurity:this._tlsCAData!==null?"no_host_verification":"strict"}},{key:"waitUntilAvailable",get:function e(){var e;return(e=this._waitUntilAvailable)!==null&&e!==void 0?e:3e4}},{key:"explainConfig",value:function e(){var e=["Parameter          Value                                    Source","---------          -----                                    ------"],t=function(t,r,n,i){var a;var o=n===null,u=40-(o?10:0),s=String(r);s.length>u&&(s=s.slice(0,u-3)+"..."),e.push((a=t.padEnd(19," ")+(s+(o?" (default)":"")).padEnd(42," ")+i)!==null&&a!==void 0?a:"default")};return t("host",this.address[0],this._host,this._hostSource),t("port",this.address[1],this._port,this._portSource),t("database",this.database,this._database,this._databaseSource),t("user",this.user,this._user,this._userSource),t("password",this.password&&this.password.slice(0,3).padEnd(this.password.length,"*"),this._password,this._passwordSource),t("tlsCAData",this._tlsCAData&&this._tlsCAData.replace(/\r\n?|\n/,""),this._tlsCAData,this._tlsCADataSource),t("tlsSecurity",this.tlsSecurity,this._tlsSecurity,this._tlsSecuritySource),t("waitUntilAvailable",this.waitUntilAvailable,this._waitUntilAvailable,this._waitUntilAvailableSource),e.join("\n")}}]);return t}();e.ResolvedConnectConfig=C;e.parseDuration=i;function S(e,t){return k.apply(this,arguments)}function k(){k=a(function(e,t){var r,n,i,o,u,s,c,l,f,h,v,y,b,g,w,m,_,E;return B(this,function(O){switch(O.label){case 0:r=new C,n=!1,i=!1,o=I(e.instanceName==null&&e.dsn!=null&&!/^[a-z]+:\/\//i.test(e.dsn)?[void 0,e.dsn]:[e.dsn,e.instanceName],2),u=o[0],s=o[1];return[4,M(r,{dsn:u,instanceName:s,credentials:e.credentials,credentialsFile:e.credentialsFile,host:e.host,port:e.port,database:e.database,user:e.user,password:e.password,secretKey:e.secretKey,tlsCA:e.tlsCA,tlsCAFile:e.tlsCAFile,tlsSecurity:e.tlsSecurity,serverSettings:e.serverSettings,waitUntilAvailable:e.waitUntilAvailable},{dsn:"'dsnOrInstanceName' option (parsed as dsn)",instanceName:e.instanceName!=null?"'instanceName' option":"'dsnOrInstanceName' option (parsed as instance name)",credentials:"'credentials' option",credentialsFile:"'credentialsFile' option",host:"'host' option",port:"'port' option",database:"'database' option",user:"'user' option",password:"'password' option",secretKey:"'secretKey' option",tlsCA:"'tlsCA' option",tlsCAFile:"'tlsCAFile' option",tlsSecurity:"'tlsSecurity' option",serverSettings:"'serverSettings' option",waitUntilAvailable:"'waitUntilAvailable' option"},"Cannot have more than one of the following connection options: 'dsn', 'instanceName', 'credentials', 'credentialsFile' or 'host'/'port'",t)];case 1:c=O.sent(),l=c.hasCompoundOptions;if(!!l)return[3,3];h=(0,p.getEnv)("EDGEDB_PORT");return[4,M(r,{dsn:(0,p.getEnv)("EDGEDB_DSN"),instanceName:(0,p.getEnv)("EDGEDB_INSTANCE"),credentials:(0,p.getEnv)("EDGEDB_CREDENTIALS"),credentialsFile:(0,p.getEnv)("EDGEDB_CREDENTIALS_FILE"),host:(0,p.getEnv)("EDGEDB_HOST"),port:h,database:(0,p.getEnv)("EDGEDB_DATABASE"),user:(0,p.getEnv)("EDGEDB_USER"),password:(0,p.getEnv)("EDGEDB_PASSWORD"),secretKey:(0,p.getEnv)("EDGEDB_SECRET_KEY"),cloudProfile:(0,p.getEnv)("EDGEDB_CLOUD_PROFILE"),tlsCA:(0,p.getEnv)("EDGEDB_TLS_CA"),tlsCAFile:(0,p.getEnv)("EDGEDB_TLS_CA_FILE"),tlsSecurity:(0,p.getEnv)("EDGEDB_CLIENT_TLS_SECURITY"),waitUntilAvailable:(0,p.getEnv)("EDGEDB_WAIT_UNTIL_AVAILABLE")},{dsn:"'EDGEDB_DSN' environment variable",instanceName:"'EDGEDB_INSTANCE' environment variable",credentials:"'EDGEDB_CREDENTIALS' environment variable",credentialsFile:"'EDGEDB_CREDENTIALS_FILE' environment variable",host:"'EDGEDB_HOST' environment variable",port:"'EDGEDB_PORT' environment variable",database:"'EDGEDB_DATABASE' environment variable",user:"'EDGEDB_USER' environment variable",password:"'EDGEDB_PASSWORD' environment variable",secretKey:"'EDGEDB_SECRET_KEY' environment variable",cloudProfile:"'EDGEDB_CLOUD_PROFILE' environment variable",tlsCA:"'EDGEDB_TLS_CA' environment variable",tlsCAFile:"'EDGEDB_TLS_CA_FILE' environment variable",tlsSecurity:"'EDGEDB_CLIENT_TLS_SECURITY' environment variable",waitUntilAvailable:"'EDGEDB_WAIT_UNTIL_AVAILABLE' environment variable"},"Cannot have more than one of the following connection environment variables: 'EDGEDB_DSN', 'EDGEDB_INSTANCE', 'EDGEDB_CREDENTIALS', 'EDGEDB_CREDENTIALS_FILE' or 'EDGEDB_HOST'",t)];case 2:r._port===null&&((f=h)===null||f===void 0?void 0:f.startsWith("tcp://"))&&(console.warn("EDGEDB_PORT in 'tcp://host:port' format, so will be ignored"),h=void 0),v=O.sent(),l=v.hasCompoundOptions,n=v.anyOptionsUsed,v;O.label=3;case 3:if(!!l)return[3,10];if(!t)throw new d.ClientConnectionError("no connection options specified either by arguments to `createClient` API or environment variables; also cannot resolve from edgedb.toml in browser (or edge runtime) environment");return[4,(y=t)===null||y===void 0?void 0:y.findProjectDir()];case 4:b=O.sent();if(!b)throw new d.ClientConnectionError("no 'edgedb.toml' found and no connection options specified either via arguments to `createClient()` API or via environment variables EDGEDB_HOST, EDGEDB_INSTANCE, EDGEDB_DSN, EDGEDB_CREDENTIALS or EDGEDB_CREDENTIALS_FILE");return[4,t.findStashPath(b)];case 5:g=O.sent();return[4,t.readFileUtf8(g,"instance-name").then(function(e){return e.trim()}).catch(function(){return null})];case 6:w=O.sent();if(!(w!==null))return[3,9];return[4,Promise.all([t.readFileUtf8(g,"cloud-profile").then(function(e){return e.trim()}).catch(function(){}),t.readFileUtf8(g,"database").then(function(e){return e.trim()}).catch(function(){})])];case 7:m=I.apply(void 0,[O.sent(),2]),_=m[0],E=m[1];return[4,M(r,{instanceName:w,cloudProfile:_,database:E},{instanceName:"project linked instance ('".concat(w,"')"),cloudProfile:"project defined cloud instance ('".concat(_,"')"),database:"project default database"},"",t)];case 8:O.sent(),i=!0;return[3,10];case 9:throw new d.ClientConnectionError("Found 'edgedb.toml' but the project is not initialized. Run `edgedb project init`.");case 10:return[2,(r.setTlsSecurity("default","default"),{connectionParams:r,inProject:a(function(){var e;return B(this,function(r){switch(r.label){case 0:return[4,(e=t)===null||e===void 0?void 0:e.findProjectDir(!1)];case 1:return[2,r.sent()!=null]}})}),fromEnv:n,fromProject:i})]}})});return k.apply(this,arguments)}function M(e,t,r,n,i){return P.apply(this,arguments)}function P(){P=a(function(e,t,r,i,a){var o,u,s,c,l,f,d,v,p,y,b,w,m,_,E,O,C,S,k,I,M,P,D,j,N,U,L,R,F;return B(this,function(B){switch(B.label){case 0:P=!1,D=(u=(o=a)===null||o===void 0?void 0:o.readFileUtf8)!==null&&u!==void 0?u:function(e){throw new g.InterfaceError('cannot read file "'.concat(e,'" in browser (or edge runtime) environment'))};if(t.tlsCA!=null&&t.tlsCAFile!=null)throw new g.InterfaceError("Cannot specify both ".concat(r.tlsCA," and ").concat(r.tlsCAFile));P=e.setDatabase((s=t.database)!==null&&s!==void 0?s:null,r.database)||P,P=e.setUser((c=t.user)!==null&&c!==void 0?c:null,r.user)||P,P=e.setPassword((l=t.password)!==null&&l!==void 0?l:null,r.password)||P,P=e.setSecretKey((f=t.secretKey)!==null&&f!==void 0?f:null,r.secretKey)||P,P=e.setCloudProfile((d=t.cloudProfile)!==null&&d!==void 0?d:null,r.cloudProfile)||P,P=e.setTlsCAData((v=t.tlsCA)!==null&&v!==void 0?v:null,r.tlsCA)||P;return[4,e.setTlsCAFile((p=t.tlsCAFile)!==null&&p!==void 0?p:null,r.tlsCAFile,D)];case 1:P=B.sent()||P,P=e.setTlsSecurity((y=t.tlsSecurity)!==null&&y!==void 0?y:null,r.tlsSecurity)||P,P=e.setWaitUntilAvailable((b=t.waitUntilAvailable)!==null&&b!==void 0?b:null,r.waitUntilAvailable)||P,e.addServerSettings((w=t.serverSettings)!==null&&w!==void 0?w:{});j=[t.dsn,t.instanceName,t.credentials,t.credentialsFile,(m=t.host)!==null&&m!==void 0?m:t.port].filter(function(e){return e!==void 0}).length;if(j>1)throw new g.InterfaceError(i);if(!(j===1))return[3,14];if(!(t.dsn!==void 0||t.host!==void 0||t.port!==void 0))return[3,3];N=t.dsn;if(N===void 0){t.port!==void 0&&e.setPort(t.port,r.port);U=t.host!=null?n(t.host):"";N="edgedb://".concat(U.includes(":")?"[".concat(encodeURI(U),"]"):U)}return[4,T(N,e,t.dsn?r.dsn:t.host!==void 0?r.host:r.port,D)];case 2:B.sent();return[3,13];case 3:if(!(t.credentials!=null))return[3,4];L=(0,h.validateCredentials)(JSON.parse(t.credentials)),R=r.credentials;return[3,12];case 4:if(!a&&!(!((_=t.instanceName)===null||_===void 0)&&_.includes("/")))throw new g.InterfaceError("cannot ".concat(t.credentialsFile?'read credentials file "'.concat(t.credentialsFile,'"'):'resolve instance name "'.concat(t.instanceName,'"')," in browser (or edge runtime) environment"));F=t.credentialsFile;if(!(F===void 0))return[3,9];if(!/^\w(-?\w)*$/.test(t.instanceName))return[3,6];return[4,(0,h.getCredentialsPath)(t.instanceName,a)];case 5:F=B.sent(),R=r.instanceName;return[3,8];case 6:if(!/^([A-Za-z0-9](-?[A-Za-z0-9])*)\/([A-Za-z0-9](-?[A-Za-z0-9])*)$/.test(t.instanceName))throw new g.InterfaceError("invalid DSN or instance name: '".concat(t.instanceName,"'"));return[4,A(e,t.instanceName,r.instanceName,a)];case 7:return[2,(B.sent(),{hasCompoundOptions:!0,anyOptionsUsed:!0})];case 8:return[3,10];case 9:R=r.credentialsFile;B.label=10;case 10:return[4,(0,h.readCredentialsFile)(F,a)];case 11:L=B.sent();B.label=12;case 12:e.setHost((E=L.host)!==null&&E!==void 0?E:null,R),e.setPort((O=L.port)!==null&&O!==void 0?O:null,R),e.setDatabase((C=L.database)!==null&&C!==void 0?C:null,R),e.setUser((S=L.user)!==null&&S!==void 0?S:null,R),e.setPassword((k=L.password)!==null&&k!==void 0?k:null,R),e.setTlsCAData((I=L.tlsCAData)!==null&&I!==void 0?I:null,R),e.setTlsSecurity((M=L.tlsSecurity)!==null&&M!==void 0?M:null,R);B.label=13;case 13:return[2,{hasCompoundOptions:!0,anyOptionsUsed:!0}];case 14:return[2,{hasCompoundOptions:!1,anyOptionsUsed:P}]}})});return P.apply(this,arguments)}function T(e,t,r,n){return D.apply(this,arguments)}function D(){D=a(function(e,t,r,n){var i,o,u,s,c,l,f,d,h,v,y,b,w,m,_,E,O,C,S,k,M,P,T,D,A;function j(e,t,r,n){return N.apply(this,arguments)}function N(){N=a(function(e,t,a,o){var u,s,c,f,d,h,v,y;var b=arguments;return B(this,function(w){switch(w.label){case 0:u=b.length>4&&b[4]!==void 0?b[4]:function(e){return e};if([t||null,l.get(e),l.get("".concat(e,"_env")),l.get("".concat(e,"_file"))].filter(function(e){return e!=null}).length>1)throw new g.InterfaceError("invalid DSN: more than one of ".concat(t!==null?"'".concat(e,"', "):"","'?").concat(e,"=', '?").concat(e,"_env=' or '?").concat(e,"_file=' was specified ").concat(i));if(!(a===null))return[3,5];f=t||((s=l.get(e))!==null&&s!==void 0?s:null),d=r;if(f===null){h=l.get("".concat(e,"_env"));if(h!=null){if(f=(c=(0,p.getEnv)(h,!0))!==null&&c!==void 0?c:null,f===null)throw new g.InterfaceError("'".concat(e,"_env' environment variable '").concat(h,"' doesn't exist"));d+=" (".concat(e,"_env: ").concat(h,")")}}if(!(f===null))return[3,3];v=l.get("".concat(e,"_file"));y=v!=null;if(!y)return[3,2];return[4,n(v)];case 1:y=(f=w.sent(),d+=" (".concat(e,"_file: ").concat(v,")"));w.label=2;case 2:y;w.label=3;case 3:f=f!==null?u(f):null;return[4,o(f,d)];case 4:w.sent();w.label=5;case 5:l.delete(e),l.delete("".concat(e,"_env")),l.delete("".concat(e,"_file"));return[2]}})});return N.apply(this,arguments)}return B(this,function(r){switch(r.label){case 0:i=e,o=null,u="",s=/\[(.*?)(%25.+?)\]/.exec(e);s&&(o=s[1],u=decodeURI(s[2]),i=i.slice(0,s.index+o.length+1)+i.slice(s.index+o.length+s[2].length+1));try{if(c=new URL(i),o!==null&&c.hostname!=="[".concat(o,"]"))throw new Error}catch(t){throw new g.InterfaceError("invalid DSN or instance name: '".concat(e,"'"))}if(c.protocol!=="edgedb:")throw new g.InterfaceError("invalid DSN: scheme is expected to be 'edgedb', got '".concat(c.protocol.slice(0,-1),"'"));l=new Map;f=true,d=false,h=undefined;try{for(v=c.searchParams[Symbol.iterator]();!(f=(y=v.next()).done);f=true){b=I(y.value,2),w=b[0],m=b[1];if(l.has(w))throw new g.InterfaceError("invalid DSN: duplicate query parameter '".concat(w,"'"));l.set(w,m)}}catch(e){d=true;h=e}finally{try{if(!f&&v.return!=null){v.return()}}finally{if(d){throw h}}}_=/^\[.*\]$/.test(c.hostname)?c.hostname.slice(1,-1)+u:c.hostname;return[4,j("host",_,t._host,t.setHost)];case 1:r.sent();return[4,j("port",c.port,t._port,t.setPort)];case 2:r.sent();E=function(e){return e.replace(/^\//,"")};return[4,j("database",E(c.pathname),t._database,t.setDatabase,E)];case 3:r.sent();return[4,j("user",c.username,t._user,t.setUser)];case 4:r.sent();return[4,j("password",c.password,t._password,t.setPassword)];case 5:r.sent();return[4,j("secret_key",null,t._secretKey,t.setSecretKey)];case 6:r.sent();return[4,j("tls_ca",null,t._tlsCAData,t.setTlsCAData)];case 7:r.sent();return[4,j("tls_ca_file",null,t._tlsCAData,function(e,r){return t.setTlsCAFile(e,r,n)})];case 8:r.sent();return[4,j("tls_security",null,t._tlsSecurity,t.setTlsSecurity)];case 9:r.sent();return[4,j("wait_until_available",null,t._waitUntilAvailable,t.setWaitUntilAvailable)];case 10:r.sent();O={};C=true,S=false,k=undefined;try{for(M=l[Symbol.iterator]();!(C=(P=M.next()).done);C=true){T=I(P.value,2),D=T[0],A=T[1];O[D]=A}}catch(e){S=true;k=e}finally{try{if(!C&&M.return!=null){M.return()}}finally{if(S){throw k}}}t.addServerSettings(O);return[2]}})});return D.apply(this,arguments)}function A(e,t,r,n){return j.apply(this,arguments)}function j(){j=a(function(e,t,r,n){var i,a,o,s,c,l,f,h,p,y,b,m,E,C;return B(this,function(S){switch(S.label){case 0:i=t.toLowerCase(),a=I(i.split("/"),2),o=a[0],s=a[1],c="".concat(s,"--").concat(o);if(c.length>O)throw new g.InterfaceError("invalid instance name: cloud instance name length cannot exceed ".concat(O-1," characters: ").concat(t));l=e.secretKey;if(!(l==null))return[3,5];S.label=1;case 1:S.trys.push([1,4,,5]);if(!n)throw new g.InterfaceError("Cannot get secret key from cloud profile in browser (or edge runtime) environment");f=e.cloudProfile;return[4,n.searchConfigDir("cloud-credentials","".concat(f,".json"))];case 2:h=S.sent();return[4,n.readFileUtf8(h)];case 3:p=S.sent();if(l=JSON.parse(p).secret_key,!l)throw new g.InterfaceError("Cloud profile '".concat(f,"' doesn't contain a secret key"));e.setSecretKey(l,"cloud-credentials/".concat(f,".json"));return[3,5];case 4:y=S.sent();throw new g.InterfaceError("Cannot connect to cloud instances without a secret key: ".concat(y));case 5:try{b=l.split(".");if(b.length<2)throw new g.InterfaceError("Invalid secret key: does not contain payload");m=u(b[1]).iss;if(!m)throw new g.InterfaceError("Invalid secret key: payload does not contain 'iss' value");E=((0,_.crcHqx)(w.utf8Encoder.encode(i),0)%100).toString(10).padStart(2,"0"),C="".concat(c,".c-").concat(E,".i.").concat(m);e.setHost(C,"resolved from 'secretKey' and ".concat(r))}catch(e){throw v(e,d.EdgeDBError)?e:new g.InterfaceError("Invalid secret key: ".concat(e))}return[2]}})});return j.apply(this,arguments)}});var eF=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0});e.errorMapping=void 0;var i=n(ee());e.errorMapping=new Map;e.errorMapping.set(16777216,i.InternalServerError);e.errorMapping.set(33554432,i.UnsupportedFeatureError);e.errorMapping.set(50331648,i.ProtocolError);e.errorMapping.set(50397184,i.BinaryProtocolError);e.errorMapping.set(50397185,i.UnsupportedProtocolVersionError);e.errorMapping.set(50397186,i.TypeSpecNotFoundError);e.errorMapping.set(50397187,i.UnexpectedMessageError);e.errorMapping.set(50462720,i.InputDataError);e.errorMapping.set(50462976,i.ParameterTypeMismatchError);e.errorMapping.set(50463232,i.StateMismatchError);e.errorMapping.set(50528256,i.ResultCardinalityMismatchError);e.errorMapping.set(50593792,i.CapabilityError);e.errorMapping.set(50594048,i.UnsupportedCapabilityError);e.errorMapping.set(50594304,i.DisabledCapabilityError);e.errorMapping.set(67108864,i.QueryError);e.errorMapping.set(67174400,i.InvalidSyntaxError);e.errorMapping.set(67174656,i.EdgeQLSyntaxError);e.errorMapping.set(67174912,i.SchemaSyntaxError);e.errorMapping.set(67175168,i.GraphQLSyntaxError);e.errorMapping.set(67239936,i.InvalidTypeError);e.errorMapping.set(67240192,i.InvalidTargetError);e.errorMapping.set(67240193,i.InvalidLinkTargetError);e.errorMapping.set(67240194,i.InvalidPropertyTargetError);e.errorMapping.set(67305472,i.InvalidReferenceError);e.errorMapping.set(67305473,i.UnknownModuleError);e.errorMapping.set(67305474,i.UnknownLinkError);e.errorMapping.set(67305475,i.UnknownPropertyError);e.errorMapping.set(67305476,i.UnknownUserError);e.errorMapping.set(67305477,i.UnknownDatabaseError);e.errorMapping.set(67305478,i.UnknownParameterError);e.errorMapping.set(67371008,i.SchemaError);e.errorMapping.set(67436544,i.SchemaDefinitionError);e.errorMapping.set(67436800,i.InvalidDefinitionError);e.errorMapping.set(67436801,i.InvalidModuleDefinitionError);e.errorMapping.set(67436802,i.InvalidLinkDefinitionError);e.errorMapping.set(67436803,i.InvalidPropertyDefinitionError);e.errorMapping.set(67436804,i.InvalidUserDefinitionError);e.errorMapping.set(67436805,i.InvalidDatabaseDefinitionError);e.errorMapping.set(67436806,i.InvalidOperatorDefinitionError);e.errorMapping.set(67436807,i.InvalidAliasDefinitionError);e.errorMapping.set(67436808,i.InvalidFunctionDefinitionError);e.errorMapping.set(67436809,i.InvalidConstraintDefinitionError);e.errorMapping.set(67436810,i.InvalidCastDefinitionError);e.errorMapping.set(67437056,i.DuplicateDefinitionError);e.errorMapping.set(67437057,i.DuplicateModuleDefinitionError);e.errorMapping.set(67437058,i.DuplicateLinkDefinitionError);e.errorMapping.set(67437059,i.DuplicatePropertyDefinitionError);e.errorMapping.set(67437060,i.DuplicateUserDefinitionError);e.errorMapping.set(67437061,i.DuplicateDatabaseDefinitionError);e.errorMapping.set(67437062,i.DuplicateOperatorDefinitionError);e.errorMapping.set(67437063,i.DuplicateViewDefinitionError);e.errorMapping.set(67437064,i.DuplicateFunctionDefinitionError);e.errorMapping.set(67437065,i.DuplicateConstraintDefinitionError);e.errorMapping.set(67437066,i.DuplicateCastDefinitionError);e.errorMapping.set(67437067,i.DuplicateMigrationError);e.errorMapping.set(67502080,i.SessionTimeoutError);e.errorMapping.set(67502336,i.IdleSessionTimeoutError);e.errorMapping.set(67502592,i.QueryTimeoutError);e.errorMapping.set(67504640,i.TransactionTimeoutError);e.errorMapping.set(67504641,i.IdleTransactionTimeoutError);e.errorMapping.set(83886080,i.ExecutionError);e.errorMapping.set(83951616,i.InvalidValueError);e.errorMapping.set(83951617,i.DivisionByZeroError);e.errorMapping.set(83951618,i.NumericOutOfRangeError);e.errorMapping.set(83951619,i.AccessPolicyError);e.errorMapping.set(83951620,i.QueryAssertionError);e.errorMapping.set(84017152,i.IntegrityError);e.errorMapping.set(84017153,i.ConstraintViolationError);e.errorMapping.set(84017154,i.CardinalityViolationError);e.errorMapping.set(84017155,i.MissingRequiredError);e.errorMapping.set(84082688,i.TransactionError);e.errorMapping.set(84082944,i.TransactionConflictError);e.errorMapping.set(84082945,i.TransactionSerializationError);e.errorMapping.set(84082946,i.TransactionDeadlockError);e.errorMapping.set(84148224,i.WatchError);e.errorMapping.set(100663296,i.ConfigurationError);e.errorMapping.set(117440512,i.AccessError);e.errorMapping.set(117506048,i.AuthenticationError);e.errorMapping.set(134217728,i.AvailabilityError);e.errorMapping.set(134217729,i.BackendUnavailableError);e.errorMapping.set(150994944,i.BackendError);e.errorMapping.set(150995200,i.UnsupportedBackendFeatureError);e.errorMapping.set(4026531840,i.LogMessage);e.errorMapping.set(4026597376,i.WarningMessage);e.errorMapping.set(4278190080,i.ClientError);e.errorMapping.set(4278255616,i.ClientConnectionError);e.errorMapping.set(4278255872,i.ClientConnectionFailedError);e.errorMapping.set(4278255873,i.ClientConnectionFailedTemporarilyError);e.errorMapping.set(4278256128,i.ClientConnectionTimeoutError);e.errorMapping.set(4278256384,i.ClientConnectionClosedError);e.errorMapping.set(4278321152,i.InterfaceError);e.errorMapping.set(4278321408,i.QueryArgumentError);e.errorMapping.set(4278321409,i.MissingArgumentError);e.errorMapping.set(4278321410,i.UnknownArgumentError);e.errorMapping.set(4278321411,i.InvalidArgumentError);e.errorMapping.set(4278386688,i.NoDataError);e.errorMapping.set(4278452224,i.InternalClientError)});var ex=$(function(e){"use strict";var t=function e(e){var t;return t=o.errorMapping.get(e),t||(e=e&4294967040,t=o.errorMapping.get(e),t)||(e=e&4294901760,t=o.errorMapping.get(e),t)||(e=e&4278190080,t=o.errorMapping.get(e),t)?t:a.EdgeDBError};var r=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t};Object.defineProperty(e,"__esModule",{value:!0});e.resolveErrorCode=void 0;var a=i(ee()),o=eF();e.resolveErrorCode=t});var eq=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n},i=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.BaseRawConnection=e.Capabilities=e.PROTO_VER_MIN=e.PROTO_VER=void 0;var u=eb(),s=e_(),l=eC(),f=eg(),d=ek(),h=n(ee()),p=ex(),y=z(),b=Q(),g=n(V()),w=i(eT()),m=i(et()),_=eP();e.PROTO_VER=[1,0];e.PROTO_VER_MIN=[0,9];var E;(function(e){e[e.TRANS_IDLE=0]="TRANS_IDLE",e[e.TRANS_ACTIVE=1]="TRANS_ACTIVE",e[e.TRANS_INTRANS=2]="TRANS_INTRANS",e[e.TRANS_INERROR=3]="TRANS_INERROR",e[e.TRANS_UNKNOWN=4]="TRANS_UNKNOWN"})(E||(E={}));var O;(function(e){e[e.NONE=0]="NONE",e[e.MODIFICATONS=1]="MODIFICATONS",e[e.SESSION_CONFIG=2]="SESSION_CONFIG",e[e.TRANSACTION=4]="TRANSACTION",e[e.DDL=8]="DDL",e[e.PERSISTENT_CONFIG=16]="PERSISTENT_CONFIG",e[e.SET_GLOBAL=32]="SET_GLOBAL",e[e.ALL=4294967295]="ALL"})(O=e.Capabilities||(e.Capabilities={}));var C=(O.ALL&~O.TRANSACTION)>>>0,S=new Uint8Array(Array(8).fill(255));new DataView(S.buffer).setUint32(4,C);var k=(O.ALL&~O.TRANSACTION&~O.SESSION_CONFIG&~O.SET_GLOBAL)>>>0,M=(k|O.SESSION_CONFIG|O.SET_GLOBAL)>>>0,P;(function(e){e[e.INJECT_OUTPUT_TYPE_IDS=1]="INJECT_OUTPUT_TYPE_IDS",e[e.INJECT_OUTPUT_TYPE_NAMES=2]="INJECT_OUTPUT_TYPE_NAMES",e[e.INJECT_OUTPUT_OBJECT_IDS=4]="INJECT_OUTPUT_OBJECT_IDS"})(P||(P={}));var T=new Map([[84082689,84082945],[84082690,84082946]]),D=function(){function t(r){o(this,t);Object.defineProperty(this,"connected",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lastStatus",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"codecsRegistry",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queryCodecCache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serverSecret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serverSettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serverXactStatus",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageWaiter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"connWaiter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"connAbortWaiter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_abortedWith",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"protocolVersion",{enumerable:!0,configurable:!0,writable:!0,value:e.PROTO_VER}),Object.defineProperty(this,"isLegacyProtocol",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"stateCodec",{enumerable:!0,configurable:!0,writable:!0,value:u.INVALID_CODEC}),Object.defineProperty(this,"stateCache",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"lastStateUpdate",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"adminUIMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.buffer=new b.ReadMessageBuffer,this.codecsRegistry=r,this.queryCodecCache=new m.default({capacity:1e3}),this.lastStatus=null,this.serverSecret=null,this.serverSettings={},this.serverXactStatus=E.TRANS_UNKNOWN,this.messageWaiter=null,this.connWaiter=new w.default,this.connAbortWaiter=new w.default}c(t,[{key:"throwNotImplemented",value:function e(e){throw new h.InternalClientError("method ".concat(e," is not implemented"))}},{key:"_waitForMessage",value:function e(){var e=this;return a(function(){return B(this,function(t){e.throwNotImplemented("_waitForMessage");return[2]})})()}},{key:"_sendData",value:function e(e){this.throwNotImplemented("_sendData")}},{key:"getConnAbortError",value:function e(){var e;return(e=this._abortedWith)!==null&&e!==void 0?e:new h.InterfaceError("client has been closed")}},{key:"_checkState",value:function e(){if(this.isClosed())throw this.getConnAbortError()}},{key:"_abortWithError",value:function e(e){this._abortedWith=e,this._abort()}},{key:"_ignoreHeaders",value:function e(){var e=this.buffer.readInt16();for(;e;)this.buffer.readInt16(),this.buffer.readLenPrefixedBuffer(),e--}},{key:"_abortWaiters",value:function e(e){var t;this.connWaiter.done||this.connWaiter.setError(e),(t=this.messageWaiter)===null||t===void 0||t.setError(e),this.messageWaiter=null}},{key:"_parseHeaders",value:function e(){var e=new Map,t=this.buffer.readInt16();for(;t;){var r=this.buffer.readInt16(),n=this.buffer.readLenPrefixedBuffer();e.set(r,n),t--}return e}},{key:"_parseDescribeTypeMessage",value:function e(){var e=-1;if(this.isLegacyProtocol){var t=this._parseHeaders();if(t.has(y.LegacyHeaderCodes.capabilities)){var r=t.get(y.LegacyHeaderCodes.capabilities);e=Number(new DataView(r.buffer,r.byteOffset,r.byteLength).getBigInt64(0))}}else this._ignoreHeaders(),e=Number(this.buffer.readBigInt64());var n=this.buffer.readChar(),i=this.buffer.readUUID(),a=this.buffer.readLenPrefixedBuffer(),o=this.buffer.readUUID(),u=this.buffer.readLenPrefixedBuffer();this.buffer.finishMessage();var s=this.codecsRegistry.getCodec(i);s==null&&(s=this.codecsRegistry.buildCodec(a,this.protocolVersion));var c=this.codecsRegistry.getCodec(o);return c==null&&(c=this.codecsRegistry.buildCodec(u,this.protocolVersion)),[n,s,c,e,a,u]}},{key:"_parseCommandCompleteMessage",value:function e(){this._ignoreHeaders();var e;if(this.isLegacyProtocol)e=this.buffer.readString();else{this.buffer.readBigInt64(),e=this.buffer.readString();var t=this.buffer.readUUID(),r=this.buffer.readLenPrefixedBuffer();this.adminUIMode&&t===this.stateCodec.tid&&(this.lastStateUpdate=this.stateCodec.decode(new b.ReadBuffer(r)))}return this.buffer.finishMessage(),e}},{key:"_parseErrorMessage",value:function e(){var e;this.buffer.readChar();var t=this.buffer.readUInt32(),r=this.buffer.readString(),n=(0,p.resolveErrorCode)((e=T.get(t))!==null&&e!==void 0?e:t),i=new n(r);if(i._attrs=this._parseHeaders(),this.buffer.finishMessage(),v(i,h.AuthenticationError))throw i;return i}},{key:"_parseSyncMessage",value:function e(){switch(this._parseHeaders(),this.buffer.readChar()){case g.$I:this.serverXactStatus=E.TRANS_IDLE;break;case g.$T:this.serverXactStatus=E.TRANS_INTRANS;break;case g.$E:this.serverXactStatus=E.TRANS_INERROR;break;default:this.serverXactStatus=E.TRANS_UNKNOWN}this.buffer.finishMessage()}},{key:"_parseDataMessages",value:function e(e,t){var r=b.ReadBuffer.alloc(),n=g.$D,i=this.buffer;if(Array.isArray(t))for(;i.takeMessageType(n);)i.consumeMessageInto(r),r.discard(6),t.push(e.decode(r)),r.finish();else for(;i.takeMessageType(n);){var a=i.consumeMessage();t.writeChar(n),t.writeInt32(a.length+4),t.writeBuffer(a)}}},{key:"_parseServerSettings",value:function e(e,t){switch(e){case"suggested_pool_concurrency":{this.serverSettings.suggested_pool_concurrency=parseInt(b.utf8Decoder.decode(t),10);break}case"system_config":{var r=new b.ReadBuffer(t),n=r.readInt32()-16,i=r.readUUID(),a=r.readBuffer(n),o=this.codecsRegistry.getCodec(i);o===null&&(o=this.codecsRegistry.buildCodec(a,this.protocolVersion)),r.discard(4);var u=o.decode(r);r.finish(),this.serverSettings.system_config=u;break}default:this.serverSettings[e]=t;break}}},{key:"_parseDescribeStateMessage",value:function e(){var e=this.buffer.readUUID(),t=this.buffer.readBuffer(this.buffer.readInt32()),r=this.codecsRegistry.getCodec(e);r===null&&(r=this.codecsRegistry.buildCodec(t,this.protocolVersion)),this.stateCodec=r,this.stateCache=null,this.buffer.finishMessage()}},{key:"_fallthrough",value:function e(){var e=this.buffer.getMessageType();switch(e){case g.$S:{var t=this.buffer.readString(),r=this.buffer.readLenPrefixedBuffer();this._parseServerSettings(t,r),this.buffer.finishMessage();break}case g.$L:{var n=this.buffer.readChar(),i=this.buffer.readUInt32(),a=this.buffer.readString();this._parseHeaders(),this.buffer.finishMessage(),console.info("SERVER MESSAGE",n,i,a);break}default:throw new h.UnexpectedMessageError("unexpected message type ".concat(e,' ("').concat(g.chr(e),'")'))}}},{key:"_legacyParse",value:function e(e,t,r){var n=this;return a(function(){var i,a,o,u,s,c,l,f,v,p,w,m,_,E,O,C,k;return B(this,function(M){switch(M.label){case 0:i=new b.WriteMessageBuffer,a=(0,d.versionGreaterThanOrEqual)(n.protocolVersion,[0,14]);i.beginMessage(g.$P).writeLegacyHeaders({explicitObjectids:"true",allowCapabilities:S}).writeChar(t).writeChar(r?y.Cardinality.AT_MOST_ONE:y.Cardinality.MANY),i.writeString(""),i.writeString(e),i.endMessage(),i.writeSync(),n._sendData(i.unwrap());f=-1,v=!0,p=null,w=null,m=null;M.label=1;case 1:if(!v)return[3,5];_=n.buffer.takeMessage();if(_)return[3,3];return[4,n._waitForMessage()];case 2:_=M.sent();M.label=3;case 3:switch(_,n.buffer.getMessageType()){case g.$1:{E=n._parseHeaders();if(E.has(y.LegacyHeaderCodes.capabilities)){O=E.get(y.LegacyHeaderCodes.capabilities);f=Number(new DataView(O.buffer,O.byteOffset,O.byteLength).getBigInt64(0))}o=n.buffer.readChar(),a?(u=n.buffer.readUUID(),w=n.buffer.readLenPrefixedBuffer(),s=n.buffer.readUUID(),m=n.buffer.readLenPrefixedBuffer()):(u=n.buffer.readUUID(),s=n.buffer.readUUID()),n.buffer.finishMessage();break}case g.$E:{p=n._parseErrorMessage(),p._query=e;break}case g.$Z:{n._parseSyncMessage(),v=!1;break}default:n._fallthrough()}M.label=4;case 4:return[3,1];case 5:if(p!=null)throw p;if(u==null||s==null)throw new h.ProtocolError("did not receive in/out type ids in Parse response");if(!(c=n.codecsRegistry.getCodec(u),l=n.codecsRegistry.getCodec(s),c==null&&w!=null&&(c=n.codecsRegistry.buildCodec(w,n.protocolVersion)),l==null&&m!=null&&(l=n.codecsRegistry.buildCodec(m,n.protocolVersion)),c==null||l==null||!a))return[3,11];if(a)throw new h.ProtocolError("in/out codecs were not sent");i.reset(),i.beginMessage(g.$D).writeInt16(0).writeChar(g.$T).writeString("").endMessage().writeSync(),n._sendData(i.unwrap()),v=!0;M.label=6;case 6:if(!v)return[3,10];C=n.buffer.takeMessage();if(C)return[3,8];return[4,n._waitForMessage()];case 7:C=M.sent();M.label=8;case 8:switch(C,n.buffer.getMessageType()){case g.$T:{try{;k=I(n._parseDescribeTypeMessage(),6),o=k[0],c=k[1],l=k[2],f=k[3],w=k[4],m=k[5],k}catch(e){p=e}break}case g.$E:{p=n._parseErrorMessage(),p._query=e;break}case g.$Z:{n._parseSyncMessage(),v=!1;break}default:n._fallthrough()}M.label=9;case 9:return[3,6];case 10:if(p!=null)throw p;M.label=11;case 11:if(o==null||l==null||c==null)throw new h.ProtocolError("failed to receive type information in response to a Parse message");return[2,[o,c,l,f,w,m]]}})})()}},{key:"_encodeArgs",value:function e(e,t){if((0,d.versionGreaterThanOrEqual)(this.protocolVersion,[0,12])){if(t===u.NULL_CODEC){if(e!=null)throw new h.QueryArgumentError("This query does not contain any query parameters, but query arguments were provided to the 'query*()' method");return u.NullCodec.BUFFER}if(v(t,l.ObjectCodec))return t.encodeArgs(e);throw new h.ProtocolError("invalid input codec")}else{if(t===f.EMPTY_TUPLE_CODEC){if(e!=null)throw new h.QueryArgumentError("This query does not contain any query parameters, but query arguments were provided to the 'query*()' method");return f.EmptyTupleCodec.BUFFER}if(v(t,s.NamedTupleCodec)||v(t,f.TupleCodec))return t.encodeArgs(e);throw new h.ProtocolError("invalid input codec")}}},{key:"_legacyExecuteFlow",value:function e(e,t,r,n){var i=this;return a(function(){var a,o,u,s;return B(this,function(c){switch(c.label){case 0:a=new b.WriteMessageBuffer;a.beginMessage(g.$E).writeLegacyHeaders({allowCapabilities:S}).writeString("").writeBuffer(i._encodeArgs(e,t)).endMessage().writeSync(),i._sendData(a.unwrap());o=!0,u=null;c.label=1;case 1:if(!o)return[3,5];s=i.buffer.takeMessage();if(s)return[3,3];return[4,i._waitForMessage()];case 2:s=c.sent();c.label=3;case 3:switch(s,i.buffer.getMessageType()){case g.$D:{if(u==null)try{i._parseDataMessages(r,n)}catch(e){u=e,i.buffer.finishMessage()}else i.buffer.discardMessage();break}case g.$C:{i.lastStatus=i._parseCommandCompleteMessage();break}case g.$E:{u=i._parseErrorMessage();break}case g.$Z:{i._parseSyncMessage(),o=!1;break}default:i._fallthrough()}c.label=4;case 4:return[3,1];case 5:if(u!=null)throw u;return[2]}})})()}},{key:"_legacyOptimisticExecuteFlow",value:function e(e,t,r,n,i,o,u){var s=this;return a(function(){var a,c,l,f,d,h,v,p,w,m;return B(this,function(_){switch(_.label){case 0:a=n===y.Cardinality.ONE||n===y.Cardinality.AT_MOST_ONE,c=new b.WriteMessageBuffer;c.beginMessage(g.$O),c.writeLegacyHeaders({explicitObjectids:"true",allowCapabilities:S}),c.writeChar(r),c.writeChar(a?y.Cardinality.AT_MOST_ONE:y.Cardinality.MANY),c.writeString(e),c.writeBuffer(i.tidBuffer),c.writeBuffer(o.tidBuffer),c.writeBuffer(s._encodeArgs(t,i)),c.endMessage(),c.writeSync(),s._sendData(c.unwrap());l=!1,f=null,d=!0,h=null,v=-1;_.label=1;case 1:if(!d)return[3,5];p=s.buffer.takeMessage();if(p)return[3,3];return[4,s._waitForMessage()];case 2:p=_.sent();_.label=3;case 3:switch(p,s.buffer.getMessageType()){case g.$D:{if(f==null)try{s._parseDataMessages(o,u)}catch(e){f=e,s.buffer.finishMessage()}else s.buffer.discardMessage();break}case g.$C:{s.lastStatus=s._parseCommandCompleteMessage();break}case g.$Z:{s._parseSyncMessage(),d=!1;break}case g.$T:{try{;w=I(s._parseDescribeTypeMessage(),4),h=w[0],i=w[1],o=w[2],v=w[3],w;m=s._getQueryCacheKey(e,r,n);s.queryCodecCache.set(m,[h,i,o,v]),l=!0}catch(e){f=e}break}case g.$E:{f=s._parseErrorMessage(),f._query=e;break}default:s._fallthrough()}_.label=4;case 4:return[3,1];case 5:if(f!=null)throw f;if(!l)return[3,7];s._validateFetchCardinality(h,r,n);return[4,s._legacyExecuteFlow(t,i,o,u)];case 6:return[2,_.sent()];case 7:return[2]}})})()}},{key:"_encodeParseParams",value:function e(e,t,r,n,i,a,o){var s,c,l,f;var d,h;if(e.writeFlags(4294967295,a),e.writeFlags(0,0|(((s=o)===null||s===void 0?void 0:s.injectObjectids)?P.INJECT_OUTPUT_OBJECT_IDS:0)|(((c=o)===null||c===void 0?void 0:c.injectTypeids)?P.INJECT_OUTPUT_TYPE_IDS:0)|(((l=o)===null||l===void 0?void 0:l.injectTypenames)?P.INJECT_OUTPUT_TYPE_NAMES:0)),e.writeBigInt64((d=(f=o)===null||f===void 0?void 0:f.implicitLimit)!==null&&d!==void 0?d:BigInt(0)),e.writeChar(r),e.writeChar(n===y.Cardinality.ONE||n===y.Cardinality.AT_MOST_ONE?y.Cardinality.AT_MOST_ONE:y.Cardinality.MANY),e.writeString(t),!this.adminUIMode&&i===_.Session.defaults())e.writeBuffer(u.NULL_CODEC.tidBuffer),e.writeInt32(0);else if(e.writeBuffer(this.stateCodec.tidBuffer),this.stateCodec===u.INVALID_CODEC||this.stateCodec===u.NULL_CODEC)e.writeInt32(0);else{if(((h=this.stateCache)===null||h===void 0?void 0:h[0])!==i){var v=new b.WriteBuffer;this.stateCodec.encode(v,i._serialise()),this.stateCache=[i,v.unwrap()]}e.writeBuffer(this.stateCache[1])}}},{key:"_parse",value:function e(e,t,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:k,o=arguments.length>5?arguments[5]:void 0;var u=this;return a(function(){var a,s,c,l,f,d,p,y,w,m,_,E;return B(this,function(O){switch(O.label){case 0:a=new b.WriteMessageBuffer;a.beginMessage(g.$P),a.writeUInt16(0),u._encodeParseParams(a,e,t,r,n,i,o),a.endMessage(),a.writeSync(),u._sendData(a.unwrap());s=!0,c=null,l=null,f=-1,d=null,p=null,y=null,w=null;O.label=1;case 1:if(!s)return[3,5];m=u.buffer.takeMessage();if(m)return[3,3];return[4,u._waitForMessage()];case 2:m=O.sent();O.label=3;case 3:switch(m,u.buffer.getMessageType()){case g.$T:{try{;_=I(u._parseDescribeTypeMessage(),6),l=_[0],d=_[1],p=_[2],f=_[3],y=_[4],w=_[5],_;E=u._getQueryCacheKey(e,t,r);u.queryCodecCache.set(E,[l,d,p,f])}catch(e){c=e}break}case g.$E:{c=u._parseErrorMessage(),c._query=e;break}case g.$s:{u._parseDescribeStateMessage();break}case g.$Z:{u._parseSyncMessage(),s=!1;break}default:u._fallthrough()}O.label=4;case 4:return[3,1];case 5:if(c!==null){if(v(c,h.StateMismatchError))return[2,u._parse(e,t,r,n,i,o)];throw c}return[2,[l,d,p,f,y,w]]}})})()}},{key:"_executeFlow",value:function e(e,t,r,n,i,o,u,s){var c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:k,l=arguments.length>9?arguments[9]:void 0;var f=this;return a(function(){var a,d,p,y,w,m,_,E,O,C;return B(this,function(S){switch(S.label){case 0:a=new b.WriteMessageBuffer;a.beginMessage(g.$O),a.writeUInt16(0),f._encodeParseParams(a,e,r,n,i,c,l),a.writeBuffer(o.tidBuffer),a.writeBuffer(u.tidBuffer),o?a.writeBuffer(f._encodeArgs(t,o)):a.writeInt32(0),a.endMessage(),a.writeSync(),f._sendData(a.unwrap());d=null,p=!0;S.label=1;case 1:if(!p)return[3,5];y=f.buffer.takeMessage();if(y)return[3,3];return[4,f._waitForMessage()];case 2:y=S.sent();S.label=3;case 3:switch(y,f.buffer.getMessageType()){case g.$D:{if(d==null)try{f._parseDataMessages(u,s)}catch(e){d=e,f.buffer.finishMessage()}else f.buffer.discardMessage();break}case g.$C:{f.lastStatus=f._parseCommandCompleteMessage();break}case g.$Z:{f._parseSyncMessage(),p=!1;break}case g.$T:{try{w=I(f._parseDescribeTypeMessage(),4),m=w[0],_=w[1],E=w[2],O=w[3],C=f._getQueryCacheKey(e,r,n);f.queryCodecCache.set(C,[m,_,E,O]),u=E}catch(e){d=e}break}case g.$s:{f._parseDescribeStateMessage();break}case g.$E:{d=f._parseErrorMessage(),d._query=e;break}default:f._fallthrough()}S.label=4;case 4:return[3,1];case 5:if(d!=null){if(v(d,h.StateMismatchError))return[2,f._executeFlow(e,t,r,n,i,o,u,s,c,l)];throw d}return[2]}})})()}},{key:"_getQueryCacheKey",value:function e(e,t,r){var n=r===y.Cardinality.ONE||r===y.Cardinality.AT_MOST_ONE;return[t,n,e.length,e].join(";")}},{key:"_validateFetchCardinality",value:function e(e,t,r){if(r===y.Cardinality.ONE&&e===y.Cardinality.NO_RESULT)throw new h.NoDataError("query executed via queryRequiredSingle".concat(t===y.OutputFormat.JSON?"JSON":"","() returned no data"))}},{key:"fetch",value:function e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;var s=this;return a(function(){var a,c,l,f,d,p,b,g,w,m,E,C,S,k,M,P,T,D,A,j,N,U,L,R;return B(this,function(B){switch(B.label){case 0:if(s.isLegacyProtocol&&r===y.OutputFormat.NONE){if(t!=null)throw new h.InterfaceError("arguments in execute() is not supported in this version of EdgeDB. Upgrade to EdgeDB 2.0 or newer.");return[2,s.legacyExecute(e,o)]}s._checkState();l=n===y.Cardinality.ONE,f=l||n===y.Cardinality.AT_MOST_ONE,d=r===y.OutputFormat.JSON,p=s._getQueryCacheKey(e,r,n),b=[];if(!s.isLegacyProtocol)return[3,6];if(i!==_.Session.defaults())throw new h.InterfaceError("setting session state is not supported in this version of EdgeDB. Upgrade to EdgeDB 2.0 or newer.");if(!s.queryCodecCache.has(p))return[3,2];g=I(s.queryCodecCache.get(p),3),w=g[0],m=g[1],E=g[2];s._validateFetchCardinality(w,r,n);return[4,s._legacyOptimisticExecuteFlow(e,t,r,n,m,E,b)];case 1:B.sent();return[3,5];case 2:return[4,s._legacyParse(e,r,f)];case 3:C=I.apply(void 0,[B.sent(),4]),S=C[0],k=C[1],M=C[2],P=C[3];s._validateFetchCardinality(S,r,n),s.queryCodecCache.set(p,[S,k,M,P]);return[4,s._legacyExecuteFlow(t,k,M,b)];case 4:B.sent();B.label=5;case 5:return[3,15];case 6:T=I((a=s.queryCodecCache.get(p))!==null&&a!==void 0?a:[],3),D=T[0],A=T[1],j=T[2];D&&s._validateFetchCardinality(D,r,n);U=!A&&t!==null||s.stateCodec===u.INVALID_CODEC&&i!==_.Session.defaults();if(!U)return[3,8];return[4,s._parse(e,r,n,i,o?O.ALL:void 0)];case 7:U=(N=I.apply(void 0,[B.sent(),3]),D=N[0],A=N[1],j=N[2],N,s._validateFetchCardinality(D,r,n));B.label=8;case 8:U;B.label=9;case 9:B.trys.push([9,11,,15]);return[4,s._executeFlow(e,t,r,n,i,A!==null&&A!==void 0?A:u.NULL_CODEC,j!==null&&j!==void 0?j:u.NULL_CODEC,b,o?O.ALL:void 0)];case 10:B.sent();return[3,15];case 11:L=B.sent();if(!v(L,h.ParameterTypeMismatchError))return[3,13];R=I(s.queryCodecCache.get(p),3),D=R[0],A=R[1],j=R[2],R;return[4,s._executeFlow(e,t,r,n,i,A!==null&&A!==void 0?A:u.NULL_CODEC,j!==null&&j!==void 0?j:u.NULL_CODEC,b,o?O.ALL:void 0)];case 12:B.sent();return[3,14];case 13:throw L;case 14:return[3,15];case 15:if(r!==y.OutputFormat.NONE)if(f){if(l&&!b.length)throw new h.NoDataError("query returned no data");return[2,(c=b[0])!==null&&c!==void 0?c:d?"null":null]}else return[2,b&&b.length?d?b[0]:b:d?"[]":b];return[2]}})})()}},{key:"getQueryCapabilities",value:function e(e,t,r){var n,i;var a=this._getQueryCacheKey(e,t,r);return(i=(n=this.queryCodecCache.get(a))===null||n===void 0?void 0:n[3])!==null&&i!==void 0?i:null}},{key:"legacyExecute",value:function e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;var r=this;return a(function(){var n,i,a,o;return B(this,function(u){switch(u.label){case 0:r._checkState();n=new b.WriteMessageBuffer;n.beginMessage(g.$Q).writeLegacyHeaders({allowCapabilities:t?void 0:S}).writeString(e).endMessage(),r._sendData(n.unwrap());i=null,a=!0;u.label=1;case 1:if(!a)return[3,5];o=r.buffer.takeMessage();if(o)return[3,3];return[4,r._waitForMessage()];case 2:o=u.sent();u.label=3;case 3:switch(o,r.buffer.getMessageType()){case g.$C:{r.lastStatus=r._parseCommandCompleteMessage();break}case g.$Z:{r._parseSyncMessage(),a=!1;break}case g.$E:{i=r._parseErrorMessage(),i._query=e;break}default:r._fallthrough()}u.label=4;case 4:return[3,1];case 5:if(i!=null)throw i;return[2]}})})()}},{key:"resetState",value:function e(){var e=this;return a(function(){var t;return B(this,function(r){switch(r.label){case 0:if(!(e.connected&&e.serverXactStatus!==E.TRANS_IDLE))return[3,4];r.label=1;case 1:r.trys.push([1,3,,4]);return[4,e.fetch("rollback",void 0,y.OutputFormat.NONE,y.Cardinality.NO_RESULT,_.Session.defaults(),!0)];case 2:r.sent();return[3,4];case 3:t=r.sent();e._abortWithError(new h.ClientConnectionClosedError("failed to reset state"));return[3,4];case 4:return[2]}})})()}},{key:"_abort",value:function e(){this.connected=!1,this._abortWaiters(this.getConnAbortError()),this.connAbortWaiter.done||this.connAbortWaiter.set()}},{key:"isClosed",value:function e(){return!this.connected}},{key:"close",value:function e(){var e=this;return a(function(){return B(this,function(t){e._abort();return[2]})})()}},{key:"rawParse",value:function e(e,t,r){var n=this;return a(function(){var i;return B(this,function(a){switch(a.label){case 0:return[4,n._parse(e,y.OutputFormat.BINARY,y.Cardinality.MANY,t,M,r)];case 1:i=a.sent();return[2,[i[1],i[2],i[4],i[5],n.protocolVersion,i[3]]]}})})()}},{key:"rawExecute",value:function e(e,t,r,n,i){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;var s=this;return a(function(){var a;return B(this,function(c){switch(c.label){case 0:a=new b.WriteBuffer;return[4,s._executeFlow(e,o,r?y.OutputFormat.BINARY:y.OutputFormat.NONE,y.Cardinality.MANY,t,i!==null&&i!==void 0?i:u.NULL_CODEC,r!==null&&r!==void 0?r:u.NULL_CODEC,a,M,n)];case 1:return[2,(c.sent(),a.unwrap())]}})})()}}]);return t}();e.BaseRawConnection=D});var eH=$(function(e){"use strict";var t=function e(e){return e.normalize("NFKC")};var r=function e(e,t){if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0};var n=function e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v;return(0,f.randomBytes)(e)};var i=function e(e,r){var n="n=".concat(t(r),",r=").concat((0,d.encodeB64)(e));return["n,,".concat(n),n]};var o=function e(e){var t=e.split(",");if(t.length<3)throw new h.ProtocolError("malformed SCRAM message");var r=t[0];if(!r||r[0]!=="r")throw new h.ProtocolError("malformed SCRAM message");var n=r.split("=",2)[1];if(!n)throw new h.ProtocolError("malformed SCRAM message");var i=(0,d.decodeB64)(n),a=t[1];if(!a||a[0]!=="s")throw new h.ProtocolError("malformed SCRAM message");var o=a.split("=",2)[1];if(!o)throw new h.ProtocolError("malformed SCRAM message");var u=(0,d.decodeB64)(o),s=t[2];if(!s||s[0]!=="i")throw new h.ProtocolError("malformed SCRAM message");var c=s.split("=",2)[1];if(!c||!c.match(/^[0-9]*$/))throw new h.ProtocolError("malformed SCRAM message");var l=parseInt(c,10);if(l<=0)throw new h.ProtocolError("malformed SCRAM message");return[i,u,l]};var u=function e(e){var t=e.split(",");if(t.length<1)throw new h.ProtocolError("malformed SCRAM message");var r=t[0];if(!r||r[0]!=="v")throw new h.ProtocolError("malformed SCRAM message");var n=r.split("=",2)[1];if(!n)throw new h.ProtocolError("malformed SCRAM message");return(0,d.decodeB64)(n)};var s=function e(e){return(0,f.HMAC)(e,d.utf8Encoder.encode("Client Key"))};var c=function e(e){return(0,f.HMAC)(e,d.utf8Encoder.encode("Server Key"))};var l=function e(e,t){var r=e.length;if(r!==t.length)throw new h.ProtocolError("scram.XOR: buffers are of different lengths");var n=new Uint8Array(r);for(var i=0;i<r;i++)n[i]=e[i]^t[i];return n};Object.defineProperty(e,"__esModule",{value:!0});e.XOR=e.getServerKey=e.getClientKey=e.getSaltedPassword=e.buildClientFinalMessage=e.parseServerFinalMessage=e.parseServerFirstMessage=e.buildClientFirstMessage=e.generateNonce=e.bufferEquals=e.saslprep=e.HMAC=e.H=void 0;var f=eB();Object.defineProperty(e,"H",{enumerable:!0,get:function e(){return f.H}});Object.defineProperty(e,"HMAC",{enumerable:!0,get:function e(){return f.HMAC}});var d=Q(),h=ee(),v=18;e.saslprep=t;e.bufferEquals=r;e.generateNonce=n;e.buildClientFirstMessage=i;e.parseServerFirstMessage=o;e.parseServerFinalMessage=u;function p(e,t,r,n,i,a){return y.apply(this,arguments)}function y(){y=a(function(e,r,n,i,a,o){var u,h,v,p,y,g,w,m,_;return B(this,function(E){switch(E.label){case 0:u="c=biws,r=".concat((0,d.encodeB64)(o)),h=d.utf8Encoder.encode("".concat(i,",").concat(a,",").concat(u));return[4,b(d.utf8Encoder.encode(t(e)),r,n)];case 1:v=E.sent();return[4,s(v)];case 2:p=E.sent();return[4,(0,f.H)(p)];case 3:y=E.sent();return[4,(0,f.HMAC)(y,h)];case 4:g=E.sent(),w=l(p,g);return[4,c(v)];case 5:m=E.sent();return[4,(0,f.HMAC)(m,h)];case 6:_=E.sent();return[2,["".concat(u,",p=").concat((0,d.encodeB64)(w)),_]]}})});return y.apply(this,arguments)}e.buildClientFinalMessage=p;function b(e,t,r){return g.apply(this,arguments)}function g(){g=a(function(e,t,r){var n,i,a,o;return B(this,function(u){switch(u.label){case 0:n=new Uint8Array(t.length+4);n.set(t),n.set([0,0,0,1],t.length);return[4,(0,f.HMAC)(e,n)];case 1:i=u.sent(),a=i;o=0;u.label=2;case 2:if(!(o<r-1))return[3,5];return[4,(0,f.HMAC)(e,a)];case 3:a=u.sent(),i=l(i,a);u.label=4;case 4:o++;return[3,2];case 5:return[2,i]}})});return g.apply(this,arguments)}e.getSaltedPassword=b;e.getClientKey=s;e.getServerKey=c;e.XOR=l});var eW=$(function(e){"use strict";var t=function e(e){return(0,o.encodeB64)(o.utf8Encoder.encode(e))};var r=function e(e){return o.utf8Decoder.decode((0,o.decodeB64)(e))};var n=function e(e){var t;var n=new Map(e.length>0?e.split(",").map(function(e){return e.split(/=(.+)?/,2)}).map(function(e){var t=I(e,2),r=t[0],n=t[1];return[r.trim(),n.trim()]}):[]),i=(t=n.get("sid"))!==null&&t!==void 0?t:null,a=n.get("data"),o=a?r(a):null;return{sid:i,data:o}};Object.defineProperty(e,"__esModule",{value:!0});e.HTTPSCRAMAuth=void 0;var i=ee(),o=Q(),u=eH(),s="/auth/token";function c(e,t,r){return l.apply(this,arguments)}function l(){l=a(function(e,r,a){var o,c,l,f,d,h,v,p,y,b,g,w,m,_,E,O,C,S,k,M,P,T,D,A,j,N,U,L;return B(this,function(B){switch(B.label){case 0:c=e+s;return[4,(0,u.generateNonce)()];case 1:l=B.sent(),f=I((0,u.buildClientFirstMessage)(l,r),2),d=f[0],h=f[1];return[4,fetch(c,{headers:{Authorization:"SCRAM-SHA-256 data=".concat(t(d))}})];case 2:v=B.sent(),p=v.headers.get("WWW-Authenticate");if(!(v.status!==401||!p))return[3,4];return[4,v.text()];case 3:y=B.sent();throw new i.ProtocolError("authentication failed: ".concat(y));case 4:if(!p.startsWith("SCRAM-SHA-256"))throw new i.ProtocolError("unsupported authentication scheme: ".concat(p));b=(o=p.split(/ (.+)?/,2)[1])!==null&&o!==void 0?o:"";if(!(b.length===0))return[3,6];return[4,v.text()];case 5:g=B.sent();throw new i.ProtocolError("authentication failed: ".concat(g));case 6:w=n(b),m=w.sid,_=w.data;if(!m||!_)throw new i.ProtocolError('authentication challenge missing attributes: expected "sid" and "data", got \''.concat(b,"'"));E=I((0,u.parseServerFirstMessage)(_),3),O=E[0],C=E[1],S=E[2];return[4,(0,u.buildClientFinalMessage)(a,C,S,h,_,O)];case 7:k=I.apply(void 0,[B.sent(),2]),M=k[0],P=k[1];return[4,fetch(c,{headers:{Authorization:"SCRAM-SHA-256 sid=".concat(m,", data=").concat(t(M))}})];case 8:T=B.sent(),D=T.headers.get("Authentication-Info");if(!(!T.ok||!D))return[3,10];return[4,T.text()];case 9:A=B.sent();throw new i.ProtocolError("authentication failed: ".concat(A));case 10:j=n(D),N=j.data,U=j.sid;if(!U||!N)throw new i.ProtocolError('authentication info missing attributes: expected "sid" and "data", got \''.concat(D,"'"));if(U!==m)throw new i.ProtocolError("SCRAM session id does not match");L=(0,u.parseServerFinalMessage)(N);if(!(0,u.bufferEquals)(L,P))throw new i.ProtocolError("server SCRAM proof does not match");return[4,T.text()];case 11:return[2,B.sent()]}})});return l.apply(this,arguments)}e.HTTPSCRAMAuth=c});var e$=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n},u=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.FetchConnection=e.AdminUIFetchConnection=void 0;var s=eq(),l=u(eT()),f=i(V()),d=ee(),v=eW(),p="application/x.edgedb.v_".concat(s.PROTO_VER[0],"_").concat(s.PROTO_VER[1],".binary'"),y=function(e){h(r,e);var t=U(r);function r(e,i){o(this,r);var a;a=t.call(this,i),Object.defineProperty(n(a),"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(a),"addr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.config=e,a.addr=a._buildAddr();return S(a)}c(r,[{key:"_buildAddr",value:function e(){this.throwNotImplemented("_buildAddr")}},{key:"_waitForMessage",value:function e(){var e=this;return a(function(){return B(this,function(t){switch(t.label){case 0:if(!!e.buffer.takeMessage())return[3,2];if(e.messageWaiter==null||e.messageWaiter.done)throw new d.InternalClientError("message waiter was not initialized before waiting for response");return[4,e.messageWaiter.wait()];case 1:t.sent();t.label=2;case 2:return[2]}})})()}},{key:"__sendData",value:function e(e){var t=this;return a(function(){var r,n,i,a,o,u;return B(this,function(s){switch(s.label){case 0:if(t.buffer.takeMessage()){r=t.buffer.getMessageType();throw new d.InternalClientError("sending request before reading all data of the previous one: ".concat(f.chr(r)))}if(t.messageWaiter!=null&&!t.messageWaiter.done)throw new d.InternalClientError("sending request before waiting for completion of the previous one");t.messageWaiter=new l.default;s.label=1;case 1:s.trys.push([1,4,5,6]);n={"Content-Type":p};t.config.user!==void 0&&(n["X-EdgeDB-User"]=t.config.user),t.config.token!==void 0&&(n.Authorization="Bearer ".concat(t.config.token));return[4,fetch(t.addr,{method:"post",body:e,headers:n})];case 2:i=s.sent();if(!i.ok)throw new d.ProtocolError("fetch failed with status code ".concat(i.status,": ").concat(i.statusText));return[4,i.arrayBuffer()];case 3:a=s.sent(),o=new Uint8Array(a);try{t.buffer.feed(o)}catch(e){t.messageWaiter.setError(e)}if(!t.buffer.takeMessage())throw new d.ProtocolError("no binary protocol messages in the response");t.messageWaiter.set();return[3,6];case 4:u=s.sent();t.messageWaiter.setError(u);return[3,6];case 5:t.messageWaiter=null;return[7];case 6:return[2]}})})()}},{key:"_sendData",value:function e(e){this.__sendData(e)}}],[{key:"create",value:function e(e,t){var r=new this(e,t);return r.connected=!0,r.connWaiter.set(),r}}]);return r}(s.BaseRawConnection),b=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"adminUIMode",{enumerable:!0,configurable:!0,writable:!0,value:!0});return S(e)}c(r,[{key:"_buildAddr",value:function e(){var e=this.config;if(typeof e.address=="string")return"".concat(e.address,"/db/").concat(e.database);var t=e.address,r=e.tlsSecurity,n=e.database;return"".concat("".concat(r==="insecure"?"http":"https","://").concat(t[0],":").concat(t[1]),"/db/").concat(n)}}]);return r}(y);e.AdminUIFetchConnection=b;var g=new WeakMap,w=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"_buildAddr",value:function e(){var e=this.config;if(typeof e.address=="string")return"".concat(e.address,"/db/").concat(e.database);var t=e.address,r=e.tlsSecurity,n=e.database;return"".concat("".concat(r==="insecure"?"http":"https","://").concat(t[0],":").concat(t[1]),"/db/").concat(n)}}],[{key:"connectWithTimeout",value:function e(e,t,n){return a(function(){var i,a,o,u,s,c,l,f,d;return B(this,function(h){switch(h.label){case 0:i=t.connectionParams,a=i.tlsSecurity,o=i.user,u=i.password,s=u===void 0?"":u,c=i.secretKey,l=c!==null&&c!==void 0?c:g.get(t);if(!!l)return[3,2];f="".concat(a==="insecure"?"http":"https","://").concat(e[0],":").concat(e[1]);return[4,(0,v.HTTPSCRAMAuth)(f,o,s)];case 1:l=h.sent(),g.set(t,l);h.label=2;case 2:d=new r({address:e,tlsSecurity:a,database:t.connectionParams.database,user:t.connectionParams.user,token:l},n);return[2,(d.connected=!0,d.connWaiter.set(),d)]}})})()}}]);return r}(y);e.FetchConnection=w});var eY=$(function(e){"use strict";var t=function e(){throw new u.EdgeDBError("'createClient()' cannot be used in browser (or edge runtime) environment, use 'createHttpClient()' API instead")};var r=function e(e){return new i.Client(new f(l,typeof e=="string"?{dsn:e}:e!==null&&e!==void 0?e:{}),c.Options.defaults())};Object.defineProperty(e,"__esModule",{value:!0});e.createHttpClient=e.createClient=e.FetchClientPool=void 0;var i=eN(),a=eR(),u=ee(),s=e$(),c=eP(),l=(0,a.getConnectArgumentsParser)(null),f=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"isStateless",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(n(e),"_connectWithTimeout",{enumerable:!0,configurable:!0,writable:!0,value:s.FetchConnection.connectWithTimeout});return S(e)}return r}(i.BaseClientPool);e.FetchClientPool=f;e.createClient=t;e.createHttpClient=r});var eK=$(function(e){"use strict";var t=function e(){return!0};var r=function e(e){return h.promises.watch(e,{recursive:!0})};var n=function e(e){return d.createHash("sha1").update(e).digest("hex")};var i=function e(e,t){var r;var n=!1,i=((r=t)===null||r===void 0?void 0:r.silent)?new m.Writable({write:function e(e,t,r){n||g.default.stdout.write(e,t),r()}}):g.default.stdout,a=w.createInterface({input:g.default.stdin,output:i});return new Promise(function(t,r){a.question(e,function(e){a.close(),t(e)}),n=!0})};var o=function e(e){g.default.exit(e)};var u=function e(){return __dirname};var s=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),c=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return c(t,e),t},f=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.srcDir=e.exit=e.homeDir=e.input=e.exists=e.walk=e.hashSHA1toHex=e.readDir=e.watch=e.hasFSReadPermission=e.readFileUtf8=e.process=e.tls=e.fs=e.net=e.path=void 0;var d=l(W("crypto")),h=W("fs");Object.defineProperty(e,"fs",{enumerable:!0,get:function e(){return h.promises}});var v=l(W("net"));e.net=v;var p=l(W("os")),y=l(W("path"));e.path=y;var b=l(W("tls"));e.tls=b;var g=f(W("process"));e.process=g.default;var w=l(W("readline")),m=W("stream");function _(){return E.apply(this,arguments)}function E(){E=a(function(){var e,t,r,n;var i=arguments;return B(this,function(a){switch(a.label){case 0:for(e=i.length,t=new Array(e),r=0;r<e;r++){t[r]=i[r]}return[4,h.promises.readFile((n=y).join.apply(n,T(t)),{encoding:"utf8"})];case 1:return[2,a.sent()]}})});return E.apply(this,arguments)}e.readFileUtf8=_;e.hasFSReadPermission=t;e.watch=r;function O(e){return C.apply(this,arguments)}function C(){C=a(function(e){return B(this,function(t){return[2,h.promises.readdir(e)]})});return C.apply(this,arguments)}e.readDir=O;e.hashSHA1toHex=n;function S(e,t){return k.apply(this,arguments)}function k(){k=a(function(e,t){var r,n,i,a,o,u,s,c;return B(this,function(l){switch(l.label){case 0:n=t||{},i=n.match,a=n.skip,o=a===void 0?[]:a;l.label=1;case 1:l.trys.push([1,3,,4]);return[4,h.promises.access(e)];case 2:l.sent();return[3,4];case 3:u=l.sent();return[2,[]];case 4:return[4,h.promises.readdir(e,{withFileTypes:!0})];case 5:s=l.sent();return[4,Promise.all(s.map(function(r){var n=y.resolve(e,r.name);return o&&o.some(function(e){return e.test(n)})?[]:r.isDirectory()?S(n,t):i&&!i.some(function(e){return e.test(n)})?[]:[n]}))];case 6:c=l.sent();return[2,(r=Array.prototype).concat.apply(r,T(c))]}})});return k.apply(this,arguments)}e.walk=S;function I(e){return M.apply(this,arguments)}function M(){M=a(function(e){var t;return B(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,h.promises.access(e)];case 1:return[2,(r.sent(),!0)];case 2:t=r.sent();return[2,!1];case 3:return[2]}})});return M.apply(this,arguments)}e.exists=I;e.input=i;e.homeDir=p.homedir;e.exit=o;e.srcDir=u});var eV=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.searchConfigDir=e.isWindows=void 0;var t=eK();e.isWindows=process.platform==="win32";var r;process.platform==="darwin"?r=function(){return t.path.join((0,t.homeDir)(),"Library","Application Support","edgedb")}:process.platform==="win32"?r=function(){var e;var r=(e=process.env.LOCALAPPDATA)!==null&&e!==void 0?e:t.path.join((0,t.homeDir)(),"AppData","Local");return t.path.join(r,"EdgeDB","config")}:r=function(){var e=process.env.XDG_CONFIG_HOME;return(!e||!t.path.isAbsolute(e))&&(e=t.path.join((0,t.homeDir)(),".config")),t.path.join(e,"edgedb")};function n(){return i.apply(this,arguments)}function i(){i=a(function(){var e,n,i,a,o,u,s;var c=arguments;return B(this,function(l){switch(l.label){case 0:for(e=c.length,n=new Array(e),i=0;i<e;i++){n[i]=c[i]}u=(a=t.path).join.apply(a,[r()].concat(T(n)));return[4,(0,t.exists)(u)];case 1:if(l.sent())return[2,u];s=(o=t.path).join.apply(o,[(0,t.homeDir)(),".edgedb"].concat(T(n)));return[4,(0,t.exists)(s)];case 2:return[2,l.sent()?s:u]}})});return i.apply(this,arguments)}e.searchConfigDir=n});var eJ=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0});e.parseConnectArguments=e.serverUtils=e.findStashPath=void 0;var i=eK(),o=n(eV()),u=eR(),s=new Map;function c(){return l.apply(this,arguments)}function l(){l=a(function(){var e,t,r,n,a,o;var u=arguments;return B(this,function(c){switch(c.label){case 0:e=u.length>0&&u[0]!==void 0?u[0]:!0;if(!e&&!(0,i.hasFSReadPermission)())return[2,null];t=process.cwd();if(s.has(t))return[2,s.get(t)];r=t;return[4,i.fs.stat(r)];case 1:n=c.sent().dev;c.label=2;case 2:return[4,(0,i.exists)(i.path.join(r,"edgedb.toml"))];case 3:if(c.sent())return[2,(s.set(t,r),r)];a=i.path.join(r,"..");o=a===r;if(o)return[3,5];return[4,i.fs.stat(a)];case 4:o=c.sent().dev!==n;c.label=5;case 5:if(o)return[2,(s.set(t,null),null)];r=a;c.label=6;case 6:return[3,2];case 7:return[2]}})});return l.apply(this,arguments)}function f(e){return d.apply(this,arguments)}function d(){d=a(function(e){var t,r,n;return B(this,function(a){switch(a.label){case 0:return[4,i.fs.realpath(e)];case 1:t=a.sent();o.isWindows&&!t.startsWith("\\\\")&&(t="\\\\?\\"+t);r=(0,i.hashSHA1toHex)(t),n=i.path.basename(t)+"-"+r;return[2,o.searchConfigDir("projects",n)]}})});return d.apply(this,arguments)}e.findStashPath=f;e.serverUtils={findProjectDir:c,findStashPath:f,readFileUtf8:i.readFileUtf8,searchConfigDir:o.searchConfigDir};e.parseConnectArguments=(0,u.getConnectArgumentsParser)(e.serverUtils)});var eG=$(function(e){"use strict";var t=function e(e){if(k.has(e))return k.get(e);var t=e.tlsSecurity,r={ALPNProtocols:["edgedb-binary"],servername:e.address[0],rejectUnauthorized:t!=="insecure"};return k.set(e,r),e._tlsCAData!==null&&(r.ca=e._tlsCAData),t==="no_host_verification"&&(r.checkServerIdentity=function(e,t){var r=l.tls.checkServerIdentity(e,t);if(r!==void 0&&!r.message.startsWith("Hostname/IP does not match certificate"))return r}),r};var r=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),i=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.RawConnection=void 0;var l=eK(),p=eq(),y=ek(),b=Q(),g=s(eT()),w=u(V()),_=u(eH()),O=u(ee()),C;(function(e){e[e.AUTH_OK=0]="AUTH_OK",e[e.AUTH_SASL=10]="AUTH_SASL",e[e.AUTH_SASL_CONTINUE=11]="AUTH_SASL_CONTINUE",e[e.AUTH_SASL_FINAL=12]="AUTH_SASL_FINAL"})(C||(C={}));var k=new WeakMap;var M=function(e){h(i,e);var r=U(i);function i(e,t,a){o(this,i);var u;u=r.call(this,a),Object.defineProperty(n(u),"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(u),"sock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n(u),"paused",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),u.config=t,u.paused=!1,u.sock=e,u.sock.setNoDelay(),u.sock.on("error",u._onError.bind(n(u))),u.sock.on("data",u._onData.bind(n(u))),l.tls.TLSSocket&&v(u.sock,l.tls.TLSSocket)?u.sock.on("secureConnect",u._onConnect.bind(n(u))):u.sock.on("connect",u._onConnect.bind(n(u))),u.sock.on("close",u._onClose.bind(n(u)));return S(u)}c(i,[{key:"_onConnect",value:function e(){this.connWaiter.set()}},{key:"_onClose",value:function e(){if(!this.connected)return;var e=new O.ClientConnectionClosedError("the connection has been aborted");(!this.connWaiter.done||this.messageWaiter)&&this._abortWaiters(e),this.buffer.takeMessage()&&this.buffer.getMessageType()===w.$E&&(e.source=this._parseErrorMessage()),this._abortWithError(e)}},{key:"_onError",value:function e(e){var t=new O.ClientConnectionClosedError("network error: ".concat(e));t.source=e;try{this._abortWaiters(t)}finally{this._abortWithError(t)}}},{key:"_onData",value:function e(e){try{this.buffer.feed(e)}catch(e){this.messageWaiter&&(this.messageWaiter.setError(e),this.messageWaiter=null),this._abortWithError(e)}this.messageWaiter&&this.buffer.takeMessage()&&(this.messageWaiter.set(),this.messageWaiter=null)}},{key:"_waitForMessage",value:function e(){var e=this;return a(function(){return B(this,function(t){switch(t.label){case 0:if(!!e.buffer.takeMessage())return[3,4];e.paused&&(e.paused=!1,e.sock.resume()),e.sock.ref(),e.messageWaiter=new g.default;t.label=1;case 1:t.trys.push([1,,3,4]);return[4,e.messageWaiter.wait()];case 2:t.sent();return[3,4];case 3:e.sock.unref();return[7];case 4:return[2]}})})()}},{key:"_sendData",value:function e(e){this.sock.write(e)}},{key:"_abort",value:function e(){this.sock&&this.connected&&this.sock.destroy(),f(d(i.prototype),"_abort",this).call(this)}},{key:"close",value:function e(){var e=this;var t=this,r=function(){return f(d(i.prototype),"close",e)};return a(function(){return B(this,function(e){switch(e.label){case 0:t.sock&&t.connected&&t.sock.write(new b.WriteMessageBuffer().beginMessage(w.$X).endMessage().unwrap());return[4,r().call(t)];case 1:return[2,e.sent()]}})})()}},{key:"connect",value:function e(){var e=this;return a(function(){var t,r,n,i,a,o,u,s,c,f,d,h,g,m,_,E,S,k,M;return B(this,function(P){switch(P.label){case 0:return[4,e.connWaiter.wait()];case 1:if(P.sent(),v(e.sock,l.tls.TLSSocket)&&e.sock.alpnProtocol!=="edgedb-binary")throw new O.ClientConnectionFailedError("The server doesn't support the edgedb-binary protocol.");t=new b.WriteMessageBuffer;t.beginMessage(w.$V).writeInt16(e.protocolVersion[0]).writeInt16(e.protocolVersion[1]);r={user:e.config.connectionParams.user,database:e.config.connectionParams.database};e.config.connectionParams.secretKey!=null&&(r.secret_key=e.config.connectionParams.secretKey),t.writeInt16(Object.keys(r).length);n=true,i=false,a=undefined;try{for(o=Object.entries(r)[Symbol.iterator]();!(n=(u=o.next()).done);n=true){s=I(u.value,2),c=s[0],f=s[1];t.writeString(c).writeString(f)}}catch(e){i=true;a=e}finally{try{if(!n&&o.return!=null){o.return()}}finally{if(i){throw a}}}t.writeInt16(0),t.endMessage(),e.sock.write(t.unwrap());P.label=2;case 2:d=e.buffer.takeMessage();if(d)return[3,4];return[4,e._waitForMessage()];case 3:d=P.sent();P.label=4;case 4:h=(d,e.buffer.getMessageType());switch(h){case w.$v:return[3,5];case w.$R:return[3,6];case w.$K:return[3,11];case w.$E:return[3,12];case w.$s:return[3,13];case w.$Z:return[3,14]}return[3,15];case 5:{g=e.buffer.readInt16(),m=e.buffer.readInt16();e._parseHeaders(),e.buffer.finishMessage();_=[g,m];if((0,y.versionGreaterThan)(_,p.PROTO_VER)||(0,y.versionGreaterThan)(p.PROTO_VER_MIN,_))throw new O.UnsupportedProtocolVersionError("the server requested an unsupported version of the protocol ".concat(g,".").concat(m));e.protocolVersion=[g,m],e.isLegacyProtocol=!(0,y.versionGreaterThanOrEqual)(e.protocolVersion,[1,0]);return[3,16]}P.label=6;case 6:E=e.buffer.readInt32();if(!(E===C.AUTH_OK))return[3,7];e.buffer.finishMessage();return[3,10];case 7:if(!(E===C.AUTH_SASL))return[3,9];return[4,e._authSasl()];case 8:P.sent();return[3,10];case 9:throw new O.ProtocolError("unsupported authentication method requested by the server: ".concat(E));case 10:return[3,16];case 11:{e.serverSecret=e.buffer.readBuffer(32),e.buffer.finishMessage();return[3,16]}P.label=12;case 12:throw e._parseErrorMessage();case 13:{e._parseDescribeStateMessage();return[3,16]}P.label=14;case 14:{if(e._parseSyncMessage(),!v(e.sock,l.tls.TLSSocket)&&(typeof Deno==="undefined"?"undefined":D(Deno))>"u"&&(0,y.versionGreaterThanOrEqual)(e.protocolVersion,[0,11])){S=I(e.protocolVersion,2),k=S[0],M=S[1];throw new O.ProtocolError("the protocol version requires TLS: ".concat(k,".").concat(M))}e.connected=!0;return[2]}P.label=15;case 15:e._fallthrough();P.label=16;case 16:return[3,2];case 17:return[2]}})})()}},{key:"_authSasl",value:function e(){var e=this;return a(function(){var t,r,n,i,a,o,u,s,c,l,f,d,h,v,p,y,g,m,E,S,k;return B(this,function(M){switch(M.label){case 0:t=e.buffer.readInt32();if(t<=0)throw new O.ProtocolError("the server requested SASL authentication but did not offer any methods");r=[],n=!1;for(i=0;i<t;i++){a=e.buffer.readString();a==="SCRAM-SHA-256"&&(n=!0),r.push(a)}if(e.buffer.finishMessage(),!n)throw new O.ProtocolError("the server offered the following SASL authentication methods: ".concat(r.join(", "),", neither are supported."));return[4,_.generateNonce()];case 1:o=M.sent(),u=I(_.buildClientFirstMessage(o,e.config.connectionParams.user),2),s=u[0],c=u[1],l=new b.WriteMessageBuffer;l.beginMessage(w.$p).writeString("SCRAM-SHA-256").writeString(s).endMessage(),e.sock.write(l.unwrap());return[4,e._ensureMessage(w.$R,"SASLContinue")];case 2:M.sent();f=e.buffer.readInt32();if(f!==C.AUTH_SASL_CONTINUE)throw new O.ProtocolError("expected SASLContinue from the server, received ".concat(f));d=e.buffer.readString();e.buffer.finishMessage();h=I(_.parseServerFirstMessage(d),3),v=h[0],p=h[1],y=h[2];return[4,_.buildClientFinalMessage(e.config.connectionParams.password||"",p,y,c,d,v)];case 3:g=I.apply(void 0,[M.sent(),2]),m=g[0],E=g[1];l.reset().beginMessage(w.$r).writeString(m).endMessage(),e.sock.write(l.unwrap());return[4,e._ensureMessage(w.$R,"SASLFinal")];case 4:if(M.sent(),f=e.buffer.readInt32(),f!==C.AUTH_SASL_FINAL)throw new O.ProtocolError("expected SASLFinal from the server, received ".concat(f));S=e.buffer.readString();e.buffer.finishMessage();k=_.parseServerFinalMessage(S);if(!_.bufferEquals(k,E))throw new O.ProtocolError("server SCRAM proof does not match");return[2]}})})()}},{key:"_ensureMessage",value:function e(e,t){var r=this;return a(function(){var n,i;return B(this,function(a){switch(a.label){case 0:n=r.buffer.takeMessage();if(n)return[3,2];return[4,r._waitForMessage()];case 1:n=a.sent();a.label=2;case 2:n;i=r.buffer.getMessageType();switch(i){case w.$E:throw r._parseErrorMessage();case e:return[2];default:throw new O.UnexpectedMessageError("expected ".concat(t," from the server, received ").concat(w.chr(i)))}return[2]}})})()}}],[{key:"newSock",value:function e(e,t){if(typeof e=="string")return l.net.createConnection(e);var r=I(e,2),n=r[0],i=r[1];if(t==null)return l.net.createConnection(i,n);var a=E(m({},t),{host:n,port:i});return l.tls.connect(a)}},{key:"connectWithTimeout",value:function e(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;var o=this;return a(function(){var a,u,s,c,l,f,d;return B(this,function(h){switch(h.label){case 0:a=o.newSock(e,i?t(r.connectionParams):void 0),u=new o(a,r,n),s=u.connect(),c=null,l=!1;r.connectTimeout&&(c=setTimeout(function(){u.connected||(l=!0,u.sock.destroy(new O.ClientConnectionTimeoutError("connection timed out (".concat(r.connectTimeout,"ms)"))))},r.connectTimeout));h.label=1;case 1:h.trys.push([1,3,4,5]);return[4,s];case 2:h.sent();return[3,5];case 3:f=h.sent();if(u._abort(),l&&v(f,O.ClientConnectionClosedError))throw new O.ClientConnectionTimeoutError("connection timed out (".concat(r.connectTimeout,"ms)"));if(v(f,O.EdgeDBError))throw f;{;switch(f.code){case"EPROTO":if(i===!0)try{return[2,o.connectWithTimeout(e,r,n,!1)]}catch(e){}d=new O.ClientConnectionFailedError("".concat(f.message,"\nAttempted to connect using the following credentials:\n").concat(r.connectionParams.explainConfig(),"\n"));break;case"ECONNREFUSED":case"ECONNABORTED":case"ECONNRESET":case"ENOTFOUND":case"ENOENT":d=new O.ClientConnectionFailedTemporarilyError("".concat(f.message,"\nAttempted to connect using the following credentials:\n").concat(r.connectionParams.explainConfig(),"\n"));break;default:d=new O.ClientConnectionFailedError("".concat(f.message,"\nAttempted to connect using the following credentials:\n").concat(r.connectionParams.explainConfig(),"\n"));break}throw d.source=f,d}return[3,5];case 4:c!=null&&clearTimeout(c);return[7];case 5:return[2,u]}})})()}}]);return i}(p.BaseRawConnection);e.RawConnection=M});var ez=$(function(e){"use strict";var t=function e(e){return new i.Client(new l(u.parseConnectArguments,typeof e=="string"?{dsn:e}:e!==null&&e!==void 0?e:{}),s.Options.defaults())};var r=function e(e){return new i.Client(new a.FetchClientPool(u.parseConnectArguments,typeof e=="string"?{dsn:e}:e!==null&&e!==void 0?e:{}),s.Options.defaults())};Object.defineProperty(e,"__esModule",{value:!0});e.createHttpClient=e.createClient=void 0;var i=eN(),a=eY(),u=eJ(),s=eP(),c=eG(),l=function(e){h(r,e);var t=U(r);function r(){o(this,r);var e;e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),Object.defineProperty(n(e),"isStateless",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(n(e),"_connectWithTimeout",{enumerable:!0,configurable:!0,writable:!0,value:c.RawConnection.connectWithTimeout.bind(c.RawConnection)});return S(e)}return r}(i.BaseClientPool);e.createClient=t;e.createHttpClient=r});var eQ=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__exportStar||function(e,r){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)},i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0});e._plugJSBI=e._ReadBuffer=e._CodecsRegistry=e.Range=e.ConfigMemory=e.DateDuration=e.RelativeDuration=e.Duration=e.LocalTime=e.LocalDate=e.LocalDateTime=void 0;var a=ed();Object.defineProperty(e,"LocalDateTime",{enumerable:!0,get:function e(){return a.LocalDateTime}});Object.defineProperty(e,"LocalDate",{enumerable:!0,get:function e(){return a.LocalDate}});Object.defineProperty(e,"LocalTime",{enumerable:!0,get:function e(){return a.LocalTime}});Object.defineProperty(e,"Duration",{enumerable:!0,get:function e(){return a.Duration}});Object.defineProperty(e,"RelativeDuration",{enumerable:!0,get:function e(){return a.RelativeDuration}});Object.defineProperty(e,"DateDuration",{enumerable:!0,get:function e(){return a.DateDuration}});var o=ev();Object.defineProperty(e,"ConfigMemory",{enumerable:!0,get:function e(){return o.ConfigMemory}});var u=ew();Object.defineProperty(e,"Range",{enumerable:!0,get:function e(){return u.Range}});n(ee(),e);var s=i(eM()),c=i(Q());e._CodecsRegistry=s.CodecsRegistry;e._ReadBuffer=c.ReadBuffer;var l=J();e._plugJSBI=l.plugJSBI});var eX=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.OperatorKind=e.SelectModifierKind=e.ExpressionKind=e.TypeKind=e.Cardinality=void 0;var t;(function(e){e.AtMostOne="AtMostOne",e.One="One",e.Many="Many",e.AtLeastOne="AtLeastOne",e.Empty="Empty"})(t=e.Cardinality||(e.Cardinality={}));var r;(function(e){e.scalar="scalar",e.enum="enum",e.object="object",e.namedtuple="namedtuple",e.tuple="tuple",e.array="array",e.range="range"})(r=e.TypeKind||(e.TypeKind={}));var n;(function(e){e.Set="Set",e.Array="Array",e.Tuple="Tuple",e.NamedTuple="NamedTuple",e.TuplePath="TuplePath",e.PathNode="PathNode",e.PathLeaf="PathLeaf",e.Literal="Literal",e.Cast="Cast",e.Select="Select",e.Update="Update",e.Delete="Delete",e.Insert="Insert",e.InsertUnlessConflict="InsertUnlessConflict",e.Function="Function",e.Operator="Operator",e.For="For",e.ForVar="ForVar",e.TypeIntersection="TypeIntersection",e.Alias="Alias",e.With="With",e.WithParams="WithParams",e.Param="Param",e.OptionalParam="OptionalParam",e.Detached="Detached",e.Global="Global",e.PolyShapeElement="PolyShapeElement",e.Group="Group"})(n=e.ExpressionKind||(e.ExpressionKind={}));var i;(function(e){e.filter="filter",e.order_by="order_by",e.offset="offset",e.limit="limit"})(i=e.SelectModifierKind||(e.SelectModifierKind={}));var a;(function(e){e.Infix="Infix",e.Postfix="Postfix",e.Prefix="Prefix",e.Ternary="Ternary"})(a=e.OperatorKind||(e.OperatorKind={}))});var eZ=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.util=void 0;var t;(function(e){var t=function e(e,t){throw t!==null&&t!==void 0?t:new Error("".concat(e,' is supposed to be of "never" type'))};var r=function e(e){if(!e.includes("::"))throw new Error("Invalid FQN ".concat(e));var t=e.split("::");return{mod:t.slice(0,-1).join("::"),name:t[t.length-1]}};var n=function e(e){if(e.includes("::"))throw new Error("toIdent: invalid name ".concat(e));return e.replace(/([^a-zA-Z0-9_]+)/g,"_")};var i=function e(e,t){var r;return(r=Array.prototype).concat.apply(r,T(e.map(t)))};var a=function e(e){var t={};var r=true,n=false,i=undefined;try{for(var a=Object.keys(e)[Symbol.iterator](),o;!(r=(o=a.next()).done);r=true){var u=o.value;u.startsWith("$")||(t[u]=e[u])}}catch(e){n=true;i=e}finally{try{if(!r&&a.return!=null){a.return()}}finally{if(n){throw i}}}return t};e.assertNever=t;e.splitName=r;e.toIdent=n,e.deduplicate=function(e){return T(new Set(e))},e.getFromArrayMap=function(e,t){return e[t]||[]},e.defineProperty=function(e,t,r){return Object.defineProperty(e,t,r)},e.defineGetter=function(e,t,r){return Object.defineProperty(e,t,{get:r,enumerable:!0})},e.defineMethod=function(e,t,r){return e[t]=r.bind(e),e};e.flatMap=i;e.omitDollarPrefixed=a})(t=e.util||(e.util={}))});var e0=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})});var e1=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.StrictMap=void 0;var t=function(e){h(r,e);var t=U(r);function r(){o(this,r);return t.apply(this,arguments)}c(r,[{key:"get",value:function e(e){if(!this.has(e))throw new Error('key "'.concat(e,'" is not found'));return f(d(r.prototype),"get",this).call(this,e)}}]);return r}(j(Map));e.StrictMap=t});var e2=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.reservedKeywords=void 0;e.reservedKeywords=new Set(["__edgedbsys__","__edgedbtpl__","__source__","__std__","__subject__","__type__","abort","alter","analyze","and","anyarray","anytuple","anytype","begin","case","check","commit","configure","create","deallocate","declare","delete","describe","detached","discard","distinct","do","drop","else","empty","end","execute","exists","explain","extending","fetch","filter","for","get","global","grant","group","if","ilike","import","in","insert","introspect","is","like","limit","listen","load","lock","match","module","move","not","notify","offset","optional","or","order","over","partition","policy","populate","prepare","raise","refresh","reindex","release","reset","revoke","rollback","select","set","single","start","typeof","union","update","variadic","when","window","with"])});var e4=$(function(e){"use strict";var t=function e(e){var t=new r.StrictMap,n=new r.StrictMap;var i=true,a=false,o=undefined;try{for(var u=e[Symbol.iterator](),s;!(i=(s=u.next()).done);i=true){var c=s.value;t.set(c.id,c)}}catch(e){a=true;o=e}finally{try{if(!i&&u.return!=null){u.return()}}finally{if(a){throw o}}}var l=true,f=false,d=undefined,h=true,v=false,p=undefined;try{for(var y=e[Symbol.iterator](),b;!(h=(b=y.next()).done);h=true){var g=b.value;if(!(g.kind!=="object"&&g.kind!=="scalar"))try{for(var w=g.bases[Symbol.iterator](),m;!(l=(m=w.next()).done);l=true){var _=m.value,E=_.id;if(!t.has(E))throw new Error("reference to an unknown object type: ".concat(E));n.has(g.id)||n.set(g.id,new Set),n.get(g.id).add(E)}}catch(e){f=true;d=e}finally{try{if(!l&&w.return!=null){w.return()}}finally{if(f){throw d}}}}}catch(e){v=true;p=e}finally{try{if(!h&&y.return!=null){y.return()}}finally{if(v){throw p}}}var O=new Set,C=new Set,S=new r.StrictMap,k=function(e){if(O.has(e.name)){var r=Array.from(O).slice(1,2);throw new Error("dependency cycle between ".concat(e.name," and ").concat(r))}if(!C.has(e.id)){var i=true,a=false,o=undefined;if(O.add(e.name),n.has(e.id))try{for(var u=n.get(e.id).values()[Symbol.iterator](),s;!(i=(s=u.next()).done);i=true){var c=s.value;k(t.get(c))}}catch(e){a=true;o=e}finally{try{if(!i&&u.return!=null){u.return()}}finally{if(a){throw o}}}S.set(e.id,e),C.add(e.id),O.delete(e.name)}};var I=true,M=false,P=undefined;try{for(var T=e[Symbol.iterator](),D;!(I=(D=T.next()).done);I=true){var A=D.value;k(A)}}catch(e){M=true;P=e}finally{try{if(!I&&T.return!=null){T.return()}}finally{if(M){throw P}}}return S};Object.defineProperty(e,"__esModule",{value:!0});e.types=e.topoSort=e.getTypes=e.typeMapping=void 0;var r=e1(),n={id:"00000000-0000-0000-0000-0000000001ff",name:"std::number",is_abstract:!1,is_seq:!1,kind:"scalar",enum_values:null,material_id:null,bases:[]};e.typeMapping=new Map([["00000000-0000-0000-0000-000000000103",n],["00000000-0000-0000-0000-000000000104",n],["00000000-0000-0000-0000-000000000105",n],["00000000-0000-0000-0000-000000000106",n],["00000000-0000-0000-0000-000000000107",n]]);function i(e,t){return o.apply(this,arguments)}function o(){o=a(function(r,i){var a,o,u,s,c,f,d,h,v,p,y,b,g,w,m,_,E,O,C,S,k,M,T,D;return B(this,function(A){switch(A.label){case 0:d=((a=i)===null||a===void 0?void 0:a.debug)===!0;return[4,r.queryRequiredSingle("select sys::get_version().major;")];case 1:h=A.sent()>=2,v="\n    WITH\n      MODULE schema,\n\n      material_scalars := (\n        SELECT ScalarType\n        FILTER NOT .abstract\n           AND NOT EXISTS .enum_values\n           AND NOT EXISTS (SELECT .ancestors FILTER NOT .abstract)\n      )\n\n    SELECT Type {\n      id,\n      name :=\n        array_join(array_agg([IS ObjectType].union_of.name), ' | ')\n        IF EXISTS [IS ObjectType].union_of\n        ELSE .name,\n      is_abstract := .abstract,\n\n      kind := 'object' IF Type IS ObjectType ELSE\n              'scalar' IF Type IS ScalarType ELSE\n              'array' IF Type IS Array ELSE\n              'tuple' IF Type IS Tuple ELSE\n              ".concat(h?"'range' IF Type IS Range ELSE":"","\n              'unknown',\n\n      [IS ScalarType].enum_values,\n      is_seq := 'std::sequence' in [IS ScalarType].ancestors.name,\n      # for sequence (abstract type that has non-abstract ancestor)\n      single material_id := (\n        SELECT x := Type[IS ScalarType].ancestors\n        FILTER x IN material_scalars\n        LIMIT 1\n      ).id,\n\n      [IS InheritingObject].bases: {\n        id\n      } ORDER BY @index ASC,\n\n      [IS ObjectType].union_of,\n      [IS ObjectType].intersection_of,\n      [IS ObjectType].pointers: {\n        card := (\"One\" IF .required ELSE \"AtMostOne\") IF <str>.cardinality = \"One\" ELSE (\"AtLeastOne\" IF .required ELSE \"Many\"),\n        name,\n        target_id := .target.id,\n        kind := 'link' IF .__type__.name = 'schema::Link' ELSE 'property',\n        is_exclusive := exists (select .constraints filter .name = 'std::exclusive'),\n        is_computed := len(.computed_fields) != 0,\n        is_readonly := .readonly,\n        has_default := EXISTS .default or (\"std::sequence\" in .target[IS ScalarType].ancestors.name),\n        [IS Link].pointers: {\n          card := (\"One\" IF .required ELSE \"AtMostOne\") IF <str>.cardinality = \"One\" ELSE (\"AtLeastOne\" IF .required ELSE \"Many\"),\n          name := '@' ++ .name,\n          target_id := .target.id,\n          kind := 'link' IF .__type__.name = 'schema::Link' ELSE 'property',\n          is_computed := len(.computed_fields) != 0,\n          is_readonly := .readonly\n        } filter .name != '@source' and .name != '@target',\n      } FILTER @is_owned,\n      exclusives := assert_distinct((\n        [is schema::ObjectType].constraints\n        union\n        [is schema::ObjectType].pointers.constraints\n      ) {\n        target := (.subject[is schema::Property].name ?? .subject[is schema::Link].name ?? .subjectexpr)\n      } filter .name = 'std::exclusive'),\n      backlinks := (\n         SELECT DETACHED Link\n         FILTER .target = Type\n           AND NOT EXISTS .source[IS ObjectType].union_of\n        ) {\n        card := \"AtMostOne\"\n          IF\n          EXISTS (select .constraints filter .name = 'std::exclusive')\n          ELSE\n          \"Many\",\n        name := '<' ++ .name ++ '[is ' ++ assert_exists(.source.name) ++ ']',\n        stub := .name,\n        target_id := .source.id,\n        kind := 'link',\n        is_exclusive := (EXISTS (select .constraints filter .name = 'std::exclusive')) AND <str>.cardinality = \"One\",\n      },\n      backlink_stubs := array_agg((\n        WITH\n          stubs := DISTINCT (SELECT DETACHED Link FILTER .target = Type).name,\n          baseObjectId := (SELECT DETACHED ObjectType FILTER .name = 'std::BaseObject' LIMIT 1).id\n        FOR stub in { stubs }\n        UNION (\n          SELECT {\n            card := \"Many\",\n            name := '<' ++ stub,\n            target_id := baseObjectId,\n            kind := 'link',\n            is_exclusive := false,\n          }\n        )\n      )),\n      array_element_id := [IS Array].element_type.id,\n\n      tuple_elements := (SELECT [IS Tuple].element_types {\n        target_id := .type.id,\n        name\n      } ORDER BY @index ASC),\n      ").concat(h?"range_element_id := [IS Range].element_type.id,":"","\n    }\n    ORDER BY .name;\n  ");y=JSON.parse;return[4,r.queryJSON(v)];case 2:p=y.apply(JSON,[A.sent()]);d&&console.log(JSON.stringify(p,null,2));b=true,g=false,w=undefined;try{m=function(){var t=E.value;var r=true,i=false,a=undefined;if(Array.isArray(t.backlinks))try{for(var d=t.backlinks[Symbol.iterator](),h;!(r=(h=d.next()).done);r=true){var v=h.value;var p=v.name.match(/\[is (.+)\]/)[1];p.split("::").length===2&&p.startsWith("default::")&&(v.name=v.name.replace(/\[is (.+)\]/,"[is ".concat(p.slice(9),"]")))}}catch(e){i=true;a=e}finally{try{if(!r&&d.return!=null){d.return()}}finally{if(i){throw a}}}switch(t.kind){case"scalar":e.typeMapping.has(t.id)&&(t.cast_type=e.typeMapping.get(t.id).id),t.is_seq&&(t.cast_type=n.id),t.name!=="std::sequence"&&((o=t.bases[0])===null||o===void 0?void 0:o.id)===t.material_id&&(t.cast_type=(s=(u=e.typeMapping.get(t.material_id))===null||u===void 0?void 0:u.id)!==null&&s!==void 0?s:t.material_id);break;case"range":t.range_element_id=(f=(c=e.typeMapping.get(t.range_element_id))===null||c===void 0?void 0:c.id)!==null&&f!==void 0?f:t.range_element_id;break;case"object":var y={};var b=true,g=false,w=undefined;try{for(var m=t.pointers[Symbol.iterator](),_;!(b=(_=m.next()).done);b=true){var O=_.value;y[O.name]=O}}catch(e){g=true;w=e}finally{try{if(!b&&m.return!=null){m.return()}}finally{if(g){throw w}}}var C=t.exclusives,S=[];var k=true,I=false,M=undefined;try{var P=function(){var e=D.value;var t=e.target;if(t in y&&S.push(l({},e.target,y[e.target])),t[0]==="("&&t[t.length-1]===")"){var r=t.slice(1,-1).split(" ").map(function(e){return e=e.trim(),e[0]==="."&&(e=e.slice(1)),e[e.length-1]===","&&(e=e.slice(0,-1)),e}),n={};if(!r.every(function(e){return e in y}))return"continue";var i=true,a=false,o=undefined;try{for(var u=r[Symbol.iterator](),s;!(i=(s=u.next()).done);i=true){var c=s.value;n[c]=y[c]}}catch(e){a=true;o=e}finally{try{if(!i&&u.return!=null){u.return()}}finally{if(a){throw o}}}S.push(n)}};for(var T=C[Symbol.iterator](),D;!(k=(D=T.next()).done);k=true)P()}catch(e){I=true;M=e}finally{try{if(!k&&T.return!=null){T.return()}}finally{if(I){throw M}}}t.exclusives=S;break}};for(_=p[Symbol.iterator]();!(b=(E=_.next()).done);b=true)m()}catch(e){g=true;w=e}finally{try{if(!b&&_.return!=null){_.return()}}finally{if(g){throw w}}}p.push(n);O=t(p);C=true,S=false,k=undefined;try{M=function(){var e=I(D.value,2),t=e[0],r=e[1];if(r.kind==="object"&&r.union_of.length){var n=r.union_of.map(function(e){var t=e.id;var n=O.get(t);if(n.kind!=="object")throw new Error("type '".concat(n.name,"' of union '").concat(r.name,"' is not an object type"));return n}),i=P(n),a=i[0],o=i.slice(1),u=o.map(function(e){return new Set(e.pointers.map(function(e){return e.name}))});var s=true,c=false,l=undefined;try{var f=function(){var e=h.value;u.every(function(t){return t.has(e.name)})&&r.pointers.push(e)};for(var d=a.pointers[Symbol.iterator](),h;!(s=(h=d.next()).done);s=true)f()}catch(e){c=true;l=e}finally{try{if(!s&&d.return!=null){d.return()}}finally{if(c){throw l}}}r.backlinks=[],r.backlink_stubs=[]}};for(T=O[Symbol.iterator]();!(C=(D=T.next()).done);C=true)M()}catch(e){S=true;k=e}finally{try{if(!C&&T.return!=null){T.return()}}finally{if(S){throw k}}}return[2,O]}})});return o.apply(this,arguments)}e.getTypes=i;e.types=i;e.topoSort=t});var e3=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.casts=void 0;var t=e4(),r=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;var i=new Set;return n.has(e)?[]:(n.add(e),(t[e]||[]).map(function(e){i.add(e);var a=true,o=false,u=undefined;try{for(var s=r(e,t,n)[Symbol.iterator](),c;!(a=(c=s.next()).done);a=true){var l=c.value;i.add(l)}}catch(e){o=true;u=e}finally{try{if(!a&&s.return!=null){s.return()}}finally{if(o){throw u}}}}),T(i))},n=function(){var e=a(function(e,n){var i,a,o,u,s,c,l,f,d,h,v,p,y,b,g,w,m,_,E,O,C,S,k,M,P,D,A,j,N,U,L,R,F,x,q,H,W,$,Y,K,V,J,G,z,Q,X,Z,ee,et,er,en,ei,ea,eo,eu,es,ec,el,ef,ed,eh,ev,ep,ey,eb,eg,ew,em,e_,eE,eO,eC,eS,ek,eI,eM;return B(this,function(B){switch(B.label){case 0:return[4,e.queryJSON("WITH MODULE schema\n        SELECT Cast {\n            id,\n            source := .from_type { id, name },\n            target := .to_type { id, name },\n            allow_assignment,\n            allow_implicit,\n        }\n        FILTER .from_type IS ScalarType\n        AND .to_type IS ScalarType\n        # AND .from_type.is_abstract = false\n        # AND .to_type.is_abstract = false\n        ")];case 1:h=B.sent(),v=JSON.parse(h),p=new Set,y={},b={},g={},w={},m={},_={},E={};O=true,C=false,S=undefined;try{for(k=v[Symbol.iterator]();!(O=(M=k.next()).done);O=true){P=M.value;(t.typeMapping.has(P.source.id)||t.typeMapping.has(P.target.id))&&(P.allow_implicit=!1,P.allow_assignment=!1),y[P.source.id]=P.source,y[P.target.id]=P.target,p.add(P.source.id),p.add(P.target.id),b[P.id]=P,g[P.source.id]=g[P.source.id]||[],g[P.source.id].push(P.target.id),(P.allow_assignment||P.allow_implicit)&&((a=_[c=P.source.id])!==null&&a!==void 0||(_[c]=[]),_[P.source.id].push(P.target.id),(o=E[l=P.target.id])!==null&&o!==void 0||(E[l]=[]),E[P.target.id].push(P.source.id)),P.allow_implicit&&((u=w[f=P.source.id])!==null&&u!==void 0||(w[f]=[]),w[P.source.id].push(P.target.id),(s=m[d=P.target.id])!==null&&s!==void 0||(m[d]=[]),m[P.target.id].push(P.source.id))}}catch(e){C=true;S=e}finally{try{if(!O&&k.return!=null){k.return()}}finally{if(C){throw S}}}D={},A={},j={},N={},U={};L=true,R=false,F=undefined;try{for(x=T(p)[Symbol.iterator]();!(L=(q=x.next()).done);L=true){H=q.value;D[H]=g[H]||[],A[H]=r(H,w),j[H]=r(H,m),N[H]=r(H,_),U[H]=r(H,E)}}catch(e){R=true;F=e}finally{try{if(!L&&x.return!=null){x.return()}}finally{if(R){throw F}}}if(((i=n)===null||i===void 0?void 0:i.debug)===!0){console.log("\nIMPLICIT");W=true,$=false,Y=undefined;try{for(K=Object.entries(A)[Symbol.iterator]();!(W=(V=K.next()).done);W=true){J=I(V.value,2),G=J[0],z=J[1];console.log("".concat(y[G].name," implicitly castable to: [").concat(z.map(function(e){return y[e].name}).join(", "),"]"))}}catch(e){$=true;Y=e}finally{try{if(!W&&K.return!=null){K.return()}}finally{if($){throw Y}}}console.log("");Q=true,X=false,Z=undefined;try{for(ee=Object.entries(j)[Symbol.iterator]();!(Q=(et=ee.next()).done);Q=true){er=I(et.value,2),en=er[0],ei=er[1];console.log("".concat(y[en].name," implicitly castable from: [").concat(ei.map(function(e){return y[e].name}).join(", "),"]"))}}catch(e){X=true;Z=e}finally{try{if(!Q&&ee.return!=null){ee.return()}}finally{if(X){throw Z}}}console.log("\nASSIGNABLE TO");ea=true,eo=false,eu=undefined;try{for(es=Object.entries(N)[Symbol.iterator]();!(ea=(ec=es.next()).done);ea=true){el=I(ec.value,2),ef=el[0],ed=el[1];console.log("".concat(y[ef].name," assignable to: [").concat(ed.map(function(e){return y[e].name}).join(", "),"]"))}}catch(e){eo=true;eu=e}finally{try{if(!ea&&es.return!=null){es.return()}}finally{if(eo){throw eu}}}console.log("\nASSIGNABLE BY");eh=true,ev=false,ep=undefined;try{for(ey=Object.entries(U)[Symbol.iterator]();!(eh=(eb=ey.next()).done);eh=true){eg=I(eb.value,2),ew=eg[0],em=eg[1];console.log("".concat(y[ew].name," assignable by: [").concat(em.map(function(e){return y[e].name}).join(", "),"]"))}}catch(e){ev=true;ep=e}finally{try{if(!eh&&ey.return!=null){ey.return()}}finally{if(ev){throw ep}}}console.log("\nEXPLICIT");e_=true,eE=false,eO=undefined;try{for(eC=Object.entries(D)[Symbol.iterator]();!(e_=(eS=eC.next()).done);e_=true){ek=I(eS.value,2),eI=ek[0],eM=ek[1];console.log("".concat(y[eI].name," castable to: [").concat(eM.map(function(e){return y[e].name}).join(", "),"]"))}}catch(e){eE=true;eO=e}finally{try{if(!e_&&eC.return!=null){eC.return()}}finally{if(eE){throw eO}}}}return[2,{castsById:b,typesById:y,castMap:D,implicitCastMap:A,implicitCastFromMap:j,assignmentCastMap:N,assignableByMap:U}]}})});return function t(t,r){return e.apply(this,arguments)}}();e.casts=n});var e6=$(function(e){"use strict";var t=function e(e){if(i.typeMapping.has(e.return_type.id)){var t=i.typeMapping.get(e.return_type.id);e.return_type={id:t.id,name:t.name}}var r=true,n=false,a=undefined;try{for(var o=e.params[Symbol.iterator](),u;!(r=(u=o.next()).done);r=true){var s=u.value;if(i.typeMapping.has(s.type.id)){var c=i.typeMapping.get(s.type.id);s.type={id:c.id,name:c.name}}}}catch(e){n=true;a=e}finally{try{if(!r&&o.return!=null){o.return()}}finally{if(n){throw a}}}};var r=function e(e){return JSON.stringify({name:e.name,return_type:e.return_type.id,return_typemod:e.return_typemod,params:e.params.map(function(e){return JSON.stringify({kind:e.kind,type:e.type.id,typemod:e.typemod,hasDefault:!!e.hasDefault})}).sort(),preserves_optionality:e.preserves_optionality})};Object.defineProperty(e,"__esModule",{value:!0});e.replaceNumberTypes=e.functions=void 0;var n=e1(),i=e4(),o=function(){var e=a(function(e){var i,a,o,u,s,c,l,f,d,h,v,p,y;return B(this,function(b){switch(b.label){case 0:return[4,e.queryJSON("\n    with module schema\n    select Function {\n      id,\n      name,\n      annotations: {\n        name,\n        @value\n      } filter .name = 'std::description',\n      return_type: {id, name},\n      return_typemod,\n      params: {\n        name,\n        type: {id, name},\n        kind,\n        typemod,\n        hasDefault := exists .default,\n      } order by @index,\n      preserves_optionality,\n    } filter .internal = false\n  ")];case 1:a=b.sent(),o=new n.StrictMap,u=new Set;s=true,c=false,l=undefined;try{for(f=JSON.parse(a)[Symbol.iterator]();!(s=(d=f.next()).done);s=true){h=d.value;v=h.name;o.has(v)||o.set(v,[]);p=E(m({},h),{description:(i=h.annotations[0])===null||i===void 0?void 0:i["@value"]});t(p);y=r(p);u.has(y)||(o.get(v).push(p),u.add(y))}}catch(e){c=true;l=e}finally{try{if(!s&&f.return!=null){f.return()}}finally{if(c){throw l}}}return[2,o]}})});return function t(t){return e.apply(this,arguments)}}();e.functions=o;e.replaceNumberTypes=t});var e5=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.globals=void 0;function t(e){return r.apply(this,arguments)}function r(){r=a(function(e){var t,r,n,i,a,o,u,s,c,l;return B(this,function(f){switch(f.label){case 0:t=new Map;return[4,e.queryRequiredSingle("select sys::get_version().major;")];case 1:if(f.sent()===1)return[2,t];r='\n    WITH\n      MODULE schema\n    SELECT schema::Global {\n      id,\n      name,\n      target_id := .target.id,\n      card := ("One" IF .required ELSE "One" IF EXISTS .default ELSE "AtMostOne")\n        IF <str>.cardinality = "One" ELSE\n        ("AtLeastOne" IF .required ELSE "Many"),\n      has_default := exists .default,\n    }\n    ORDER BY .name;\n  ';i=JSON.parse;return[4,e.queryJSON(r)];case 2:n=i.apply(JSON,[f.sent()]);a=true,o=false,u=undefined;try{for(s=n[Symbol.iterator]();!(a=(c=s.next()).done);a=true){l=c.value;t.set(l.id,l)}}catch(e){o=true;u=e}finally{try{if(!a&&s.return!=null){s.return()}}finally{if(o){throw u}}}return[2,t]}})});return r.apply(this,arguments)}e.globals=t});var e8=$(function(e){"use strict";var t=function e(e){return JSON.stringify({name:e.name,return_type:e.return_type.id,return_typemod:e.return_typemod,params:e.params.map(function(e){return JSON.stringify({kind:e.kind,type:e.type.id,typemod:e.typemod,hasDefault:!!e.hasDefault})}).sort(),operator_kind:e.operator_kind})};Object.defineProperty(e,"__esModule",{value:!0});e.operators=void 0;var r=e1(),n=e6(),i=eZ(),o=function(){var e=a(function(e){var a,o,u,s,c,l,f,d,h,v,p,y,b,g,w,_,O;return B(this,function(C){switch(C.label){case 0:return[4,e.queryJSON("\n    with module schema\n    select Operator {\n      id,\n      name,\n      annotations: {\n        name,\n        @value\n      } filter .name in {'std::identifier', 'std::description'},\n      operator_kind,\n      return_type: {id, name},\n      return_typemod,\n      params: {\n        name,\n        type: {id, name},\n        kind,\n        typemod,\n      } order by @index,\n    } filter not .internal and not .abstract\n  ")];case 1:u=C.sent(),s=new r.StrictMap,c=new Set;l=true,f=false,d=undefined;try{for(h=JSON.parse(u)[Symbol.iterator]();!(l=(v=h.next()).done);l=true){p=v.value;y=(a=p.annotations.find(function(e){return e.name==="std::identifier"}))===null||a===void 0?void 0:a["@value"];if(!y)continue;b=i.util.splitName(p.name),g=b.mod,w="".concat(g,"::").concat(y);s.has(w)||s.set(w,[]);_=E(m({},p),{name:w,kind:p.operator_kind,originalName:p.name,description:(o=p.annotations.find(function(e){return e.name==="std::description"}))===null||o===void 0?void 0:o["@value"],annotations:void 0});(0,n.replaceNumberTypes)(_);O=t(_);c.has(O)||(s.get(w).push(_),c.add(O))}}catch(e){f=true;d=e}finally{try{if(!l&&h.return!=null){h.return()}}finally{if(f){throw d}}}return[2,s]}})});return function t(t){return e.apply(this,arguments)}}();e.operators=o});var e7=$(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.scalars=void 0;var t=e1(),r=function(){var e=a(function(e){var r,n,i,a,o,u,s,c;return B(this,function(l){switch(l.label){case 0:return[4,e.queryJSON("with module schema\nselect InheritingObject {\n  id,\n  name,\n  is_abstract,\n  bases: { id, name },\n  ancestors: { id, name },\n  children := .<bases[IS Type] { id, name },\n  descendants := .<ancestors[IS Type] { id, name }\n}\nFILTER\n  InheritingObject IS ScalarType OR\n  InheritingObject IS ObjectType;\n")];case 1:r=l.sent(),n=new t.StrictMap;i=true,a=false,o=undefined;try{for(u=JSON.parse(r)[Symbol.iterator]();!(i=(s=u.next()).done);i=true){c=s.value;n.set(c.id,c)}}catch(e){a=true;o=e}finally{try{if(!i&&u.return!=null){u.return()}}finally{if(a){throw o}}}return[2,n]}})});return function t(t){return e.apply(this,arguments)}}();e.scalars=r});var e9=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0});r(e3(),e);r(e6(),e);r(e5(),e);r(e8(),e);r(e7(),e);r(e4(),e)});var te=$(function(e){"use strict";var t=function e(e,t){switch(t){case h.Cardinality.MANY:return"".concat(e,"[]");case h.Cardinality.ONE:return e;case h.Cardinality.AT_MOST_ONE:return"".concat(e," | null");case h.Cardinality.AT_LEAST_ONE:return"[(".concat(e,"), ...(").concat(e,")[]]")}throw Error("unexpected cardinality: ".concat(t))};Object.defineProperty(e,"__esModule",{value:!0});e.analyzeQuery=void 0;var r=eE(),n=er(),i=eO(),o=en(),u=e_(),s=eC(),c=em(),l=eb(),f=eS(),d=eg(),h=z(),p=eP();function y(e,t){return b.apply(this,arguments)}function b(){b=a(function(e,r){var n,i,a,o,u,s,c;return B(this,function(l){switch(l.label){case 0:return[4,e.pool.acquireHolder(p.Options.defaults())];case 1:i=l.sent();l.label=2;case 2:l.trys.push([2,,5,7]);return[4,i._getConnection()];case 3:return[4,l.sent()._parse(r,h.OutputFormat.BINARY,h.Cardinality.MANY,p.Session.defaults())];case 4:n=l.sent();return[3,7];case 5:return[4,i.release()];case 6:l.sent();return[7];case 7:a=n[0],o=n[1],u=n[2],s=new Set,c=g(o,{indent:"",optionalNulls:!0,imports:s});return[2,{result:t(g(u,{indent:"",optionalNulls:!1,imports:s}),a),args:c,cardinality:a,query:r,imports:s}]}})});return b.apply(this,arguments)}e.analyzeQuery=y;function g(e,a){if(v(e,l.NullCodec))return"null";if(v(e,o.ScalarCodec))return v(e,i.EnumCodec)?"(".concat(e.values.map(function(e){return JSON.stringify(e)}).join(" | "),")"):(e.importedType&&a.imports.add(e.tsType),e.tsType);if(v(e,s.ObjectCodec)||v(e,u.NamedTupleCodec)){var h=v(e,s.ObjectCodec)?e.getFields():e.getNames().map(function(e){return{name:e,cardinality:n.ONE}}),p=e.getSubcodecs();return"{\n".concat(h.map(function(e,r){var i=p[r];if(v(i,f.SetCodec)){if(!(e.cardinality===n.MANY||e.cardinality===n.AT_LEAST_ONE))throw Error("subcodec is SetCodec, but upper cardinality is one");i=i.getSubcodecs()[0]}return"".concat(a.indent,"  ").concat(JSON.stringify(e.name)).concat(a.optionalNulls&&e.cardinality===n.AT_MOST_ONE?"?":"",": ").concat(t(g(i,E(m({},a),{indent:a.indent+"  "})),e.cardinality),";")}).join("\n"),"\n").concat(a.indent,"}")}if(v(e,r.ArrayCodec))return"".concat(g(e.getSubcodecs()[0],a),"[]");if(v(e,d.TupleCodec))return"[".concat(e.getSubcodecs().map(function(e){return g(e,a)}).join(", "),"]");if(v(e,c.RangeCodec)){var y=e.getSubcodecs()[0];if(!v(y,o.ScalarCodec))throw Error("expected range subtype to be scalar type");return a.imports.add("Range"),"Range<".concat(y.tsType,">")}throw Error("Unexpected codec kind: ".concat(e.getKind()))}});var tt=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__exportStar||function(e,r){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)},i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0});e.introspect=void 0;n(eX(),e);n(eZ(),e);n(e0(),e);n(eZ(),e);n(e1(),e);n(e2(),e);e.introspect=i(e9());n(te(),e)});var tr=$(function(e){"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function e(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n},i=e&&e.__exportStar||function(e,r){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0});e.$=e.defaultBackoff=e.Session=e.RetryOptions=e.RetryCondition=e.IsolationLevel=e._RawConnection=e.adapter=e.createHttpClient=e.createClient=void 0;var a=ez();e.default=a.createClient;var o=ez();Object.defineProperty(e,"createClient",{enumerable:!0,get:function e(){return o.createClient}});Object.defineProperty(e,"createHttpClient",{enumerable:!0,get:function e(){return o.createHttpClient}});var u=n(eK());e.adapter=u;var s=eG();Object.defineProperty(e,"_RawConnection",{enumerable:!0,get:function e(){return s.RawConnection}});var c=eP();Object.defineProperty(e,"IsolationLevel",{enumerable:!0,get:function e(){return c.IsolationLevel}});Object.defineProperty(e,"RetryCondition",{enumerable:!0,get:function e(){return c.RetryCondition}});Object.defineProperty(e,"RetryOptions",{enumerable:!0,get:function e(){return c.RetryOptions}});Object.defineProperty(e,"Session",{enumerable:!0,get:function e(){return c.Session}});var l=eP();Object.defineProperty(e,"defaultBackoff",{enumerable:!0,get:function e(){return l.defaultBackoff}});i(eQ(),e);e.$=n(tt())});var tn=K(tr(),1),ti=K(tr(),1),ta=function e(t){"use strict";o(this,e);this.config=t;var r=this;var n=this;this.create=function(){var e=a(function(e){return B(this,function(t){switch(t.label){case 0:return[4,n.client.transaction(function(){var t=a(function(t){var n,i;return B(this,function(a){switch(a.label){case 0:return[4,r.e.insert(r.eType,e).run(t)];case 1:n=a.sent(),i=n.id;return[4,r.e.select(r.eType,function(){return E(m({},r.eFields),{filter_single:{id:i}})}).run(t)];case 2:return[2,a.sent()]}})});return function(e){return t.apply(this,arguments)}}())];case 1:return[2,t.sent()]}})});return function(t){return e.apply(this,arguments)}}();var i=this;this.updateById=function(){var e=a(function(e,t){return B(this,function(r){switch(r.label){case 0:return[4,i.e.update(i.eType,function(){return{set:t,filter_single:{id:e}}}).run(i.client)];case 1:return[2,r.sent()]}})});return function(t,r){return e.apply(this,arguments)}}();var u=this;this.findAll=a(function(){return B(this,function(e){switch(e.label){case 0:return[4,u.e.select(u.eType,function(){return m({},u.eFields)}).run(u.client)];case 1:return[2,e.sent()]}})});var s=this;this.findById=function(){var e=a(function(e){return B(this,function(t){switch(t.label){case 0:return[4,s.e.select(s.eType,function(){return E(m({},s.eFields),{filter_single:{id:e}})}).run(s.client)];case 1:return[2,t.sent()]}})});return function(t){return e.apply(this,arguments)}}();var c=this;this.deleteById=function(){var e=a(function(e){return B(this,function(t){switch(t.label){case 0:return[4,c.e.delete(c.eType,function(){return{filter_single:{id:e}}}).run(c.client)];case 1:return[2,t.sent()]}})});return function(t){return e.apply(this,arguments)}}();var l=this;this.findByField=function(){var e=a(function(e,t){return B(this,function(r){switch(r.label){case 0:return[4,l.e.select(l.eType,function(r){return E(m({},l.eFields),{filter_single:l.e.op(r[e],"=",l.e.uuid(t))})}).run(l.client)];case 1:return[2,r.sent()]}})});return function(t,r){return e.apply(this,arguments)}}();var f=this;this.findAllByField=function(){var e=a(function(e,t){return B(this,function(r){switch(r.label){case 0:return[4,f.e.select(f.eType,function(r){return E(m({},f.eFields),{filter:f.e.op(r[e],"=",f.e.uuid(t))})}).run(f.client)];case 1:return[2,r.sent()]}})});return function(t,r){return e.apply(this,arguments)}}();var d=this;this.findByFields=function(){var e=a(function(e){return B(this,function(t){switch(t.label){case 0:return[4,d.e.select(d.eType,function(){return E(m({},d.eFields),{filter_single:e})}).run(d.client)];case 1:return[2,t.sent()]}})});return function(t){return e.apply(this,arguments)}}();t.client&&("options"in t.client||(this.client=(0,tn.default)(t.client)),this.client=this.client.withConfig({session_idle_transaction_timeout:tn.Duration.from({seconds:10}),allow_bare_ddl:"AlwaysAllow"}).withRetryOptions({attempts:3,backoff:function(e){return Math.pow(2,e)*100+Math.random()*100}})),this.e=this.config.edgedb,this.typeName=this.config.type,this.eType=this.e[this.typeName],this.eFields=this.eType["*"]};var to=ti.createClient;export{ta as CRUDService,to as createClient};//# sourceMappingURL=index.js.map