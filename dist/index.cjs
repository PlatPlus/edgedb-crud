var Vc=Object.create;var Br=Object.defineProperty;var Jc=Object.getOwnPropertyDescriptor;var Kc=Object.getOwnPropertyNames;var Qc=Object.getPrototypeOf,Xc=Object.prototype.hasOwnProperty;var w=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),zc=(r,e)=>{for(var t in e)Br(r,t,{get:e[t],enumerable:!0})},ko=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Kc(e))!Xc.call(r,i)&&i!==t&&Br(r,i,{get:()=>e[i],enumerable:!(n=Jc(e,i))||n.enumerable});return r};var Ho=(r,e,t)=>(t=r!=null?Vc(Qc(r)):{},ko(e||!r||!r.__esModule?Br(t,"default",{value:r,enumerable:!0}):t,r)),Zc=r=>ko(Br({},"__esModule",{value:!0}),r);var Pt=w(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.chr=v.ord=v.$v=v.$s=v.$r=v.$p=v.$o=v.$n=v.$m=v.$j=v.$b=v.$Z=v.$Y=v.$X=v.$V=v.$T=v.$S=v.$R=v.$Q=v.$P=v.$O=v.$M=v.$L=v.$K=v.$I=v.$H=v.$E=v.$D=v.$C=v.$A=v.$1=v.$0=void 0;v.$0=L("0");v.$1=L("1");v.$A=L("A");v.$C=L("C");v.$D=L("D");v.$E=L("E");v.$H=L("H");v.$I=L("I");v.$K=L("K");v.$L=L("L");v.$M=L("M");v.$O=L("O");v.$P=L("P");v.$Q=L("Q");v.$R=L("R");v.$S=L("S");v.$T=L("T");v.$V=L("V");v.$X=L("X");v.$Y=L("Y");v.$Z=L("Z");v.$b=L("b");v.$j=L("j");v.$m=L("m");v.$n=L("n");v.$o=L("o");v.$p=L("p");v.$r=L("r");v.$s=L("s");v.$v=L("v");function L(r){let e=r.charCodeAt(0);if(e<=0||e>=255)throw new TypeError(`char "${e}" is outside ASCII`);return e&255}v.ord=L;function el(r){if(r<=0||r>=255)throw new TypeError(`char "${r}" is outside ASCII`);return String.fromCharCode(r)}v.chr=el});var gt=w(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.remainder=q.lt=q.gte=q.bitand=q.rshift=q.mul=q.div=q.sub=q.add=q.make=q.isBigInt=q.plugJSBI=q.hasNativeBigInt=void 0;var li=null;q.hasNativeBigInt=typeof BigInt<"u";function tl(r){li=r}q.plugJSBI=tl;var di,fi,hi,gi,pi,bi,_i,wi,yi,mi,vi;q.hasNativeBigInt?(di=r=>typeof r=="bigint",fi=r=>BigInt(r),hi=(r,e)=>r+e,pi=(r,e)=>r-e,gi=(r,e)=>r/e,bi=(r,e)=>r*e,_i=(r,e)=>r>>e,wi=(r,e)=>r&e,yi=(r,e)=>r>=e,mi=(r,e)=>r<e,vi=(r,e)=>r%e):(di=r=>{let e=Fe();return r instanceof e},fi=r=>Fe().BigInt(r),hi=(r,e)=>Fe().add(r,e),pi=(r,e)=>Fe().subtract(r,e),gi=(r,e)=>Fe().divide(r,e),bi=(r,e)=>Fe().multiply(r,e),_i=(r,e)=>Fe().signedRightShift(r,e),wi=(r,e)=>Fe().bitwiseAnd(r,e),yi=(r,e)=>Fe().greaterThanOrEqual(r,e),mi=(r,e)=>Fe().lessThan(r,e),vi=(r,e)=>Fe().remainder(r,e));function Fe(){if(li==null)throw new Error("JSBI library is required to polyfill BigInt");return li}q.isBigInt=di;q.make=fi;q.add=hi;q.sub=pi;q.div=gi;q.mul=bi;q.rshift=_i;q.bitand=wi;q.gte=yi;q.lt=mi;q.remainder=vi});var Wo=w(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.decodeInt64ToString=void 0;function rl(r){if(r.length!==8)throw new Error("expected 8 bytes buffer");let e=Array.from(r),t=!1;e[0]&128&&(e=e.map(i=>i^255),e[e.length-1]++,t=!0);let n="0";for(let i of e){let s=i,a="";for(let o=n.length-1;o>=0;o--){let u=parseInt(n[o],10)*256+s;a=u%10+a,s=Math.floor(u/10)}n=s?s+a:a}return t?`-${n}`:n}jr.decodeInt64ToString=rl});var Tt=w(le=>{"use strict";var nl=le&&le.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),il=le&&le.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),sl=le&&le.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&nl(e,r,t);return il(e,r),e};Object.defineProperty(le,"__esModule",{value:!0});le.LegacyHeaderCodes=le.Cardinality=le.OutputFormat=void 0;var it=sl(Pt()),al;(function(r){r[r.BINARY=it.$b]="BINARY",r[r.JSON=it.$j]="JSON",r[r.NONE=it.$n]="NONE"})(al=le.OutputFormat||(le.OutputFormat={}));var ol;(function(r){r[r.NO_RESULT=it.$n]="NO_RESULT",r[r.AT_MOST_ONE=it.$o]="AT_MOST_ONE",r[r.ONE=it.$A]="ONE",r[r.MANY=it.$m]="MANY",r[r.AT_LEAST_ONE=it.$M]="AT_LEAST_ONE"})(ol=le.Cardinality||(le.Cardinality={}));le.LegacyHeaderCodes={implicitLimit:65281,implicitTypenames:65282,implicitTypeids:65283,allowCapabilities:65284,capabilities:4097,explicitObjectids:65285}});var Y=w(A=>{"use strict";var ul=A&&A.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),cl=A&&A.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Si=A&&A.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&ul(e,r,t);return cl(e,r),e};Object.defineProperty(A,"__esModule",{value:!0});A.ReadBuffer=A.ReadMessageBuffer=A.uuidToBuffer=A.WriteMessageBuffer=A.WriteBuffer=A.BufferError=A.encodeB64=A.decodeB64=A.utf8Decoder=A.utf8Encoder=void 0;var Ii=Si(Pt()),ge=Si(gt()),ll=Si(Wo()),dl=Tt(),Yo=4096,Ur=new Uint8Array(0);A.utf8Encoder=new TextEncoder;A.utf8Decoder=new TextDecoder("utf8");var Ei;A.decodeB64=Ei;var Oi;A.encodeB64=Oi;typeof btoa>"u"?(A.decodeB64=Ei=r=>Buffer.from(r,"base64"),A.encodeB64=Oi=r=>Buffer.from(r).toString("base64")):(A.decodeB64=Ei=r=>{let e=atob(r),t=e.length,n=new Uint8Array(t);for(let i=0;i<t;i++)n[i]=e.charCodeAt(i);return n},A.encodeB64=Oi=r=>{let e=String.fromCharCode(...r);return btoa(e)});var fl=typeof DataView.prototype.getBigInt64>"u",I=class extends Error{};A.BufferError=I;var Lr=class{constructor(){Object.defineProperty(this,"_rawBuffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pos",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.size=Yo,this.pos=0,this._rawBuffer=new Uint8Array(this.size),this.buffer=new DataView(this._rawBuffer.buffer)}get position(){return this.pos}reset(){this.pos=0}ensureAlloced(e){let t=this.pos+e;t>this.size&&this.__realloc(t)}__realloc(e){e+=Yo;let t=new Uint8Array(e);t.set(this._rawBuffer),this._rawBuffer=t,this.buffer=new DataView(this._rawBuffer.buffer),this.size=e}writeChar(e){return this.ensureAlloced(1),this.buffer.setUint8(this.pos,e),this.pos++,this}writeString(e){return this.writeBytes(A.utf8Encoder.encode(e))}writeBytes(e){return this.ensureAlloced(e.length+4),this.buffer.setInt32(this.pos,e.length),this.pos+=4,this._rawBuffer.set(e,this.pos),this.pos+=e.length,this}writeInt16(e){return this.ensureAlloced(2),this.buffer.setInt16(this.pos,e),this.pos+=2,this}writeInt32(e){return this.ensureAlloced(4),this.buffer.setInt32(this.pos,e),this.pos+=4,this}writeFloat32(e){return this.ensureAlloced(4),this.buffer.setFloat32(this.pos,e),this.pos+=4,this}writeFloat64(e){return this.ensureAlloced(8),this.buffer.setFloat64(this.pos,e),this.pos+=8,this}writeUInt8(e){return this.ensureAlloced(1),this.buffer.setUint8(this.pos,e),this.pos+=1,this}writeUInt16(e){return this.ensureAlloced(2),this.buffer.setUint16(this.pos,e),this.pos+=2,this}writeUInt32(e){return this.ensureAlloced(4),this.buffer.setUint32(this.pos,e),this.pos+=4,this}writeInt64(e){this.ensureAlloced(8);let t=Math.floor(e/4294967296),n=e-t*4294967296;return this.buffer.setInt32(this.pos,t),this.buffer.setUint32(this.pos+4,n),this.pos+=8,this}writeBigInt64(e){let t=e;ge.lt(t,ge.make(0))&&(t=ge.add(ge.make("18446744073709551616"),e));let n=ge.rshift(t,ge.make(32)),i=ge.bitand(t,ge.make(4294967295));return this.writeUInt32(Number(n)),this.writeUInt32(Number(i)),this}writeBuffer(e){let t=e.length;return this.ensureAlloced(t),this._rawBuffer.set(e,this.pos),this.pos+=t,this}unwrap(){return this._rawBuffer.subarray(0,this.pos)}};A.WriteBuffer=Lr;var cr=class{constructor(){Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messagePos",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messagePos=-1,this.buffer=new Lr}reset(){return this.messagePos=-1,this.buffer.reset(),this}beginMessage(e){if(this.messagePos>=0)throw new I("cannot begin a new message: the previous message is not finished");return this.messagePos=this.buffer.position,this.buffer.writeChar(e),this.buffer.writeInt32(0),this}endMessage(){if(this.messagePos<0)throw new I("cannot end the message: no current message");return this.buffer.buffer.setInt32(this.messagePos+1,this.buffer.position-this.messagePos-1),this.messagePos=-1,this}writeLegacyHeaders(e){if(this.messagePos<0)throw new I("cannot writeHeaders: no current message");if(!e)return this.buffer.writeUInt16(0),this;let t=Object.entries(e).filter(([n,i])=>i!==void 0);this.buffer.writeUInt16(t.length);for(let[n,i]of t)if(this.buffer.writeUInt16(dl.LegacyHeaderCodes[n]),i instanceof Uint8Array)this.buffer.writeUInt32(i.byteLength),this.buffer.writeBuffer(i);else if(typeof i=="string")this.buffer.writeString(i);else throw new I("cannot write header: value is not a Uint8Array or string");return this}writeChar(e){if(this.messagePos<0)throw new I("cannot writeChar: no current message");return this.buffer.writeChar(e),this}writeString(e){if(this.messagePos<0)throw new I("cannot writeString: no current message");return this.buffer.writeString(e),this}writeBytes(e){if(this.messagePos<0)throw new I("cannot writeBytes: no current message");return this.buffer.writeBytes(e),this}writeInt16(e){if(this.messagePos<0)throw new I("cannot writeInt16: no current message");return this.buffer.writeInt16(e),this}writeInt32(e){if(this.messagePos<0)throw new I("cannot writeInt32: no current message");return this.buffer.writeInt32(e),this}writeUInt16(e){if(this.messagePos<0)throw new I("cannot writeInt16: no current message");return this.buffer.writeUInt16(e),this}writeUInt32(e){if(this.messagePos<0)throw new I("cannot writeInt32: no current message");return this.buffer.writeUInt32(e),this}writeBigInt64(e){if(this.messagePos<0)throw new I("cannot writeChar: no current message");return this.buffer.writeBigInt64(e),this}writeFlags(e,t){if(this.messagePos<0)throw new I("cannot writeChar: no current message");return this.buffer.writeUInt32(e),this.buffer.writeUInt32(t),this}writeBuffer(e){if(this.messagePos<0)throw new I("cannot writeBuffer: no current message");return this.buffer.writeBuffer(e),this}writeSync(){if(this.messagePos>=0)throw new I("cannot writeSync: the previous message is not finished");return this.buffer.writeBuffer(hl),this}writeFlush(){if(this.messagePos>=0)throw new I("cannot writeFlush: the previous message is not finished");return this.buffer.writeBuffer(gl),this}unwrap(){if(this.messagePos>=0)throw new I("cannot unwrap: an unfinished message is in the buffer");return this.buffer.unwrap()}};A.WriteMessageBuffer=cr;var hl=new cr().beginMessage(Ii.$S).endMessage().unwrap(),gl=new cr().beginMessage(Ii.$H).endMessage().unwrap(),B=[];for(let r=0;r<256;++r)B.push((r+256).toString(16).slice(1));function pl(r){let e=new Uint8Array(16);for(let t=0;t<16;t++)e[t]=parseInt(r.slice(t*2,t*2+2),16);return e}A.uuidToBuffer=pl;var Ci=class{constructor(){Object.defineProperty(this,"bufs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"len",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buf0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pos0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"len0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"curMessageType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"curMessageLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"curMessageLenUnread",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"curMessageReady",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bufs=[],this.buf0=null,this.pos0=0,this.len0=0,this.len=0,this.curMessageType=0,this.curMessageLen=0,this.curMessageLenUnread=0,this.curMessageReady=!1}get length(){return this.len}feed(e){this.buf0==null||this.pos0===this.len0&&this.bufs.length===0?(this.buf0=new DataView(e.buffer,e.byteOffset,e.byteLength),this.len0=e.byteLength,this.pos0=0,this.len=this.len0):this.feedEnqueue(e)}feedEnqueue(e){this.bufs.push(e),this.len+=e.byteLength}ensureFirstBuf(){this.pos0===this.len0&&this.__nextBuf();let e=this.buf0;if(e==null||e.byteLength<1)throw new I("empty buffer");return e}checkOverread(e){if(this.curMessageLenUnread<e||e>this.len)throw new I("buffer overread")}__nextBuf(){let e=this.bufs.shift();if(e==null)throw new I("buffer overread");this.buf0=new DataView(e.buffer,e.byteOffset,e.byteLength),this.pos0=0,this.len0=e.byteLength}discardBuffer(e){for(this.ensureFirstBuf();;)if(this.pos0+e>this.len0){let t=this.len0-this.pos0;this.pos0=this.len0,this.len-=t,e-=t,this.ensureFirstBuf()}else{this.pos0+=e,this.len-=e;break}}_finishMessage(){this.curMessageLen=0,this.curMessageLenUnread=0,this.curMessageReady=!1,this.curMessageType=0}__readBufferCopy(e,t){let n=new Uint8Array(t),i=0;for(;;)if(this.pos0+t>this.len0){let s=this.len0-this.pos0;n.set(new Uint8Array(e.buffer,e.byteOffset+this.pos0,s),i),i+=s,this.pos0=this.len0,this.len-=s,t-=s,e=this.ensureFirstBuf()}else{n.set(new Uint8Array(e.buffer,e.byteOffset+this.pos0,t),i),this.pos0+=t,this.len-=t;break}return n}_readBuffer(e){if(e===0)return Ur;let t=this.ensureFirstBuf();if(this.pos0+e<=this.len0){let n=new Uint8Array(t.buffer,t.byteOffset+this.pos0,e);return this.pos0+=e,this.len-=e,n}return this.__readBufferCopy(t,e)}readBuffer(e){this.checkOverread(e);let t=this._readBuffer(e);return this.curMessageLenUnread-=e,t}readUUID(){let e=this.readBuffer(16);return B[e[0]]+B[e[1]]+B[e[2]]+B[e[3]]+B[e[4]]+B[e[5]]+B[e[6]]+B[e[7]]+B[e[8]]+B[e[9]]+B[e[10]]+B[e[11]]+B[e[12]]+B[e[13]]+B[e[14]]+B[e[15]]}readChar(){this.checkOverread(1);let t=this.ensureFirstBuf().getUint8(this.pos0);return this.pos0++,this.curMessageLenUnread--,this.len--,t}readInt16(){this.checkOverread(2);let e=this.ensureFirstBuf();if(this.pos0+2<=this.len0){let n=e.getInt16(this.pos0);return this.pos0+=2,this.curMessageLenUnread-=2,this.len-=2,n}let t=this._readBuffer(2);return this.curMessageLenUnread-=2,new DataView(t.buffer,t.byteOffset,t.byteLength).getInt16(0)}readInt32(){this.checkOverread(4);let e=this.ensureFirstBuf();if(this.pos0+4<=this.len0){let n=e.getInt32(this.pos0);return this.pos0+=4,this.curMessageLenUnread-=4,this.len-=4,n}let t=this._readBuffer(4);return this.curMessageLenUnread-=4,new DataView(t.buffer,t.byteOffset,t.byteLength).getInt32(0)}readUInt16(){this.checkOverread(2);let e=this.ensureFirstBuf();if(this.pos0+2<=this.len0){let n=e.getUint16(this.pos0);return this.pos0+=2,this.curMessageLenUnread-=2,this.len-=2,n}let t=this._readBuffer(2);return this.curMessageLenUnread-=2,new DataView(t.buffer,t.byteOffset,t.byteLength).getUint16(0)}readUInt32(){this.checkOverread(4);let e=this.ensureFirstBuf();if(this.pos0+4<=this.len0){let n=e.getUint32(this.pos0);return this.pos0+=4,this.curMessageLenUnread-=4,this.len-=4,n}let t=this._readBuffer(4);return this.curMessageLenUnread-=4,new DataView(t.buffer,t.byteOffset,t.byteLength).getUint32(0)}readBigInt64(){this.checkOverread(8);let e=this.ensureFirstBuf();if(this.pos0+8<=this.len0){let n=e.getBigInt64(this.pos0);return this.pos0+=8,this.curMessageLenUnread-=8,this.len-=8,n}let t=this._readBuffer(8);return this.curMessageLenUnread-=8,new DataView(t.buffer,t.byteOffset,t.byteLength).getBigInt64(0)}readString(){let e=this.readInt32(),t=this.readBuffer(e);return A.utf8Decoder.decode(t)}readLenPrefixedBuffer(){let e=this.readInt32();return this.readBuffer(e)}takeMessage(){if(this.curMessageReady)return!0;if(this.curMessageType===0){if(this.len<1)return!1;let e=this.ensureFirstBuf();this.curMessageType=e.getUint8(this.pos0),this.pos0++,this.len--}if(this.curMessageLen===0){if(this.len<4)return!1;let e=this.ensureFirstBuf();if(this.pos0+4<=this.len0)this.curMessageLen=e.getInt32(this.pos0),this.pos0+=4,this.len-=4;else{let t=this._readBuffer(4);this.curMessageLen=new DataView(t.buffer,t.byteOffset,t.byteLength).getInt32(0)}this.curMessageLenUnread=this.curMessageLen-4}return this.len<this.curMessageLenUnread?!1:(this.curMessageReady=!0,!0)}getMessageType(){return this.curMessageType}takeMessageType(e){if(this.curMessageReady)return this.curMessageType===e;if(this.len>=1){let n=this.ensureFirstBuf().getUint8(this.pos0);return e===n&&this.takeMessage()}return!1}putMessage(){if(!this.curMessageReady)throw new I("cannot put message: no message taken");if(this.curMessageLenUnread!==this.curMessageLen-4)throw new I("cannot put message: message is partially read");this.curMessageReady=!1}discardMessage(){if(!this.curMessageReady)throw new I("no message to discard");this.curMessageLenUnread>0&&this.discardBuffer(this.curMessageLenUnread),this._finishMessage()}consumeMessage(){if(!this.curMessageReady)throw new I("no message to consume");let e;return this.curMessageLenUnread>0?(e=this._readBuffer(this.curMessageLenUnread),this.curMessageLenUnread=0):e=Ur,this._finishMessage(),e}consumeMessageInto(e){if(!this.curMessageReady)throw new I("no message to consume");if(this.curMessageLenUnread>0){if(this.pos0+this.curMessageLenUnread<=this.len0)Dt.init(e,new Uint8Array(this.buf0.buffer,this.buf0.byteOffset+this.pos0,this.curMessageLenUnread)),this.pos0+=this.curMessageLenUnread,this.len-=this.curMessageLenUnread;else{let t=this._readBuffer(this.curMessageLenUnread);Dt.init(e,t)}this.curMessageLenUnread=0}else Dt.init(e,Ur);this._finishMessage()}finishMessage(){if(!(this.curMessageType===0||!this.curMessageReady)){if(this.curMessageLenUnread)throw new I(`cannot finishMessage: unread data in message "${Ii.chr(this.curMessageType)}"`);this._finishMessage()}}};A.ReadMessageBuffer=Ci;var Dt=class{constructor(e){Object.defineProperty(this,"_rawBuffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pos",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"len",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._rawBuffer=e,this.buffer=new DataView(e.buffer,e.byteOffset,e.byteLength),this.len=e.length,this.pos=0}get position(){return this.pos}get length(){return this.len-this.pos}finish(){if(this.len!==this.pos)throw new I("unexpected trailing data in buffer")}discard(e){if(this.pos+e>this.len)throw new I("buffer overread");this.pos+=e}readUInt8(){if(this.pos+1>this.len)throw new I("buffer overread");let e=this.buffer.getUint8(this.pos);return this.pos++,e}readUInt16(){if(this.pos+2>this.len)throw new I("buffer overread");let e=this.buffer.getUint16(this.pos);return this.pos+=2,e}readInt8(){if(this.pos+1>this.len)throw new I("buffer overread");let e=this.buffer.getInt8(this.pos);return this.pos++,e}readInt16(){if(this.pos+2>this.len)throw new I("buffer overread");let e=this.buffer.getInt16(this.pos);return this.pos+=2,e}readInt32(){if(this.pos+4>this.len)throw new I("buffer overread");let e=this.buffer.getInt32(this.pos);return this.pos+=4,e}readFloat32(){if(this.pos+4>this.len)throw new I("buffer overread");let e=this.buffer.getFloat32(this.pos);return this.pos+=4,e}readFloat64(){if(this.pos+8>this.len)throw new I("buffer overread");let e=this.buffer.getFloat64(this.pos);return this.pos+=8,e}readUInt32(){if(this.pos+4>this.len)throw new I("buffer overread");let e=this.buffer.getUint32(this.pos);return this.pos+=4,e}reportInt64Overflow(e,t){let n=ge.make(e),i=ge.make(t>>>0),s=ge.add(ge.mul(n,ge.make(4294967296)),i);throw new I(`integer overflow: cannot unpack <std::int64>'${s.toString()}' into JavaScript Number type without losing precision`)}readInt64(){if(this.pos+8>this.len)throw new I("buffer overread");let e=this.buffer.getInt32(this.pos),t=this.buffer.getInt32(this.pos+4);return this.pos+=8,e===0?t>>>0:e>=-2097152&&e<2097152?e*4294967296+(t>>>0):this.reportInt64Overflow(e,t)}readBigInt64Fallback(){if(ge.hasNativeBigInt){let e=this.buffer.getUint32(this.pos),t=this.buffer.getUint32(this.pos+4);this.pos+=8;let n=(BigInt(e)<<BigInt(32))+BigInt(t);return e>=2147483648&&(n=BigInt("-18446744073709551616")+n),n}else{let e=this.readBuffer(8),t=ll.decodeInt64ToString(e);return ge.make(t)}}readBigInt64(){if(this.pos+8>this.len)throw new I("buffer overread");if(fl)return this.readBigInt64Fallback();{let e=this.buffer.getBigInt64(this.pos);return this.pos+=8,e}}readBuffer(e){if(this.pos+e>this.len)throw new I("buffer overread");let t=this._rawBuffer.subarray(this.pos,this.pos+e);return this.pos+=e,t}readUUID(e=""){if(this.pos+16>this.len)throw new I("buffer overread");let t=this._rawBuffer,n=this.pos,i=B[t[n+0]]+B[t[n+1]]+B[t[n+2]]+B[t[n+3]]+e+B[t[n+4]]+B[t[n+5]]+e+B[t[n+6]]+B[t[n+7]]+e+B[t[n+8]]+B[t[n+9]]+e+B[t[n+10]]+B[t[n+11]]+B[t[n+12]]+B[t[n+13]]+B[t[n+14]]+B[t[n+15]];return this.pos+=16,i}readString(){let e=this.readUInt32(),t=this.readBuffer(e);return A.utf8Decoder.decode(t)}consumeAsString(){if(this.pos===this.len)return"";let e=A.utf8Decoder.decode(this._rawBuffer.subarray(this.pos,this.len));return this.pos=this.len,e}consumeAsBuffer(){let e=this._rawBuffer.subarray(this.pos,this.len);return this.pos=this.len,e}sliceInto(e,t){if(this.pos+t>this.len)throw new I("buffer overread");e._rawBuffer=this._rawBuffer,e.buffer=this.buffer,e.pos=this.pos,e.len=this.pos+t,this.pos+=t}static init(e,t){e._rawBuffer=t,e.buffer=new DataView(t.buffer,t.byteOffset,t.byteLength),e.pos=0,e.len=t.byteLength}static alloc(){return new this(Ur)}};A.ReadBuffer=Dt});var Mi=w(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.prettyPrintError=At.EdgeDBError=void 0;var Go=Y(),$r=class extends Error{constructor(e,t){super(void 0,t),Object.defineProperty(this,"source",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_query",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_attrs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperties(this,{_message:{writable:!0,enumerable:!1},_query:{writable:!0,enumerable:!1},_attrs:{writable:!0,enumerable:!1}}),this._message=e??""}get message(){return this._message+(this._query&&this._attrs?Vo(this._attrs,this._query):"")}get name(){return this.constructor.name}hasTag(e){var t;return!!(!((t=this.constructor.tags)===null||t===void 0)&&t[e])}};Object.defineProperty($r,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{}});At.EdgeDBError=$r;var st;(function(r){r[r.hint=1]="hint",r[r.details=2]="details",r[r.serverTraceback=257]="serverTraceback",r[r.positionStart=-15]="positionStart",r[r.positionEnd=-14]="positionEnd",r[r.lineStart=-13]="lineStart",r[r.columnStart=-12]="columnStart",r[r.utf16ColumnStart=-11]="utf16ColumnStart",r[r.lineEnd=-10]="lineEnd",r[r.columnEnd=-9]="columnEnd",r[r.utf16ColumnEnd=-8]="utf16ColumnEnd",r[r.characterStart=-7]="characterStart",r[r.characterEnd=-6]="characterEnd"})(st||(st={}));function xr(r){if(r instanceof Uint8Array)try{return parseInt(Go.utf8Decoder.decode(r),10)}catch{}return null}function Vo(r,e){let t=xr(r.get(st.lineStart)),n=xr(r.get(st.lineEnd)),i=xr(r.get(st.utf16ColumnStart)),s=xr(r.get(st.utf16ColumnEnd));if(t==null||n==null||i==null||s==null)return"";let a=e.split(`
`),o=n.toString().length,u=`
`;u+="|".padStart(o+3)+`
`;for(let c=t;c<n+1;c++){let d=a[c-1],h=c===t?i:0,_=c===n?s:d.length;u+=` ${c.toString().padStart(o)} | ${d}
`,u+=`${"|".padStart(o+3)} ${"".padStart(_-h,"^").padStart(_)}
`}return r.has(st.hint)&&(u+=`Hint: ${Go.utf8Decoder.decode(r.get(st.hint))}
`),u}At.prettyPrintError=Vo});var Pi=w(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.SHOULD_RETRY=Nt.SHOULD_RECONNECT=void 0;Nt.SHOULD_RECONNECT=Symbol("SHOULD_RECONNECT");Nt.SHOULD_RETRY=Symbol("SHOULD_RETRY")});var T=w(l=>{"use strict";var Jo=l&&l.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),bl=l&&l.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),_l=l&&l.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Jo(e,r,t);return bl(e,r),e},wl=l&&l.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Jo(e,r,t)};Object.defineProperty(l,"__esModule",{value:!0});l.DuplicateDatabaseDefinitionError=l.DuplicateUserDefinitionError=l.DuplicatePropertyDefinitionError=l.DuplicateLinkDefinitionError=l.DuplicateModuleDefinitionError=l.DuplicateDefinitionError=l.InvalidCastDefinitionError=l.InvalidConstraintDefinitionError=l.InvalidFunctionDefinitionError=l.InvalidAliasDefinitionError=l.InvalidOperatorDefinitionError=l.InvalidDatabaseDefinitionError=l.InvalidUserDefinitionError=l.InvalidPropertyDefinitionError=l.InvalidLinkDefinitionError=l.InvalidModuleDefinitionError=l.InvalidDefinitionError=l.SchemaDefinitionError=l.SchemaError=l.UnknownParameterError=l.UnknownDatabaseError=l.UnknownUserError=l.UnknownPropertyError=l.UnknownLinkError=l.UnknownModuleError=l.InvalidReferenceError=l.InvalidPropertyTargetError=l.InvalidLinkTargetError=l.InvalidTargetError=l.InvalidTypeError=l.GraphQLSyntaxError=l.SchemaSyntaxError=l.EdgeQLSyntaxError=l.InvalidSyntaxError=l.QueryError=l.DisabledCapabilityError=l.UnsupportedCapabilityError=l.CapabilityError=l.ResultCardinalityMismatchError=l.StateMismatchError=l.ParameterTypeMismatchError=l.InputDataError=l.UnexpectedMessageError=l.TypeSpecNotFoundError=l.UnsupportedProtocolVersionError=l.BinaryProtocolError=l.ProtocolError=l.UnsupportedFeatureError=l.InternalServerError=l.EdgeDBError=void 0;l.InternalClientError=l.NoDataError=l.InvalidArgumentError=l.UnknownArgumentError=l.MissingArgumentError=l.QueryArgumentError=l.InterfaceError=l.ClientConnectionClosedError=l.ClientConnectionTimeoutError=l.ClientConnectionFailedTemporarilyError=l.ClientConnectionFailedError=l.ClientConnectionError=l.ClientError=l.WarningMessage=l.LogMessage=l.UnsupportedBackendFeatureError=l.BackendError=l.BackendUnavailableError=l.AvailabilityError=l.AuthenticationError=l.AccessError=l.ConfigurationError=l.WatchError=l.TransactionDeadlockError=l.TransactionSerializationError=l.TransactionConflictError=l.TransactionError=l.MissingRequiredError=l.CardinalityViolationError=l.ConstraintViolationError=l.IntegrityError=l.QueryAssertionError=l.AccessPolicyError=l.NumericOutOfRangeError=l.DivisionByZeroError=l.InvalidValueError=l.ExecutionError=l.IdleTransactionTimeoutError=l.TransactionTimeoutError=l.QueryTimeoutError=l.IdleSessionTimeoutError=l.SessionTimeoutError=l.DuplicateMigrationError=l.DuplicateCastDefinitionError=l.DuplicateConstraintDefinitionError=l.DuplicateFunctionDefinitionError=l.DuplicateViewDefinitionError=l.DuplicateOperatorDefinitionError=void 0;var ke=Mi(),Be=_l(Pi()),yl=Mi();Object.defineProperty(l,"EdgeDBError",{enumerable:!0,get:function(){return yl.EdgeDBError}});wl(Pi(),l);var Ti=class extends ke.EdgeDBError{get code(){return 16777216}};l.InternalServerError=Ti;var Di=class extends ke.EdgeDBError{get code(){return 33554432}};l.UnsupportedFeatureError=Di;var pt=class extends ke.EdgeDBError{get code(){return 50331648}};l.ProtocolError=pt;var Bt=class extends pt{get code(){return 50397184}};l.BinaryProtocolError=Bt;var Ai=class extends Bt{get code(){return 50397185}};l.UnsupportedProtocolVersionError=Ai;var Ni=class extends Bt{get code(){return 50397186}};l.TypeSpecNotFoundError=Ni;var Bi=class extends Bt{get code(){return 50397187}};l.UnexpectedMessageError=Bi;var lr=class extends pt{get code(){return 50462720}};l.InputDataError=lr;var ji=class extends lr{get code(){return 50462976}};l.ParameterTypeMismatchError=ji;var qr=class extends lr{get code(){return 50463232}};Object.defineProperty(qr,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{[Be.SHOULD_RETRY]:!0}});l.StateMismatchError=qr;var Ui=class extends pt{get code(){return 50528256}};l.ResultCardinalityMismatchError=Ui;var dr=class extends pt{get code(){return 50593792}};l.CapabilityError=dr;var Li=class extends dr{get code(){return 50594048}};l.UnsupportedCapabilityError=Li;var xi=class extends dr{get code(){return 50594304}};l.DisabledCapabilityError=xi;var tt=class extends ke.EdgeDBError{get code(){return 67108864}};l.QueryError=tt;var jt=class extends tt{get code(){return 67174400}};l.InvalidSyntaxError=jt;var $i=class extends jt{get code(){return 67174656}};l.EdgeQLSyntaxError=$i;var qi=class extends jt{get code(){return 67174912}};l.SchemaSyntaxError=qi;var Ri=class extends jt{get code(){return 67175168}};l.GraphQLSyntaxError=Ri;var Rr=class extends tt{get code(){return 67239936}};l.InvalidTypeError=Rr;var fr=class extends Rr{get code(){return 67240192}};l.InvalidTargetError=fr;var Fi=class extends fr{get code(){return 67240193}};l.InvalidLinkTargetError=Fi;var ki=class extends fr{get code(){return 67240194}};l.InvalidPropertyTargetError=ki;var rt=class extends tt{get code(){return 67305472}};l.InvalidReferenceError=rt;var Hi=class extends rt{get code(){return 67305473}};l.UnknownModuleError=Hi;var Wi=class extends rt{get code(){return 67305474}};l.UnknownLinkError=Wi;var Yi=class extends rt{get code(){return 67305475}};l.UnknownPropertyError=Yi;var Gi=class extends rt{get code(){return 67305476}};l.UnknownUserError=Gi;var Vi=class extends rt{get code(){return 67305477}};l.UnknownDatabaseError=Vi;var Ji=class extends rt{get code(){return 67305478}};l.UnknownParameterError=Ji;var Ki=class extends tt{get code(){return 67371008}};l.SchemaError=Ki;var hr=class extends tt{get code(){return 67436544}};l.SchemaDefinitionError=hr;var Se=class extends hr{get code(){return 67436800}};l.InvalidDefinitionError=Se;var Qi=class extends Se{get code(){return 67436801}};l.InvalidModuleDefinitionError=Qi;var Xi=class extends Se{get code(){return 67436802}};l.InvalidLinkDefinitionError=Xi;var zi=class extends Se{get code(){return 67436803}};l.InvalidPropertyDefinitionError=zi;var Zi=class extends Se{get code(){return 67436804}};l.InvalidUserDefinitionError=Zi;var es=class extends Se{get code(){return 67436805}};l.InvalidDatabaseDefinitionError=es;var ts=class extends Se{get code(){return 67436806}};l.InvalidOperatorDefinitionError=ts;var rs=class extends Se{get code(){return 67436807}};l.InvalidAliasDefinitionError=rs;var ns=class extends Se{get code(){return 67436808}};l.InvalidFunctionDefinitionError=ns;var is=class extends Se{get code(){return 67436809}};l.InvalidConstraintDefinitionError=is;var ss=class extends Se{get code(){return 67436810}};l.InvalidCastDefinitionError=ss;var we=class extends hr{get code(){return 67437056}};l.DuplicateDefinitionError=we;var as=class extends we{get code(){return 67437057}};l.DuplicateModuleDefinitionError=as;var os=class extends we{get code(){return 67437058}};l.DuplicateLinkDefinitionError=os;var us=class extends we{get code(){return 67437059}};l.DuplicatePropertyDefinitionError=us;var cs=class extends we{get code(){return 67437060}};l.DuplicateUserDefinitionError=cs;var ls=class extends we{get code(){return 67437061}};l.DuplicateDatabaseDefinitionError=ls;var ds=class extends we{get code(){return 67437062}};l.DuplicateOperatorDefinitionError=ds;var fs=class extends we{get code(){return 67437063}};l.DuplicateViewDefinitionError=fs;var hs=class extends we{get code(){return 67437064}};l.DuplicateFunctionDefinitionError=hs;var gs=class extends we{get code(){return 67437065}};l.DuplicateConstraintDefinitionError=gs;var ps=class extends we{get code(){return 67437066}};l.DuplicateCastDefinitionError=ps;var bs=class extends we{get code(){return 67437067}};l.DuplicateMigrationError=bs;var Ut=class extends tt{get code(){return 67502080}};l.SessionTimeoutError=Ut;var Fr=class extends Ut{get code(){return 67502336}};Object.defineProperty(Fr,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{[Be.SHOULD_RETRY]:!0}});l.IdleSessionTimeoutError=Fr;var _s=class extends Ut{get code(){return 67502592}};l.QueryTimeoutError=_s;var kr=class extends Ut{get code(){return 67504640}};l.TransactionTimeoutError=kr;var ws=class extends kr{get code(){return 67504641}};l.IdleTransactionTimeoutError=ws;var bt=class extends ke.EdgeDBError{get code(){return 83886080}};l.ExecutionError=bt;var _t=class extends bt{get code(){return 83951616}};l.InvalidValueError=_t;var ys=class extends _t{get code(){return 83951617}};l.DivisionByZeroError=ys;var ms=class extends _t{get code(){return 83951618}};l.NumericOutOfRangeError=ms;var vs=class extends _t{get code(){return 83951619}};l.AccessPolicyError=vs;var Es=class extends _t{get code(){return 83951620}};l.QueryAssertionError=Es;var Lt=class extends bt{get code(){return 84017152}};l.IntegrityError=Lt;var Os=class extends Lt{get code(){return 84017153}};l.ConstraintViolationError=Os;var Cs=class extends Lt{get code(){return 84017154}};l.CardinalityViolationError=Cs;var Ss=class extends Lt{get code(){return 84017155}};l.MissingRequiredError=Ss;var Hr=class extends bt{get code(){return 84082688}};l.TransactionError=Hr;var xt=class extends Hr{get code(){return 84082944}};Object.defineProperty(xt,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{[Be.SHOULD_RETRY]:!0}});l.TransactionConflictError=xt;var Wr=class extends xt{get code(){return 84082945}};Object.defineProperty(Wr,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{[Be.SHOULD_RETRY]:!0}});l.TransactionSerializationError=Wr;var Yr=class extends xt{get code(){return 84082946}};Object.defineProperty(Yr,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{[Be.SHOULD_RETRY]:!0}});l.TransactionDeadlockError=Yr;var Is=class extends bt{get code(){return 84148224}};l.WatchError=Is;var Ms=class extends ke.EdgeDBError{get code(){return 100663296}};l.ConfigurationError=Ms;var Gr=class extends ke.EdgeDBError{get code(){return 117440512}};l.AccessError=Gr;var Ps=class extends Gr{get code(){return 117506048}};l.AuthenticationError=Ps;var Vr=class extends ke.EdgeDBError{get code(){return 134217728}};l.AvailabilityError=Vr;var Jr=class extends Vr{get code(){return 134217729}};Object.defineProperty(Jr,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{[Be.SHOULD_RETRY]:!0}});l.BackendUnavailableError=Jr;var Kr=class extends ke.EdgeDBError{get code(){return 150994944}};l.BackendError=Kr;var Ts=class extends Kr{get code(){return 150995200}};l.UnsupportedBackendFeatureError=Ts;var Qr=class extends ke.EdgeDBError{get code(){return 4026531840}};l.LogMessage=Qr;var Ds=class extends Qr{get code(){return 4026597376}};l.WarningMessage=Ds;var wt=class extends ke.EdgeDBError{get code(){return 4278190080}};l.ClientError=wt;var $t=class extends wt{get code(){return 4278255616}};l.ClientConnectionError=$t;var Xr=class extends $t{get code(){return 4278255872}};l.ClientConnectionFailedError=Xr;var zr=class extends Xr{get code(){return 4278255873}};Object.defineProperty(zr,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{[Be.SHOULD_RECONNECT]:!0,[Be.SHOULD_RETRY]:!0}});l.ClientConnectionFailedTemporarilyError=zr;var Zr=class extends $t{get code(){return 4278256128}};Object.defineProperty(Zr,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{[Be.SHOULD_RECONNECT]:!0,[Be.SHOULD_RETRY]:!0}});l.ClientConnectionTimeoutError=Zr;var en=class extends $t{get code(){return 4278256384}};Object.defineProperty(en,"tags",{enumerable:!0,configurable:!0,writable:!0,value:{[Be.SHOULD_RECONNECT]:!0,[Be.SHOULD_RETRY]:!0}});l.ClientConnectionClosedError=en;var tn=class extends wt{get code(){return 4278321152}};l.InterfaceError=tn;var qt=class extends tn{get code(){return 4278321408}};l.QueryArgumentError=qt;var As=class extends qt{get code(){return 4278321409}};l.MissingArgumentError=As;var Ns=class extends qt{get code(){return 4278321410}};l.UnknownArgumentError=Ns;var Bs=class extends qt{get code(){return 4278321411}};l.InvalidArgumentError=Bs;var js=class extends wt{get code(){return 4278386688}};l.NoDataError=js;var Us=class extends wt{get code(){return 4278452224}};l.InternalClientError=Us});var Rs=w(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});var ml=T(),Ls=class{constructor(e,t){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.key=e,this.value=t,this.next=null,this.prev=null}},xs=class{constructor(){Object.defineProperty(this,"head",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tail",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"len",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.head=null,this.tail=null,this.len=0}get length(){return this.len}push(e,t){let n=new Ls(e,t);return this.head==null?(this.head=n,this.tail=n):(this.head.prev=n,n.next=this.head,this.head=n),this.len++,n}moveToTop(e){if(e.prev==null)return;let t=e.prev,n=e.next;t.next=n,n!=null&&(n.prev=t),this.tail===e&&(this.tail=t),e.prev=null,e.next=this.head,this.head.prev=e,this.head=e}deleteBottom(){if(!this.len||!this.tail||!this.head)return null;if(this.tail===this.head){this.len=0;let n=this.tail;return this.tail=null,this.head=null,n}let e=this.tail,t=this.tail.prev;return t.next=null,this.tail.prev=null,this.tail.next=null,this.tail=t,this.len--,e}},$s=class{constructor({capacity:e}){if(Object.defineProperty(this,"capacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"map",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"deque",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e<=0)throw new TypeError("capacity is expected to be greater than 0");this.capacity=e,this.map=new Map,this.deque=new xs}get length(){let e=this.map.size;if(e!==this.deque.length)throw new ml.InternalClientError("deque & map disagree on elements count");return e}has(e){return this.map.has(e)}get(e){let t=this.map.get(e);if(t!=null)return this.deque.moveToTop(t),t.value}set(e,t){let n=this.map.get(e);if(n!=null)n.value=t,this.deque.moveToTop(n);else{let i=this.deque.push(e,t);for(this.map.set(e,i);this.deque.length>this.capacity;){let s=this.deque.deleteBottom();this.map.delete(s.key)}}}*keys(){let e=this.deque.head;for(;e!=null;)yield e.key,e=e.next}*entries(){let e=this.deque.head;for(;e!=null;)yield[e.key,e.value],e=e.next}*values(){let e=this.deque.head;for(;e!=null;)yield e.value,e=e.next}};qs.default=$s});var yt=w(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});G.AT_LEAST_ONE=G.MANY=G.ONE=G.AT_MOST_ONE=G.NO_RESULT=G.KNOWN_TYPENAMES=G.KNOWN_TYPES=G.INVALID_CODEC_ID=G.NULL_CODEC_ID=void 0;G.NULL_CODEC_ID="00000000000000000000000000000000";G.INVALID_CODEC_ID="ffffffffffffffffffffffffffffffff";G.KNOWN_TYPES=new Map([["00000000000000000000000000000001","anytype"],["00000000000000000000000000000002","anytuple"],["000000000000000000000000000000f0","std"],["000000000000000000000000000000ff","empty-tuple"],["00000000000000000000000000000100","std::uuid"],["00000000000000000000000000000101","std::str"],["00000000000000000000000000000102","std::bytes"],["00000000000000000000000000000103","std::int16"],["00000000000000000000000000000104","std::int32"],["00000000000000000000000000000105","std::int64"],["00000000000000000000000000000106","std::float32"],["00000000000000000000000000000107","std::float64"],["00000000000000000000000000000108","std::decimal"],["00000000000000000000000000000109","std::bool"],["0000000000000000000000000000010a","std::datetime"],["0000000000000000000000000000010b","cal::local_datetime"],["0000000000000000000000000000010c","cal::local_date"],["0000000000000000000000000000010d","cal::local_time"],["0000000000000000000000000000010e","std::duration"],["0000000000000000000000000000010f","std::json"],["00000000000000000000000000000110","std::bigint"],["00000000000000000000000000000111","cal::relative_duration"],["00000000000000000000000000000112","cal::date_duration"],["00000000000000000000000000000130","cfg::memory"],["9565dd8804f511eea6910b6ebe179825","ext::pgvector::vector"]]);G.KNOWN_TYPENAMES=(()=>{let r=new Map;for(let[e,t]of G.KNOWN_TYPES.entries())r.set(t,e);return r})();G.NO_RESULT=110;G.AT_MOST_ONE=111;G.ONE=65;G.MANY=109;G.AT_LEAST_ONE=77});var V=w(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.ScalarCodec=Rt.Codec=void 0;var vl=Y(),Ko=yt(),rn=class{constructor(e){Object.defineProperty(this,"tid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tidBuffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tid=e,this.tidBuffer=(0,vl.uuidToBuffer)(e)}getKnownTypeName(){return"anytype"}};Rt.Codec=rn;var Fs=class extends rn{constructor(e,t=null){super(e),Object.defineProperty(this,"derivedFromTid",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"typeName",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"unknown"}),Object.defineProperty(this,"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.derivedFromTid=t}setTypeName(e){this.typeName=e}derive(e){let t=this.constructor;return new t(e,this.tid)}getSubcodecs(){return[]}getKind(){return"scalar"}getKnownTypeName(){return this.typeName?this.typeName:this.derivedFromTid?Ko.KNOWN_TYPES.get(this.derivedFromTid):Ko.KNOWN_TYPES.get(this.tid)||"anytype"}};Rt.ScalarCodec=Fs});var Qo=w(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.BoolCodec=void 0;var El=V(),Ol=T(),ks=class extends El.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"boolean"})}encode(e,t){let n=typeof t;if(n!=="boolean"&&n!=="number")throw new Ol.InvalidArgumentError(`a boolean or a number was expected, got "${t}"`);e.writeInt32(1),e.writeChar(t?1:0)}decode(e){return e.readUInt8()!==0}};nn.BoolCodec=ks});var Ks=w(K=>{"use strict";var Cl=K&&K.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Sl=K&&K.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Il=K&&K.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Cl(e,r,t);return Sl(e,r),e};Object.defineProperty(K,"__esModule",{value:!0});K.Float64Codec=K.Float32Codec=K.Int16Codec=K.Int32Codec=K.Int64BigintCodec=K.Int64Codec=void 0;var Ml=Il(gt()),Ft=V(),kt=T(),Hs=class extends Ft.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"number"})}encode(e,t){if(typeof t!="number")throw new kt.InvalidArgumentError(`a number was expected, got "${t}"`);e.writeInt32(8),e.writeInt64(t)}decode(e){return e.readInt64()}};K.Int64Codec=Hs;var Ws=class extends Ft.ScalarCodec{encode(e,t){if(!Ml.isBigInt(t))throw new kt.InvalidArgumentError(`a bigint was expected, got "${t}"`);e.writeInt32(8),e.writeBigInt64(t)}decode(e){return e.readBigInt64()}};K.Int64BigintCodec=Ws;var Ys=class extends Ft.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"number"})}encode(e,t){if(typeof t!="number")throw new kt.InvalidArgumentError(`a number was expected, got "${t}"`);e.writeInt32(4),e.writeInt32(t)}decode(e){return e.readInt32()}};K.Int32Codec=Ys;var Gs=class extends Ft.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"number"})}encode(e,t){if(typeof t!="number")throw new kt.InvalidArgumentError(`a number was expected, got "${t}"`);e.writeInt32(2),e.writeInt16(t)}decode(e){return e.readInt16()}};K.Int16Codec=Gs;var Vs=class extends Ft.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"number"})}encode(e,t){if(typeof t!="number")throw new kt.InvalidArgumentError(`a number was expected, got "${t}"`);e.writeInt32(4),e.writeFloat32(t)}decode(e){return e.readFloat32()}};K.Float32Codec=Vs;var Js=class extends Ft.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"number"})}encode(e,t){if(typeof t!="number")throw new kt.InvalidArgumentError(`a number was expected, got "${t}"`);e.writeInt32(8),e.writeFloat64(t)}decode(e){return e.readFloat64()}};K.Float64Codec=Js});var zo=w(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.DecimalStringCodec=Wt.BigIntCodec=void 0;var Xo=V(),Ht=T(),gr=0,sn=16384,Qs=class extends Xo.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"bigint"})}encode(e,t){if(typeof t!="bigint")throw new Ht.InvalidArgumentError(`a bigint was expected, got "${t}"`);let n=BigInt("10000"),i=BigInt("0"),s=[],a=gr,o=t;if(t===i){e.writeUInt32(8),e.writeUInt32(0),e.writeUInt16(gr),e.writeUInt16(0);return}for(t<i&&(a=sn,o=-o);o;){let u=o%n;o/=n,s.push(u)}e.writeUInt32(8+s.length*2),e.writeUInt16(s.length),e.writeUInt16(s.length-1),e.writeUInt16(a),e.writeUInt16(0);for(let u=s.length-1;u>=0;u--)e.writeUInt16(Number(s[u]))}decode(e){return BigInt(Pl(e))}};Wt.BigIntCodec=Qs;var Xs=class extends Xo.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"string"})}encode(e,t){if(typeof t!="string")throw new Ht.InvalidArgumentError(`a string was expected, got "${t}"`);let n=t.match(/^(-?)([0-9]+)(?:\.([0-9]+))?(?:[eE]([-+]?[0-9]+))?$/);if(!n)throw new Ht.InvalidArgumentError(`invalid decimal string "${t}"`);let[i,s,a,o,u]=n,c=o??"",d=u?parseInt(u,10):0,h=a.padStart(Math.ceil(a.length/4)*4,"0")+c.padEnd(Math.ceil(c.length/4)*4,"0"),_=[];for(let f=0,p=h.length;f<p;f+=4)_.push(parseInt(h.slice(f,f+4),10));e.writeUInt32(8+_.length*2),e.writeUInt16(_.length),e.writeInt16(Math.ceil((a.length+d)/4)-1),e.writeUInt16(s==="-"?sn:gr),e.writeUInt16(Math.max(c.length-d,0));for(let f=0,p=_.length;f<p;f++)e.writeUInt16(_[f])}decode(e){return Tl(e)}};Wt.DecimalStringCodec=Xs;function Pl(r){let e=r.readUInt16(),t=r.readInt16(),n=r.readUInt16(),i=r.readUInt16(),s="";switch(n){case gr:break;case sn:s+="-";break;default:throw new Ht.ProtocolError("bad bigint sign data")}if(i!==0)throw new Ht.ProtocolError("bigint data has fractional part");if(e===0)return"0";let a=t,o=0;for(;a>=0;){if(a<=t&&o<e){let u=r.readUInt16().toString();s+=o>0?u.padStart(4,"0"):u,o++}else s+="0000";a--}return s}function Tl(r){let e=r.readUInt16(),t=r.readInt16(),n=r.readUInt16(),i=r.readUInt16(),s="";switch(n){case gr:break;case sn:s+="-";break;default:throw new Ht.ProtocolError("bad decimal sign data")}let a=0;if(t<0)a=t+1,s+="0";else for(a=0;a<=t;a++){let u=(a<e?r.readUInt16():0).toString();a>0&&(u=u.padStart(4,"0")),s+=u}if(i>0){s+=".";let o=s.length+i;for(let u=0;u<i;a++,u+=4){let c=a>=0&&a<e?r.readUInt16():0;s+=c.toString().padStart(4,"0")}s=s.slice(0,o)}return s}});var Zs=w(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.StrCodec=void 0;var Dl=Y(),Al=V(),Nl=T(),zs=class extends Al.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"string"})}encode(e,t){if(typeof t!="string")throw new Nl.InvalidArgumentError(`a string was expected, got "${t}"`);let n=t,i=Dl.utf8Encoder.encode(n);e.writeInt32(i.length),e.writeBuffer(i)}decode(e){return e.consumeAsString()}};an.StrCodec=zs});var Zo=w(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.UUIDCodec=void 0;var Bl=Y(),jl=V(),Ul=T();function Ll(r){let e=r;if(e.length!==32&&(e=e.replace(/\-/g,""),e.length!==32))throw new TypeError(`invalid UUID "${r}"`);try{return(0,Bl.uuidToBuffer)(e)}catch{throw new TypeError(`invalid UUID "${r}"`)}}var ea=class extends jl.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"string"})}encode(e,t){if(typeof t=="string"){let n=Ll(t);e.writeInt32(16),e.writeBuffer(n)}else throw new Ul.InvalidArgumentError(`cannot encode UUID "${t}": invalid type`)}decode(e){return e.readUUID("-")}};on.UUIDCodec=ea});var eu=w(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});un.BytesCodec=void 0;var xl=V(),$l=T(),ta=class extends xl.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"Uint8Array"})}encode(e,t){if(!(t instanceof Uint8Array))throw new $l.InvalidArgumentError(`a Uint8Array or Buffer was expected, got "${t}"`);e.writeInt32(t.length),e.writeBuffer(t)}decode(e){return e.consumeAsBuffer()}};un.BytesCodec=ta});var ia=w(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.JSONStringCodec=Yt.JSONCodec=void 0;var tu=Y(),ru=V(),pr=T(),ra=class extends ru.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"unknown"})}encode(e,t){let n;try{n=JSON.stringify(t)}catch{throw new pr.InvalidArgumentError(`a JSON-serializable value was expected, got "${t}"`)}if(typeof n!="string")throw new pr.InvalidArgumentError(`a JSON-serializable value was expected, got "${t}"`);let i=tu.utf8Encoder.encode(n);e.writeInt32(i.length+1),e.writeChar(1),e.writeBuffer(i)}decode(e){let t=e.readUInt8();if(t!==1)throw new pr.ProtocolError(`unexpected JSON format ${t}`);return JSON.parse(e.consumeAsString())}};Yt.JSONCodec=ra;var na=class extends ru.ScalarCodec{encode(e,t){if(typeof t!="string")throw new pr.InvalidArgumentError(`a string was expected, got "${t}"`);let n=tu.utf8Encoder.encode(t);e.writeInt32(n.length+1),e.writeChar(1),e.writeBuffer(n)}decode(e){let t=e.readUInt8();if(t!==1)throw new pr.ProtocolError(`unexpected JSON format ${t}`);return e.consumeAsString()}};Yt.JSONStringCodec=na});var aa=w(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.ord2ymd=je.ymd2ord=je.daysBeforeMonth=je.daysInMonth=je.isLeapYear=void 0;function sa(r){return r%4===0&&(r%100!==0||r%400===0)}je.isLeapYear=sa;function ql(r,e){return e===2&&sa(r)?29:ln[e]}je.daysInMonth=ql;function dn(r){let e=r-1;return e*365+Math.trunc(e/4)-Math.trunc(e/100)+Math.trunc(e/400)}function nu(r,e){return iu[e]+(e>2&&sa(r)?1:0)}je.daysBeforeMonth=nu;var Rl=dn(401),Fl=dn(101),kl=dn(5),ln=[-1,31,28,31,30,31,30,31,31,30,31,30,31],iu=(()=>{let r=[-1],e=0;for(let t=1;t<ln.length;t++){let n=ln[t];r.push(e),e+=n}return r})();function Hl(r,e,t){return dn(r)+nu(r,e)+t}je.ymd2ord=Hl;function cn(r,e){let t=Math.floor(r/e);return[t,r-e*t]}function Wl(r){r--;let e;[e,r]=cn(r,Rl);let t=e*400+1,n;[n,r]=cn(r,Fl);let i;[i,r]=cn(r,kl);let s;if([s,r]=cn(r,365),t+=n*100+i*4+s,s===4||n===4)return[t-1,12,31];let a=s===3&&(i!==24||n===3),o=r+50>>5,u=iu[o]+(o>2&&a?1:0);return u>r&&(o-=1,u-=ln[o]+(o===2&&a?1:0)),r-=u,[t,o,r+1]}je.ord2ymd=Wl});var hn=w(R=>{"use strict";var Yl=R&&R.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Gl=R&&R.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Vl=R&&R.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Yl(e,r,t);return Gl(e,r),e};Object.defineProperty(R,"__esModule",{value:!0});R.parseHumanDurationString=R.DateDuration=R.RelativeDuration=R.Duration=R.LocalDateTime=R.LocalDateFromOrdinal=R.LocalDateToOrdinal=R.LocalDate=R.LocalTime=R.DATE_PRIVATE=void 0;var ee=Vl(gt()),mt=aa();R.DATE_PRIVATE=Symbol.for("edgedb.datetime");function Q(r){let e=Number(r);return Number.isNaN(e)?0:e}function Ge(r){if(!Number.isInteger(r))throw new RangeError(`unsupported fractional value ${r}`);return r}var fn=class{constructor(e=0,t=0,n=0,i=0,s=0,a=0){if(Object.defineProperty(this,"_hour",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_minute",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_second",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_millisecond",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_microsecond",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nanosecond",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e=Math.floor(Q(e)),t=Math.floor(Q(t)),n=Math.floor(Q(n)),i=Math.floor(Q(i)),s=Math.floor(Q(s)),a=Math.floor(Q(a)),e<0||e>23)throw new RangeError(`invalid number of hours ${e}: expected a value in 0-23 range`);if(t<0||t>59)throw new RangeError(`invalid number of minutes ${t}: expected a value in 0-59 range`);if(n<0||n>59)throw new RangeError(`invalid number of seconds ${n}: expected a value in 0-59 range`);if(i<0||i>999)throw new RangeError(`invalid number of milliseconds ${i}: expected a value in 0-999 range`);if(s<0||s>999)throw new RangeError(`invalid number of microseconds ${s}: expected a value in 0-999 range`);if(a<0||a>999)throw new RangeError(`invalid number of nanoseconds ${a}: expected a value in 0-999 range`);this._hour=e,this._minute=t,this._second=n,this._millisecond=i,this._microsecond=s,this._nanosecond=a}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}get microsecond(){return this._microsecond}get nanosecond(){return this._nanosecond}toString(){let e=this._hour.toString().padStart(2,"0"),t=this._minute.toString().padStart(2,"0"),n=this._second.toString().padStart(2,"0"),i=`${e}:${t}:${n}`;return(this._millisecond||this._microsecond||this._nanosecond)&&(i+=`.${this._millisecond.toString().padStart(3,"0")}${this._microsecond.toString().padStart(3,"0")}${this._nanosecond.toString().padStart(3,"0")}`.replace(/(?:0+)$/,"")),i}toJSON(){return this.toString()}valueOf(){throw new TypeError("Not possible to compare LocalTime")}};R.LocalTime=fn;var br=class{constructor(e,t,n){if(Object.defineProperty(this,"_date",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e=Math.trunc(Q(e)),t=Math.floor(Q(t)),n=Math.floor(Q(n)),e<-271820||e>275759)throw new RangeError(`invalid year ${e}: expected a value in -271820-275759 range`);if(t<1||t>12)throw new RangeError(`invalid month ${t}: expected a value in 1-12 range`);let i=(0,mt.daysInMonth)(e,t);if(n<1||n>i)throw new RangeError(`invalid number of days ${n}: expected a value in 1-${i} range`);this._date=new Date(Date.UTC(e,t-1,n)),e>=0&&e<=99&&this._date.setUTCFullYear(e)}get year(){return this._date.getUTCFullYear()}get month(){return this._date.getUTCMonth()+1}get day(){return this._date.getUTCDate()}get dayOfWeek(){return(this._date.getUTCDay()+6)%7+1}get dayOfYear(){return(0,mt.daysBeforeMonth)(this._date.getUTCFullYear(),this._date.getUTCMonth()+1)+this._date.getUTCDate()}get daysInWeek(){return 7}get daysInMonth(){return(0,mt.daysInMonth)(this._date.getUTCFullYear(),this._date.getUTCMonth()+1)}get daysInYear(){return(0,mt.isLeapYear)(this._date.getUTCFullYear())?366:365}get monthsInYear(){return 12}get inLeapYear(){return(0,mt.isLeapYear)(this._date.getUTCFullYear())}toString(){let e=this.year<0||this.year>9999?(this.year<0?"-":"+")+Math.abs(this.year).toString().padStart(6,"0"):this.year.toString().padStart(4,"0"),t=this.month.toString().padStart(2,"0"),n=this.day.toString().padStart(2,"0");return`${e}-${t}-${n}`}toJSON(){return this.toString()}valueOf(){throw new TypeError("Not possible to compare LocalDate")}};R.LocalDate=br;function Jl(r){return(0,mt.ymd2ord)(r.year,r.month,r.day)}R.LocalDateToOrdinal=Jl;function Kl(r){let[e,t,n]=(0,mt.ord2ymd)(r);return new br(e,t,n)}R.LocalDateFromOrdinal=Kl;var oa=class extends br{constructor(e,t,n,i=0,s=0,a=0,o=0,u=0,c=0){super(e,t,n),Object.defineProperty(this,"_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._time=new fn(i,s,a,o,u,c)}get hour(){return this._time._hour}get minute(){return this._time._minute}get second(){return this._time._second}get millisecond(){return this._time._millisecond}get microsecond(){return this._time._microsecond}get nanosecond(){return this._time._nanosecond}toString(){return`${super.toString()}T${this._time.toString()}`}valueOf(){throw new TypeError("Not possible to compare LocalDateTime")}};R.LocalDateTime=oa;var Ql=new RegExp("^(\\-|\\+)?P(?:(\\d+)Y)?(?:(\\d+)M)?(?:(\\d+)W)?(?:(\\d+)D)?(T(?:(\\d+)(\\.\\d{1,10})?H)?(?:(\\d+)(\\.\\d{1,10})?M)?(?:(\\d+)(\\.\\d{1,9})?S)?)?$","i"),ua=class r{constructor(e=0,t=0,n=0,i=0,s=0,a=0,o=0,u=0,c=0,d=0){Object.defineProperty(this,"_years",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_months",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_weeks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_days",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_hours",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_minutes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_seconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_milliseconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_microseconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nanoseconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_sign",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e=Ge(Q(e)),t=Ge(Q(t)),n=Ge(Q(n)),i=Ge(Q(i)),s=Ge(Q(s)),a=Ge(Q(a)),o=Ge(Q(o)),u=Ge(Q(u)),c=Ge(Q(c)),d=Ge(Q(d));let h=[e,t,n,i,s,a,o,u,c,d],_=0;for(let f of h){if(f===1/0||f===-1/0)throw new RangeError("infinite values not allowed as duration fields");let p=Math.sign(f);if(_&&p&&p!==_)throw new RangeError("mixed-sign values not allowed as duration fields");_=_||p}this._years=e||0,this._months=t||0,this._weeks=n||0,this._days=i||0,this._hours=s||0,this._minutes=a||0,this._seconds=o||0,this._milliseconds=u||0,this._microseconds=c||0,this._nanoseconds=d||0,this._sign=_||0}get years(){return this._years}get months(){return this._months}get weeks(){return this._weeks}get days(){return this._days}get hours(){return this._hours}get minutes(){return this._minutes}get seconds(){return this._seconds}get milliseconds(){return this._milliseconds}get microseconds(){return this._microseconds}get nanoseconds(){return this._nanoseconds}get sign(){return this._sign}get blank(){return this._sign===0}toString(){let e="";this._years&&(e+=ee.make(Math.abs(this._years))+"Y"),this._months&&(e+=ee.make(Math.abs(this._months))+"M"),this._weeks&&(e+=ee.make(Math.abs(this._weeks))+"W"),this._days&&(e+=ee.make(Math.abs(this._days))+"D");let t="";if(this._hours&&(t+=ee.make(Math.abs(this._hours))+"H"),this._minutes&&(t+=ee.make(Math.abs(this._minutes))+"M"),!e&&!t||this._seconds||this._milliseconds||this._microseconds||this._nanoseconds){let n=ee.add(ee.add(ee.add(ee.mul(ee.make(Math.abs(this._seconds)),ee.make(1e9)),ee.mul(ee.make(Math.abs(this._milliseconds)),ee.make(1e6))),ee.mul(ee.make(Math.abs(this._microseconds)),ee.make(1e3))),ee.make(Math.abs(this._nanoseconds))).toString().padStart(10,"0"),i=n.slice(0,-9),s=n.slice(-9).replace(/0+$/,"");t+=i+(s.length?"."+s:"")+"S"}return(this._sign===-1?"-":"")+"P"+e+(t?"T"+t:"")}toJSON(){return this.toString()}valueOf(){throw new TypeError("Not possible to compare TemporalDuration")}static from(e){let t;if(e instanceof r&&(t=e),typeof e=="object"){if(e.years===void 0&&e.months===void 0&&e.weeks===void 0&&e.days===void 0&&e.hours===void 0&&e.minutes===void 0&&e.seconds===void 0&&e.milliseconds===void 0&&e.microseconds===void 0&&e.nanoseconds===void 0)throw new TypeError("invalid duration-like");t=e}else{let n=String(e),i=n.match(Ql);if(!i)throw new RangeError(`invalid duration: ${n}`);let[s,a,o,u,c,d,h,_,f,p,m,O,C]=i;if(s.length<3||h.length===1)throw new RangeError(`invalid duration: ${n}`);let S=a==="-"?-1:1;if(t={},o&&(t.years=S*Number(o)),u&&(t.months=S*Number(u)),c&&(t.weeks=S*Number(c)),d&&(t.days=S*Number(d)),_&&(t.hours=S*Number(_)),f){if(p||m||O||C)throw new RangeError("only the smallest unit can be fractional");t.minutes=Number(f)*60}else t.minutes=Q(p);if(m){if(O||C)throw new RangeError("only the smallest unit can be fractional");t.seconds=Number(m)*60}else O?t.seconds=Number(O):t.seconds=t.minutes%1*60;if(C){let N=C.slice(1).padEnd(9,"0");t.milliseconds=Number(N.slice(0,3)),t.microseconds=Number(N.slice(3,6)),t.nanoseconds=S*Number(N.slice(6))}else t.milliseconds=t.seconds%1*1e3,t.microseconds=t.milliseconds%1*1e3,t.nanoseconds=S*Math.floor(t.microseconds%1*1e3);t.minutes=S*Math.floor(t.minutes),t.seconds=S*Math.floor(t.seconds),t.milliseconds=S*Math.floor(t.milliseconds),t.microseconds=S*Math.floor(t.microseconds)}return new r(t.years,t.months,t.weeks,t.days,t.hours,t.minutes,t.seconds,t.milliseconds,t.microseconds,t.nanoseconds)}};R.Duration=ua;var ca=class{constructor(e=0,t=0,n=0,i=0,s=0,a=0,o=0,u=0,c=0){Object.defineProperty(this,"_years",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_months",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_weeks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_days",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_hours",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_minutes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_seconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_milliseconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_microseconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._years=Math.trunc(e)||0,this._months=Math.trunc(t)||0,this._weeks=Math.trunc(n)||0,this._days=Math.trunc(i)||0,this._hours=Math.trunc(s)||0,this._minutes=Math.trunc(a)||0,this._seconds=Math.trunc(o)||0,this._milliseconds=Math.trunc(u)||0,this._microseconds=Math.trunc(c)||0}get years(){return this._years}get months(){return this._months}get weeks(){return this._weeks}get days(){return this._days}get hours(){return this._hours}get minutes(){return this._minutes}get seconds(){return this._seconds}get milliseconds(){return this._milliseconds}get microseconds(){return this._microseconds}toString(){let e="P";this._years&&(e+=`${this._years}Y`),this._months&&(e+=`${this._months}M`);let t=this._days+7*this._weeks;t&&(e+=`${t}D`);let n="";this._hours&&(n+=`${this._hours}H`),this._minutes&&(n+=`${this._minutes}M`);let i=this._seconds+this._milliseconds/1e3+this._microseconds/1e6;return i!==0&&(n+=`${i}S`),n&&(e+=`T${n}`),e==="P"?"PT0S":e}toJSON(){return this.toString()}valueOf(){throw new TypeError("Not possible to compare RelativeDuration")}};R.RelativeDuration=ca;var la=class{constructor(e=0,t=0,n=0,i=0){Object.defineProperty(this,"_years",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_months",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_weeks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_days",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._years=Math.trunc(e)||0,this._months=Math.trunc(t)||0,this._weeks=Math.trunc(n)||0,this._days=Math.trunc(i)||0}get years(){return this._years}get months(){return this._months}get weeks(){return this._weeks}get days(){return this._days}toString(){let e="P";this._years&&(e+=`${this._years}Y`),this._months&&(e+=`${this._months}M`);let t=this._days+7*this._weeks;return t&&(e+=`${t}D`),e==="P"?"PT0S":e}toJSON(){return this.toString()}valueOf(){throw new TypeError("Not possible to compare DateDuration")}};R.DateDuration=la;var Xl={h:36e5,hou:36e5,m:6e4,min:6e4,s:1e3,sec:1e3,ms:1,mil:1};function zl(r){let e=/(\d+|\d+\.\d+|\.\d+)\s*(hours?|minutes?|seconds?|milliseconds?|ms|h|m|s)\s*/g,t=0,n=new Set,i=e.exec(r),s=0;for(;i;){if(i.index!==s)throw new Error(`invalid duration "${r}"`);let a=Xl[i[2].slice(0,3)];if(n.has(a))throw new Error(`invalid duration "${r}"`);t+=Number(i[1])*a,n.add(a),s=e.lastIndex,i=e.exec(r)}if(s!==r.length)throw new Error(`invalid duration "${r}"`);return t}R.parseHumanDurationString=zl});var pn=w(H=>{"use strict";var Zl=H&&H.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ed=H&&H.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),td=H&&H.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Zl(e,r,t);return ed(e,r),e};Object.defineProperty(H,"__esModule",{value:!0});H.DateDurationCodec=H.RelativeDurationCodec=H.DurationCodec=H.checkValidEdgeDBDuration=H.LocalTimeCodec=H.LocalDateCodec=H.LocalDateTimeCodec=H.DateTimeCodec=void 0;var vt=V(),E=td(gt()),Ie=hn(),rd=aa(),Ve=T(),gn=9466848e5,su=(0,rd.ymd2ord)(2e3,1,1),da=class extends vt.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"Date"})}encode(e,t){if(!(t instanceof Date))throw new Ve.InvalidArgumentError(`a Date instance was expected, got "${t}"`);let i=(t.getTime()-gn)*1e3;e.writeInt32(8),e.writeInt64(i)}decode(e){let t=Number(e.readBigInt64()),n=Math.round(t/1e3);return Math.abs(t%1e3)===500&&Math.abs(n)%2===1&&(n-=1),new Date(n+gn)}};H.DateTimeCodec=da;var fa=class extends vt.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"LocalDateTime"}),Object.defineProperty(this,"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0})}encode(e,t){if(!(t instanceof Ie.LocalDateTime))throw new Ve.InvalidArgumentError(`a LocalDateTime instance was expected, got "${t}"`);let n=E.make(t._date.getTime()-gn),i=E.add(E.mul(n,E.make(1e3)),E.make(t.hour*36e8+t.minute*6e7+t.second*1e6+t.millisecond*1e3+t.microsecond));(t.nanosecond===500&&Math.abs(t.microsecond)%2===1||t.nanosecond>500)&&(i=E.add(i,E.make(1))),e.writeInt32(8),e.writeBigInt64(i)}decode(e){let t=E.make(1e3),n=e.readBigInt64(),i=E.div(n,t),s=Number(E.sub(n,E.mul(i,t))),a=Number(i);s<0&&(s+=1e3,a-=1);let o=new Date(Number(a)+gn);return new Ie.LocalDateTime(o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCMilliseconds(),s)}};H.LocalDateTimeCodec=fa;var ha=class extends vt.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"LocalDate"}),Object.defineProperty(this,"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0})}encode(e,t){if(!(t instanceof Ie.LocalDate))throw new Ve.InvalidArgumentError(`a LocalDate instance was expected, got "${t}"`);e.writeInt32(4),e.writeInt32((0,Ie.LocalDateToOrdinal)(t)-su)}decode(e){let t=e.readInt32();return(0,Ie.LocalDateFromOrdinal)(t+su)}};H.LocalDateCodec=ha;var ga=class extends vt.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"LocalTime"}),Object.defineProperty(this,"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0})}encode(e,t){if(!(t instanceof Ie.LocalTime))throw new Ve.InvalidArgumentError(`a LocalTime instance was expected, got "${t}"`);let n=t.hour*36e8+t.minute*6e7+t.second*1e6+t.millisecond*1e3+t.microsecond;(t.nanosecond===500&&n%2===1||t.nanosecond>500)&&(n+=1),e.writeInt32(8),e.writeInt64(n)}decode(e){let t=Number(e.readBigInt64()),n=Math.floor(t/1e6),i=Math.floor(t%1e6/1e3);t=t%1e6-i*1e3;let s=Math.floor(n/60);n=Math.floor(n%60);let a=Math.floor(s/60);return s=Math.floor(s%60),new Ie.LocalTime(a,s,n,i,t)}};H.LocalTimeCodec=ga;var nd=["years","months","weeks","days"];function au(r){for(let e of nd)if(r[e]!==0)return e;return null}H.checkValidEdgeDBDuration=au;var pa=class extends vt.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"Duration"}),Object.defineProperty(this,"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0})}encode(e,t){if(!(t instanceof Ie.Duration))throw new Ve.InvalidArgumentError(`a Duration instance was expected, got "${t}"`);let n=au(t);if(n)throw new Ve.InvalidArgumentError(`Cannot encode a 'Duration' with a non-zero number of ${n}`);let i=E.make(Math.abs(t.microseconds));i=E.add(i,E.mul(E.make(Math.abs(t.milliseconds)),E.make(1e3))),i=E.add(i,E.mul(E.make(Math.abs(t.seconds)),E.make(1e6))),i=E.add(i,E.mul(E.make(Math.abs(t.minutes)),E.make(6e7))),i=E.add(i,E.mul(E.make(Math.abs(t.hours)),E.make(36e8))),(Math.abs(t.nanoseconds)===500&&Math.abs(t.microseconds)%2===1||Math.abs(t.nanoseconds)>500)&&(i=E.add(i,E.make(1))),t.sign<0&&(i=E.mul(i,E.make(-1))),e.writeInt32(16),e.writeBigInt64(i),e.writeInt32(0),e.writeInt32(0)}decode(e){let t=e.readBigInt64(),n=e.readInt32(),i=e.readInt32();if(n!==0)throw new Ve.ProtocolError("non-zero reserved bytes in duration");if(i!==0)throw new Ve.ProtocolError("non-zero reserved bytes in duration");let s=1;Number(t)<0&&(s=-1,t=E.mul(E.make(-1),t));let a=E.make(1e6),o=E.div(t,a),u=Number(E.sub(t,E.mul(o,a))),c=Math.floor(u/1e3);u=u%1e3;let d=Number(o),h=Math.floor(d/60);d=Math.floor(d%60);let _=Math.floor(h/60);return h=Math.floor(h%60),new Ie.Duration(0,0,0,0,_*s,h*s,d*s,c*s,u*s)}};H.DurationCodec=pa;var ba=class extends vt.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"RelativeDuration"}),Object.defineProperty(this,"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0})}encode(e,t){if(!(t instanceof Ie.RelativeDuration))throw new Ve.InvalidArgumentError(`
        a RelativeDuration instance was expected, got "${t}"
      `);let n=E.make(t.microseconds);n=E.add(n,E.mul(E.make(t.milliseconds),E.make(1e3))),n=E.add(n,E.mul(E.make(t.seconds),E.make(1e6))),n=E.add(n,E.mul(E.make(t.minutes),E.make(6e7))),n=E.add(n,E.mul(E.make(t.hours),E.make(36e8))),e.writeInt32(16),e.writeBigInt64(n),e.writeInt32(t.days+7*t.weeks),e.writeInt32(t.months+12*t.years)}decode(e){let t=e.readBigInt64(),n=e.readInt32(),i=e.readInt32(),s=1;Number(t)<0&&(s=-1,t=E.mul(E.make(-1),t));let a=E.make(1e6),o=E.div(t,a),u=Number(E.sub(t,E.mul(o,a))),c=Math.trunc(u/1e3);u=u%1e3;let d=Number(o),h=Math.trunc(d/60);d=Math.trunc(d%60);let _=Math.trunc(h/60);h=Math.trunc(h%60);let f=Math.trunc(n/7);n=Math.trunc(n%7);let p=Math.trunc(i/12);return i=Math.trunc(i%12),new Ie.RelativeDuration(p,i,f,n,_*s,h*s,d*s,c*s,u*s)}};H.RelativeDurationCodec=ba;var _a=class extends vt.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"DateDuration"}),Object.defineProperty(this,"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0})}encode(e,t){if(!(t instanceof Ie.DateDuration))throw new Ve.InvalidArgumentError(`
        a DateDuration instance was expected, got "${t}"
      `);e.writeInt32(16),e.writeInt64(0),e.writeInt32(t.days+7*t.weeks),e.writeInt32(t.months+12*t.years)}decode(e){e.discard(8);let t=e.readInt32(),n=e.readInt32(),i=Math.trunc(t/7);t=Math.trunc(t%7);let s=Math.trunc(n/12);return n=Math.trunc(n%12),new Ie.DateDuration(s,n,i,t)}};H.DateDurationCodec=_a});var Oa=w(Je=>{"use strict";var id=Je&&Je.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),sd=Je&&Je.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),ad=Je&&Je.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&id(e,r,t);return sd(e,r),e};Object.defineProperty(Je,"__esModule",{value:!0});Je.ConfigMemory=void 0;var X=ad(gt()),wa=1024,ya=1024*wa,ma=1024*ya,va=1024*ma,ou=1024*va,Ea=class{constructor(e){Object.defineProperty(this,"_bytes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._bytes=e}get bytes(){return Number(this._bytes)}get bytesBigInt(){return this._bytes}get kibibytes(){return Number(this._bytes)/wa}get mebibytes(){return Number(this._bytes)/ya}get gibibytes(){return Number(this._bytes)/ma}get tebibytes(){return Number(this._bytes)/va}get pebibytes(){return Number(this._bytes)/ou}toString(){let e=this._bytes,t=X.make(ou);if(X.gte(e,t)&&Number(X.remainder(e,t))===0)return`${X.div(e,t)}PiB`;let n=X.make(va);if(X.gte(e,n)&&Number(X.remainder(e,n))===0)return`${X.div(e,n)}TiB`;let i=X.make(ma);if(X.gte(e,i)&&Number(X.remainder(e,i))===0)return`${X.div(e,i)}GiB`;let s=X.make(ya);if(X.gte(e,s)&&Number(X.remainder(e,s))===0)return`${X.div(e,s)}MiB`;let a=X.make(wa);return X.gte(e,a)&&Number(X.remainder(e,a))===0?`${X.div(e,a)}KiB`:`${e}B`}};Je.ConfigMemory=Ea});var cu=w(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.ConfigMemoryCodec=void 0;var od=V(),uu=Oa(),ud=T(),Ca=class extends od.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"ConfigMemory"}),Object.defineProperty(this,"importedType",{enumerable:!0,configurable:!0,writable:!0,value:!0})}encode(e,t){if(!(t instanceof uu.ConfigMemory))throw new ud.InvalidArgumentError(`a ConfigMemory instance was expected, got "${t}"`);e.writeInt32(8),e.writeBigInt64(t._bytes)}decode(e){return new uu.ConfigMemory(e.readBigInt64())}};bn.ConfigMemoryCodec=Ca});var lu=w(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Et.PgVectorCodec=Et.PG_VECTOR_MAX_DIM=void 0;var cd=V(),Sa=T();Et.PG_VECTOR_MAX_DIM=65536-1;var Ia=class extends cd.ScalarCodec{constructor(){super(...arguments),Object.defineProperty(this,"tsType",{enumerable:!0,configurable:!0,writable:!0,value:"Float32Array"})}encode(e,t){if(!(t instanceof Float32Array||Array.isArray(t)))throw new Sa.InvalidArgumentError(`a Float32Array or array of numbers was expected, got "${t}"`);if(t.length>Et.PG_VECTOR_MAX_DIM)throw new Sa.InvalidArgumentError("too many elements in array to encode into pgvector");if(e.writeInt32(4+t.length*4).writeUInt16(t.length).writeUInt16(0),t instanceof Float32Array)for(let n of t)e.writeFloat32(n);else for(let n of t){if(typeof n!="number")throw new Sa.InvalidArgumentError(`elements of vector array expected to be a numbers, got "${n}"`);e.writeFloat32(n)}}decode(e){let t=e.readUInt16();e.discard(2);let n=e.readBuffer(t*4),i=new DataView(n.buffer,n.byteOffset,n.byteLength),s=new Float32Array(t);for(let a=0;a<t;a++)s[a]=i.getFloat32(a*4);return s}};Et.PgVectorCodec=Ia});var _n=w(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.INVALID_CODEC=He.NULL_CODEC=He.SCALAR_CODECS=He.NullCodec=void 0;var ld=Y(),dd=Qo(),fd=V(),_r=Ks(),du=zo(),hd=Zs(),gd=Zo(),pd=eu(),bd=ia(),Ot=pn(),_d=cu(),wd=lu(),Ma=T(),Pa=yt(),Gt=class extends fd.Codec{encode(e,t){throw new Ma.InternalClientError("null codec cannot used to encode data")}decode(e){throw new Ma.InternalClientError("null codec cannot used to decode data")}getSubcodecs(){return[]}getKind(){return"scalar"}};Object.defineProperty(Gt,"BUFFER",{enumerable:!0,configurable:!0,writable:!0,value:new ld.WriteBuffer().writeInt32(0).unwrap()});He.NullCodec=Gt;He.SCALAR_CODECS=new Map;He.NULL_CODEC=new Gt(Pa.NULL_CODEC_ID);He.INVALID_CODEC=new Gt(Pa.INVALID_CODEC_ID);function J(r,e){let t=Pa.KNOWN_TYPENAMES.get(r);if(t==null)throw new Ma.InternalClientError("unknown type name");He.SCALAR_CODECS.set(t,new e(t))}J("std::int16",_r.Int16Codec);J("std::int32",_r.Int32Codec);J("std::int64",_r.Int64Codec);J("std::float32",_r.Float32Codec);J("std::float64",_r.Float64Codec);J("std::bigint",du.BigIntCodec);J("std::decimal",du.DecimalStringCodec);J("std::bool",dd.BoolCodec);J("std::json",bd.JSONCodec);J("std::str",hd.StrCodec);J("std::bytes",pd.BytesCodec);J("std::uuid",gd.UUIDCodec);J("cal::local_date",Ot.LocalDateCodec);J("cal::local_time",Ot.LocalTimeCodec);J("cal::local_datetime",Ot.LocalDateTimeCodec);J("std::datetime",Ot.DateTimeCodec);J("std::duration",Ot.DurationCodec);J("cal::relative_duration",Ot.RelativeDurationCodec);J("cal::date_duration",Ot.DateDurationCodec);J("cfg::memory",_d.ConfigMemoryCodec);J("ext::pgvector::vector",wd.PgVectorCodec)});var Jt=w(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.EMPTY_TUPLE_CODEC=Ye.EMPTY_TUPLE_CODEC_ID=Ye.EmptyTupleCodec=Ye.TupleCodec=void 0;var yd=yt(),fu=V(),wn=Y(),We=T(),Ta=class extends fu.Codec{constructor(e,t){super(e),Object.defineProperty(this,"subCodecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.subCodecs=t}encode(e,t,n=!1){if(!Array.isArray(t))throw new We.InvalidArgumentError(`an array was expected, got "${t}"`);let i=this.subCodecs,s=i.length;if(t.length!==s)throw new We.InvalidArgumentError(`expected ${s} tuple item${s===1?"":"s"}, got ${t.length}`);s||e.writeBuffer(Vt.BUFFER);let a=new wn.WriteBuffer;for(let u=0;u<s;u++){let c=t[u];if(a.writeInt32(0),c==null)if(n)a.writeInt32(-1);else throw new We.MissingArgumentError(`element at index ${u} in tuple cannot be 'null'`);else try{i[u].encode(a,c)}catch(d){throw d instanceof We.QueryArgumentError?new We.InvalidArgumentError(`invalid element at index ${u} in tuple: ${d.message}`):d}}let o=a.unwrap();e.writeInt32(4+o.length),e.writeInt32(s),e.writeBuffer(o)}encodeArgs(e){if(!Array.isArray(e))throw new We.InvalidArgumentError("an array of arguments was expected");let t=this.subCodecs.length;if(e.length!==t)throw new We.InvalidArgumentError(`expected ${t} argument${t===1?"":"s"}, got ${e.length}`);let n=new wn.WriteBuffer;return this.encode(n,e,!0),n.unwrap()}decode(e){let t=e.readUInt32(),n=this.subCodecs;if(t!==n.length)throw new We.ProtocolError(`cannot decode Tuple: expected ${n.length} elements, got ${t}`);let i=wn.ReadBuffer.alloc(),s=new Array(t);for(let a=0;a<t;a++){e.discard(4);let o=e.readInt32();o===-1?s[a]=null:(e.sliceInto(i,o),s[a]=n[a].decode(i),i.finish())}return s}getSubcodecs(){return Array.from(this.subCodecs)}getKind(){return"tuple"}};Ye.TupleCodec=Ta;var Vt=class extends fu.Codec{encode(e,t){if(!Array.isArray(t))throw new We.InvalidArgumentError("cannot encode empty Tuple: expected an array");if(t.length)throw new We.InvalidArgumentError(`cannot encode empty Tuple: expected 0 elements got ${t.length}`);e.writeInt32(4),e.writeInt32(0)}decode(e){let t=e.readInt32();if(t!==0)throw new We.ProtocolError(`cannot decode empty Tuple: expected 0 elements, received ${t}`);return[]}getSubcodecs(){return[]}getKind(){return"tuple"}};Object.defineProperty(Vt,"BUFFER",{enumerable:!0,configurable:!0,writable:!0,value:new wn.WriteBuffer().writeInt32(4).writeInt32(0).unwrap()});Ye.EmptyTupleCodec=Vt;Ye.EMPTY_TUPLE_CODEC_ID=yd.KNOWN_TYPENAMES.get("empty-tuple");Ye.EMPTY_TUPLE_CODEC=new Vt(Ye.EMPTY_TUPLE_CODEC_ID)});var Aa=w(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});yn.Range=void 0;var Da=class r{constructor(e,t,n=!0,i=!1){Object.defineProperty(this,"_lower",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"_upper",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_incLower",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_incUpper",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_isEmpty",{enumerable:!0,configurable:!0,writable:!0,value:!1})}get lower(){return this._lower}get upper(){return this._upper}get incLower(){return this._incLower}get incUpper(){return this._incUpper}get isEmpty(){return this._isEmpty}static empty(){let e=new r(null,null);return e._isEmpty=!0,e}toJSON(){return this.isEmpty?{empty:!0}:{lower:this._lower,upper:this._upper,inc_lower:this._incLower,inc_upper:this._incUpper}}};yn.Range=Da});var vn=w(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.RangeCodec=void 0;var md=V(),hu=Y(),Na=Aa(),vd=T(),Ue;(function(r){r[r.EMPTY=1]="EMPTY",r[r.INC_LOWER=2]="INC_LOWER",r[r.INC_UPPER=4]="INC_UPPER",r[r.EMPTY_LOWER=8]="EMPTY_LOWER",r[r.EMPTY_UPPER=16]="EMPTY_UPPER"})(Ue||(Ue={}));var Ba=class extends md.Codec{constructor(e,t){super(e),Object.defineProperty(this,"subCodec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.subCodec=t}encode(e,t){if(!(t instanceof Na.Range))throw new vd.InvalidArgumentError("a Range was expected");let n=this.subCodec,i=new hu.WriteBuffer;t.lower!==null&&n.encode(i,t.lower),t.upper!==null&&n.encode(i,t.upper);let s=i.unwrap();e.writeInt32(1+s.length),e.writeUInt8(t.isEmpty?Ue.EMPTY:(t.incLower?Ue.INC_LOWER:0)|(t.incUpper?Ue.INC_UPPER:0)|(t.lower===null?Ue.EMPTY_LOWER:0)|(t.upper===null?Ue.EMPTY_UPPER:0)),e.writeBuffer(s)}decode(e){let t=e.readUInt8();if(t&Ue.EMPTY)return Na.Range.empty();let n=hu.ReadBuffer.alloc(),i=this.subCodec,s=null,a=null;return t&Ue.EMPTY_LOWER||(e.sliceInto(n,e.readInt32()),s=i.decode(n),n.finish()),t&Ue.EMPTY_UPPER||(e.sliceInto(n,e.readInt32()),a=i.decode(n),n.finish()),new Na.Range(s,a,!!(t&Ue.INC_LOWER),!!(t&Ue.INC_UPPER))}getSubcodecs(){return[this.subCodec]}getKind(){return"range"}};mn.RangeCodec=Ba});var wr=w(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.NamedTupleCodec=void 0;var Ed=V(),En=Y(),Od=Jt(),at=T(),ja=class extends Ed.Codec{constructor(e,t,n){super(e),Object.defineProperty(this,"subCodecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"names",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"namesSet",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.subCodecs=t,this.names=n,this.namesSet=new Set(n)}encode(e,t){if(typeof t!="object"||Array.isArray(t))throw new at.InvalidArgumentError(`an object was expected, got "${t}"`);let n=this.subCodecs.length;if(Object.keys(t).length!==n)throw new at.QueryArgumentError(`expected ${n} element${n===1?"":"s"} in named tuple, got ${Object.keys(t).length}`);let i=new En.WriteBuffer;for(let a=0;a<n;a++){let o=this.names[a],u=t[o];if(u==null)throw new at.MissingArgumentError(`element '${o}' in named tuple cannot be 'null'`);i.writeInt32(0);try{this.subCodecs[a].encode(i,u)}catch(c){throw c instanceof at.QueryArgumentError?new at.InvalidArgumentError(`invalid element '${o}' in named tuple: ${c.message}`):c}}let s=i.unwrap();e.writeInt32(4+s.length),e.writeInt32(n),e.writeBuffer(s)}encodeArgs(e){if(e==null)throw new at.MissingArgumentError("One or more named arguments expected, received null");let t=Object.keys(e),n=this.names,i=this.namesSet,s=this.subCodecs,a=s.length;if(t.length>a){let d=t.filter(h=>!i.has(h));throw new at.UnknownArgumentError(`Unused named argument${d.length===1?"":"s"}: "${d.join('", "')}"`)}if(!a)return Od.EmptyTupleCodec.BUFFER;let o=new En.WriteBuffer;for(let d=0;d<a;d++){let h=n[d],_=e[h];o.writeInt32(0),_==null?o.writeInt32(-1):s[d].encode(o,_)}let u=o.unwrap(),c=new En.WriteBuffer;return c.writeInt32(4+u.length),c.writeInt32(a),c.writeBuffer(u),c.unwrap()}decode(e){let t=e.readUInt32(),n=this.subCodecs;if(t!==n.length)throw new at.ProtocolError(`cannot decode NamedTuple: expected ${n.length} elements, got ${t}`);let i=En.ReadBuffer.alloc(),s=this.names,a={};for(let o=0;o<t;o++){e.discard(4);let u=e.readInt32(),c=null;u!==-1&&(e.sliceInto(i,u),c=n[o].decode(i),i.finish()),a[s[o]]=c}return a}getSubcodecs(){return Array.from(this.subCodecs)}getNames(){return Array.from(this.names)}getKind(){return"namedtuple"}};On.NamedTupleCodec=ja});var Sn=w(Cn=>{"use strict";Object.defineProperty(Cn,"__esModule",{value:!0});Cn.ArrayCodec=void 0;var gu=V(),pu=Y(),Cd=Jt(),Sd=vn(),yr=T(),Id=wr(),Ua=class extends gu.Codec{constructor(e,t,n){super(e),Object.defineProperty(this,"subCodec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"len",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.subCodec=t,this.len=n}encode(e,t){if(!(this.subCodec instanceof gu.ScalarCodec||this.subCodec instanceof Cd.TupleCodec||this.subCodec instanceof Id.NamedTupleCodec||this.subCodec instanceof Sd.RangeCodec))throw new yr.InvalidArgumentError("only arrays of scalars or tuples are supported");if(!Array.isArray(t)&&!Md(t))throw new yr.InvalidArgumentError("an array was expected");let n=this.subCodec,i=new pu.WriteBuffer,s=t.length;if(s>2147483647)throw new yr.InvalidArgumentError("too many elements in array");for(let o=0;o<s;o++){let u=t[o];u==null?i.writeInt32(-1):n.encode(i,u)}let a=i.unwrap();e.writeInt32(12+8+a.length),e.writeInt32(1),e.writeInt32(0),e.writeInt32(0),e.writeInt32(s),e.writeInt32(1),e.writeBuffer(a)}decode(e){let t=e.readInt32();if(e.discard(4),e.discard(4),t===0)return[];if(t!==1)throw new yr.ProtocolError("only 1-dimensional arrays are supported");let n=e.readUInt32();if(this.len!==-1&&n!==this.len)throw new yr.ProtocolError(`invalid array size: received ${n}, expected ${this.len}`);e.discard(4);let i=new Array(n),s=pu.ReadBuffer.alloc(),a=this.subCodec;for(let o=0;o<n;o++){let u=e.readInt32();u===-1?i[o]=null:(e.sliceInto(s,u),i[o]=a.decode(s),s.finish())}return i}getSubcodecs(){return[this.subCodec]}getKind(){return"array"}};Cn.ArrayCodec=Ua;function Md(r){return!!(r.buffer instanceof ArrayBuffer&&r.BYTES_PER_ELEMENT)}});var xa=w(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});In.EnumCodec=void 0;var Pd=Zs(),La=class extends Pd.StrCodec{constructor(e,t=null,n){super(e,t),Object.defineProperty(this,"values",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.values=n}};In.EnumCodec=La});var Tn=w(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.ObjectCodec=void 0;var Td=V(),mr=Y(),Mn=yt(),ot=T(),Dd=1,Ad=2,$a=class extends Td.Codec{constructor(e,t,n,i,s){super(e),Object.defineProperty(this,"codecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"namesSet",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cardinalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.codecs=t,this.fields=new Array(n.length),this.namesSet=new Set,this.cardinalities=s;for(let a=0;a<n.length;a++){let o=!!(i[a]&Ad),u=o?`@${n[a]}`:n[a];this.fields[a]={name:u,implicit:!!(i[a]&Dd),linkprop:o,cardinality:s[a]},this.namesSet.add(u)}}encode(e,t){throw new ot.InvalidArgumentError("Objects cannot be passed as arguments")}encodeArgs(e){return this.fields[0].name==="0"?this._encodePositionalArgs(e):this._encodeNamedArgs(e)}_encodePositionalArgs(e){if(!Array.isArray(e))throw new ot.InvalidArgumentError("an array of arguments was expected");let t=this.codecs,n=t.length;if(e.length!==n)throw new ot.QueryArgumentError(`expected ${n} argument${n===1?"":"s"}, got ${e.length}`);let i=new mr.WriteBuffer;for(let o=0;o<n;o++){i.writeInt32(0);let u=e[o];if(u==null){let c=this.cardinalities[o];if(c===Mn.ONE||c===Mn.AT_LEAST_ONE)throw new ot.MissingArgumentError(`argument ${this.fields[o].name} is required, but received ${u}`);i.writeInt32(-1)}else t[o].encode(i,u)}let s=i.unwrap(),a=new mr.WriteBuffer;return a.writeInt32(4+s.length),a.writeInt32(n),a.writeBuffer(s),a.unwrap()}_encodeNamedArgs(e){if(e==null)throw new ot.MissingArgumentError("One or more named arguments expected, received null");let t=Object.keys(e),n=this.fields,i=this.namesSet,s=this.codecs,a=s.length;if(t.length>a){let d=t.filter(h=>!i.has(h));throw new ot.UnknownArgumentError(`Unused named argument${d.length===1?"":"s"}: "${d.join('", "')}"`)}let o=new mr.WriteBuffer;for(let d=0;d<a;d++){let h=n[d].name,_=e[h];if(o.writeInt32(0),_==null){let f=this.cardinalities[d];if(f===Mn.ONE||f===Mn.AT_LEAST_ONE)throw new ot.MissingArgumentError(`argument ${this.fields[d].name} is required, but received ${_}`);o.writeInt32(-1)}else s[d].encode(o,_)}let u=o.unwrap(),c=new mr.WriteBuffer;return c.writeInt32(4+u.length),c.writeInt32(a),c.writeBuffer(u),c.unwrap()}decode(e){let t=this.codecs,n=this.fields,i=e.readUInt32();if(i!==t.length)throw new ot.ProtocolError(`cannot decode Object: expected ${t.length} elements, got ${i}`);let s=mr.ReadBuffer.alloc(),a={};for(let o=0;o<i;o++){e.discard(4);let u=e.readInt32(),c=n[o].name,d=null;u!==-1&&(e.sliceInto(s,u),d=t[o].decode(s),s.finish()),a[c]=d}return a}getSubcodecs(){return Array.from(this.codecs)}getFields(){return Array.from(this.fields)}getKind(){return"object"}};Pn.ObjectCodec=$a});var Ra=w(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.SetCodec=void 0;var Nd=V(),bu=Y(),Bd=Sn(),vr=T(),qa=class extends Nd.Codec{constructor(e,t){super(e),Object.defineProperty(this,"subCodec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.subCodec=t}encode(e,t){throw new vr.InvalidArgumentError("Sets cannot be passed in query arguments")}decode(e){return this.subCodec instanceof Bd.ArrayCodec?this.decodeSetOfArrays(e):this.decodeSet(e)}decodeSetOfArrays(e){let t=e.readInt32();if(e.discard(4),e.discard(4),t===0)return[];if(t!==1)throw new vr.ProtocolError("expected 1-dimensional array of records of arrays");let n=e.readUInt32();e.discard(4);let i=new Array(n),s=bu.ReadBuffer.alloc(),a=this.subCodec;for(let o=0;o<n;o++){if(e.discard(4),e.readUInt32()!==1)throw new vr.ProtocolError("expected a record with a single element as an array set element envelope");e.discard(4);let c=e.readInt32();if(c===-1)throw new vr.ProtocolError("unexpected NULL value in array set element");e.sliceInto(s,c),i[o]=a.decode(s),s.finish()}return i}decodeSet(e){let t=e.readInt32();if(e.discard(4),e.discard(4),t===0)return[];if(t!==1)throw new vr.ProtocolError(`invalid set dimensinality: ${t}`);let n=e.readUInt32();e.discard(4);let i=new Array(n),s=bu.ReadBuffer.alloc(),a=this.subCodec;for(let o=0;o<n;o++){let u=e.readInt32();u===-1?i[o]=null:(e.sliceInto(s,u),i[o]=a.decode(s),s.finish())}return i}getSubcodecs(){return[this.subCodec]}getKind(){return"set"}};Dn.SetCodec=qa});var Kt=w(Ke=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});Ke.versionGreaterThanOrEqual=Ke.versionGreaterThan=Ke.sleep=Ke.getUniqueId=void 0;var Fa={};function jd(r=""){Fa[r]||(Fa[r]=0);let e=++Fa[r];return`_edgedb_${r}_${e.toString(16)}_`}Ke.getUniqueId=jd;function Ud(r){return new Promise(e=>{setTimeout(()=>e(),r)})}Ke.sleep=Ud;function _u(r,e){return r[0]>e[0]?!0:r[0]<e[0]?!1:r[1]>e[1]}Ke.versionGreaterThan=_u;function Ld(r,e){return r[0]===e[0]&&r[1]===e[1]?!0:_u(r,e)}Ke.versionGreaterThanOrEqual=Ld});var yu=w(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});An.SparseObjectCodec=void 0;var xd=V(),wu=Y(),$d=T(),ka=class extends xd.Codec{constructor(e,t,n){super(e),Object.defineProperty(this,"codecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"names",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.codecs=t,this.names=n}encode(e,t){let n=new wu.WriteBuffer,i=0;for(let[a,o]of Object.entries(t))if(o!==void 0){let u=this.names.indexOf(a);if(u===-1)throw new $d.UnknownArgumentError(this.names.length?`invalid global '${a}', valid globals are ${this.names.map(c=>`'${c}'`).join(", ")}`:`invalid global '${a}', no valid globals exist`);i+=1,n.writeInt32(u),o===null?n.writeInt32(-1):this.codecs[u].encode(n,o)}let s=n.unwrap();e.writeInt32(4+s.length),e.writeInt32(i),e.writeBuffer(s)}decode(e){let t=this.codecs,n=this.names,i=e.readUInt32(),s=wu.ReadBuffer.alloc(),a={};for(let o=0;o<i;o++){let u=e.readUInt32(),c=e.readInt32(),d=n[u],h=null;c!==-1&&(e.sliceInto(s,c),h=t[u].decode(s),s.finish()),a[d]=h}return a}getSubcodecs(){return Array.from(this.codecs)}getKind(){return"sparse_object"}};An.SparseObjectCodec=ka});var Ka=w(Le=>{"use strict";var qd=Le&&Le.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Rd=Le&&Le.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Bu=Le&&Le.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&qd(e,r,t);return Rd(e,r),e},Fd=Le&&Le.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Le,"__esModule",{value:!0});Le.CodecsRegistry=void 0;var mu=Y(),vu=Fd(Rs()),Ha=V(),Eu=_n(),nt=yt(),Er=Jt(),kd=Bu(Ks()),Hd=Bu(pn()),Wd=ia(),Yd=Sn(),Gd=wr(),Vd=xa(),Jd=Tn(),Kd=Ra(),Qd=vn(),Ou=Kt(),Xd=yu(),oe=T(),zd=1e3,Zd=200,Cu=0,Su=1,Iu=2,Mu=3,Pu=4,Tu=5,Du=6,Au=7,Wa=8,Nu=9,Ya=nt.KNOWN_TYPENAMES.get("std::int64"),Ga=nt.KNOWN_TYPENAMES.get("std::datetime"),Va=nt.KNOWN_TYPENAMES.get("std::json"),Ja=class{constructor(){Object.defineProperty(this,"codecsBuildCache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"codecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"customScalarCodecs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.codecs=new vu.default({capacity:zd}),this.codecsBuildCache=new vu.default({capacity:Zd}),this.customScalarCodecs=new Map}setCustomCodecs({int64_bigint:e,datetime_localDatetime:t,json_string:n}={}){e?this.customScalarCodecs.set(Ya,new kd.Int64BigintCodec(Ya)):this.customScalarCodecs.delete(Ya),t?this.customScalarCodecs.set(Ga,new Hd.LocalDateTimeCodec(Ga)):this.customScalarCodecs.delete(Ga),n?this.customScalarCodecs.set(Va,new Wd.JSONStringCodec(Va)):this.customScalarCodecs.delete(Va)}hasCodec(e){return this.codecs.has(e)?!0:e===nt.NULL_CODEC_ID||e===Er.EMPTY_TUPLE_CODEC_ID}getCodec(e){let t=this.codecs.get(e);return t??(e===Er.EMPTY_TUPLE_CODEC_ID?Er.EMPTY_TUPLE_CODEC:e===nt.NULL_CODEC_ID?Eu.NULL_CODEC:null)}buildCodec(e,t){let n=new mu.ReadBuffer(e),i=[],s=null;for(;n.length;)s=this._buildCodec(n,i,t),s!=null&&(i.push(s),this.codecs.set(s.tid,s));if(!i.length)throw new oe.InternalClientError("could not build a codec");return i[i.length-1]}_buildCodec(e,t,n){var i;let s=e.readUInt8(),a=e.readUUID(),o=this.codecs.get(a);if(o==null&&(o=this.codecsBuildCache.get(a)),o!=null){switch(s){case Cu:{e.discard(2);break}case Su:case Wa:{let u=e.readUInt16();for(let c=0;c<u;c++){(0,Ou.versionGreaterThanOrEqual)(n,[0,11])?e.discard(5):e.discard(1);let d=e.readUInt32();e.discard(d+2)}break}case Iu:break;case Nu:case Mu:{e.discard(2);break}case Pu:{let u=e.readUInt16();e.discard(2*u);break}case Tu:{let u=e.readUInt16();for(let c=0;c<u;c++){let d=e.readUInt32();e.discard(d+2)}break}case Du:{if(e.discard(2),e.readUInt16()!==1)throw new oe.ProtocolError("cannot handle arrays with more than one dimension");e.discard(4);break}case Au:{let u=e.readUInt16();for(let c=0;c<u;c++){let d=e.readUInt32();e.discard(d)}break}default:if(s>=127&&s<=255){let u=e.readUInt32();if(s===255){let c=mu.utf8Decoder.decode(e.readBuffer(u)),d=(i=this.codecs.get(a))!==null&&i!==void 0?i:this.codecsBuildCache.get(a);d instanceof Ha.ScalarCodec&&d.setTypeName(c)}else e.discard(u);return null}else throw new oe.InternalClientError(`no codec implementation for EdgeDB data class ${s}`)}return o}switch(s){case Iu:{if(o=this.customScalarCodecs.get(a),o!=null)break;if(o=Eu.SCALAR_CODECS.get(a),!o)throw nt.KNOWN_TYPES.has(a)?new oe.InternalClientError(`no JS codec for ${nt.KNOWN_TYPES.get(a)}`):new oe.InternalClientError(`no JS codec for the type with ID ${a}`);if(!(o instanceof Ha.ScalarCodec))throw new oe.ProtocolError("could not build scalar codec: base scalar is a non-scalar codec");break}case Su:case Wa:{let u=e.readUInt16(),c=new Array(u),d=new Array(u),h=new Array(u),_=new Array(u);for(let f=0;f<u;f++){let p,m;(0,Ou.versionGreaterThanOrEqual)(n,[0,11])?(p=e.readUInt32(),m=e.readUInt8()):(p=e.readUInt8(),m=0);let O=e.readString(),C=e.readUInt16(),S=t[C];if(S==null)throw new oe.ProtocolError("could not build object codec: missing subcodec");c[f]=S,d[f]=O,h[f]=p,_[f]=m}o=s===Wa?new Xd.SparseObjectCodec(a,c,d):new Jd.ObjectCodec(a,c,d,h,_);break}case Cu:{let u=e.readUInt16(),c=t[u];if(c==null)throw new oe.ProtocolError("could not build set codec: missing subcodec");o=new Kd.SetCodec(a,c);break}case Mu:{let u=e.readUInt16();if(o=t[u],o==null)throw new oe.ProtocolError("could not build scalar codec: missing a codec for base scalar");if(!(o instanceof Ha.ScalarCodec))throw new oe.ProtocolError("could not build scalar codec: base scalar has a non-scalar codec");o=o.derive(a);break}case Du:{let u=e.readUInt16();if(e.readUInt16()!==1)throw new oe.ProtocolError("cannot handle arrays with more than one dimension");let d=e.readInt32(),h=t[u];if(h==null)throw new oe.ProtocolError("could not build array codec: missing subcodec");o=new Yd.ArrayCodec(a,h,d);break}case Pu:{let u=e.readUInt16();if(u===0)o=Er.EMPTY_TUPLE_CODEC;else{let c=new Array(u);for(let d=0;d<u;d++){let h=e.readUInt16(),_=t[h];if(_==null)throw new oe.ProtocolError("could not build tuple codec: missing subcodec");c[d]=_}o=new Er.TupleCodec(a,c)}break}case Tu:{let u=e.readUInt16(),c=new Array(u),d=new Array(u);for(let h=0;h<u;h++){d[h]=e.readString();let _=e.readUInt16(),f=t[_];if(f==null)throw new oe.ProtocolError("could not build namedtuple codec: missing subcodec");c[h]=f}o=new Gd.NamedTupleCodec(a,c,d);break}case Au:{let u=e.readUInt16(),c=[];for(let d=0;d<u;d++)c.push(e.readString());o=new Vd.EnumCodec(a,null,c);break}case Nu:{let u=e.readUInt16(),c=t[u];if(c==null)throw new oe.ProtocolError("could not build range codec: missing subcodec");o=new Qd.RangeCodec(a,c);break}}if(o==null)throw nt.KNOWN_TYPES.has(a)?new oe.InternalClientError(`could not build a codec for ${nt.KNOWN_TYPES.get(a)} type`):new oe.InternalClientError(`could not build a codec for ${a} type`);return this.codecsBuildCache.set(a,o),o}};Le.CodecsRegistry=Ja});var ut=w(W=>{"use strict";var ef=W&&W.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),tf=W&&W.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),rf=W&&W.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&ef(e,r,t);return tf(e,r),e};Object.defineProperty(W,"__esModule",{value:!0});W.Options=W.Session=W.TransactionOptions=W.RetryOptions=W.RetryCondition=W.IsolationLevel=W.defaultBackoff=void 0;var ju=rf(T());function Uu(r){return 2**r*100+Math.random()*100}W.defaultBackoff=Uu;var Lu;(function(r){r.Serializable="SERIALIZABLE"})(Lu=W.IsolationLevel||(W.IsolationLevel={}));var Qa;(function(r){r[r.TransactionConflict=0]="TransactionConflict",r[r.NetworkError=1]="NetworkError"})(Qa=W.RetryCondition||(W.RetryCondition={}));var Nn=class{constructor(e,t){Object.defineProperty(this,"attempts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"backoff",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.attempts=e,this.backoff=t}},Qt=class r{constructor(e=3,t=Uu){Object.defineProperty(this,"default",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"overrides",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.default=new Nn(e,t),this.overrides=new Map}withRule(e,t,n){let i=this.default,s=new Map(this.overrides);s.set(e,new Nn(t??i.attempts,n??i.backoff));let a=Object.create(r.prototype);return a.default=i,a.overrides=s,a}getRuleForException(e){let t;return e instanceof ju.TransactionConflictError?t=this.overrides.get(Qa.TransactionConflict):e instanceof ju.ClientError&&(t=this.overrides.get(Qa.NetworkError)),t??this.default}static defaults(){return new r}};W.RetryOptions=Qt;var Xt=class r{constructor({isolation:e=Lu.Serializable,readonly:t=!1,deferrable:n=!1}={}){Object.defineProperty(this,"isolation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"readonly",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"deferrable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.isolation=e,this.readonly=t,this.deferrable=n}static defaults(){return new r}};W.TransactionOptions=Xt;var Or=class r{constructor({module:e="default",moduleAliases:t={},config:n={},globals:i={}}={}){Object.defineProperty(this,"module",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moduleAliases",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"globals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.module=e,this.moduleAliases=t,this.config=n,this.globals=i}withModuleAliases({module:e,...t}){return new r({...this,module:e??this.module,moduleAliases:{...this.moduleAliases,...t}})}withConfig(e){return new r({...this,config:{...this.config,...e}})}withGlobals(e){return new r({...this,globals:{...this.globals,...e}})}_serialise(){let e={};this.module!=="default"&&(e.module=this.module);let t=Object.entries(this.moduleAliases);t.length&&(e.aliases=t),Object.keys(this.config).length&&(e.config=this.config);let n=Object.entries(this.globals);return n.length&&(e.globals=n.reduce((i,[s,a])=>(i[s.includes("::")?s:`${this.module}::${s}`]=a,i),{})),e}static defaults(){return nf}};W.Session=Or;var nf=new Or,Xa=class r{constructor({retryOptions:e=Qt.defaults(),transactionOptions:t=Xt.defaults(),session:n=Or.defaults()}={}){Object.defineProperty(this,"retryOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"transactionOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.retryOptions=e,this.transactionOptions=t,this.session=n}withTransactionOptions(e){return new r({...this,transactionOptions:e instanceof Xt?e:new Xt(e)})}withRetryOptions(e){return new r({...this,retryOptions:e instanceof Qt?e:new Qt(e.attempts,e.backoff)})}withSession(e){return new r({...this,session:e})}static defaults(){return new r}};W.Options=Xa});var Cr=w(Za=>{"use strict";Object.defineProperty(Za,"__esModule",{value:!0});var Bn=T(),za=class{async wait(){await this._promise}then(...e){throw new Bn.InternalClientError("Event objects cannot be awaited on directly; use Event.wait()")}get done(){return this._done}set(){if(this._done)throw new Bn.InternalClientError("emit(): the Event is already set");this._resolve(!0)}setError(e){if(this._done)throw new Bn.InternalClientError("emitError(): the Event is already set");this._reject(e)}constructor(){Object.defineProperty(this,"_promise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_resolve",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_reject",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_done",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._done=!1;let e=null,t=null;if(this._promise=new Promise((n,i)=>{e=s=>{this._done=!0,i(s)},t=s=>{this._done=!0,n(s)}}),!e||!t)throw new Bn.InternalClientError("Promise executor was not called synchronously");this._reject=e,this._resolve=t}};Za.default=za});var $u=w(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.LifoQueue=void 0;var xu=T(),eo=class{constructor(){Object.defineProperty(this,"_promises",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_resolvers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rejecters",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._resolvers=[],this._rejecters=[],this._promises=[]}_add(){this._promises.push(new Promise((e,t)=>{this._resolvers.push(e),this._rejecters.push(t)}))}push(e){this._resolvers.length||this._add();let t=this._resolvers.shift();if(this._rejecters.shift(),!t)throw new xu.InternalClientError("resolve function was null or undefined when attempting to push.");t(e)}get(){this._promises.length||this._add();let e=this._promises.pop();if(!e)throw new xu.InternalClientError("promise was null or undefined when attempting to get.");return e}cancelAllPending(e){let t=this._rejecters;this._rejecters=[],this._resolvers=[];for(let n of t)n(e)}get length(){return this._promises.length-this._resolvers.length}get pending(){return Math.max(0,this._resolvers.length-this._promises.length)}};jn.LifoQueue=eo});var Ru=w(Qe=>{"use strict";var sf=Qe&&Qe.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),af=Qe&&Qe.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),of=Qe&&Qe.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&sf(e,r,t);return af(e,r),e};Object.defineProperty(Qe,"__esModule",{value:!0});Qe.retryingConnect=void 0;var qu=of(T()),uf=Kt(),to=0;async function cf(r,e,t){let n=e.connectionParams.waitUntilAvailable===0?0:Date.now()+e.connectionParams.waitUntilAvailable;for(;;){try{return await r(e.connectionParams.address,e,t)}catch(i){if(i instanceof qu.ClientConnectionError)if(i.hasTag(qu.SHOULD_RECONNECT)){let s=Date.now();if(s>n)throw i;if(e.logging&&(!to||s-to>5e3)){to=s;let a=[`A client connection error occurred; reconnecting because of "waitUntilAvailable=${e.connectionParams.waitUntilAvailable}".`,i];!e.fromProject&&!e.fromEnv&&await e.inProject()&&a.push(`


Hint: it looks like the program is running from a directory initialized with "edgedb project init". Consider calling "edgedb.connect()" without arguments.
`),console.warn(...a)}}else throw i;else throw console.error("Unexpected connection error:",i),i}await(0,uf.sleep)(Math.trunc(10+Math.random()*200))}}Qe.retryingConnect=cf});var Fu=w(Me=>{"use strict";var lf=Me&&Me.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),df=Me&&Me.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),ff=Me&&Me.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&lf(e,r,t);return df(e,r),e};Object.defineProperty(Me,"__esModule",{value:!0});Me.Transaction=Me.TransactionState=void 0;var Un=ff(T()),z=Tt(),Ct;(function(r){r[r.ACTIVE=0]="ACTIVE",r[r.COMMITTED=1]="COMMITTED",r[r.ROLLEDBACK=2]="ROLLEDBACK",r[r.FAILED=3]="FAILED"})(Ct=Me.TransactionState||(Me.TransactionState={}));var ro=class r{constructor(e,t){Object.defineProperty(this,"_holder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rawConn",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_opInProgress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._holder=e,this._rawConn=t,this._state=Ct.ACTIVE,this._opInProgress=!1}static async _startTransaction(e){let t=await e._getConnection();await t.resetState();let n=e.options.transactionOptions;return await t.fetch(`START TRANSACTION ISOLATION ${n.isolation}, ${n.readonly?"READ ONLY":"READ WRITE"}, ${n.deferrable?"":"NOT "}DEFERRABLE;`,void 0,z.OutputFormat.NONE,z.Cardinality.NO_RESULT,e.options.session,!0),new r(e,t)}async _waitForConnAbort(){await this._rawConn.connAbortWaiter.wait();let e=this._rawConn.getConnAbortError();throw e instanceof Un.EdgeDBError&&e.source instanceof Un.TransactionTimeoutError?e.source:e}async _runOp(e,t,n){if(this._opInProgress)throw new Un.InterfaceError(n??"Another query is in progress. Use the query methods on 'Client' to run queries concurrently.");if(this._state!==Ct.ACTIVE)throw new Un.InterfaceError(`cannot ${e}; the transaction is ${this._state===Ct.COMMITTED?"already committed":this._state===Ct.ROLLEDBACK?"already rolled back":"in error state"}`);this._opInProgress=!0;try{return await t()}finally{this._opInProgress=!1}}async _commit(){await this._runOp("commit",async()=>{await this._rawConn.fetch("COMMIT",void 0,z.OutputFormat.NONE,z.Cardinality.NO_RESULT,this._holder.options.session,!0),this._state=Ct.COMMITTED},"A query is still in progress after transaction block has returned.")}async _rollback(){await this._runOp("rollback",async()=>{await this._rawConn.fetch("ROLLBACK",void 0,z.OutputFormat.NONE,z.Cardinality.NO_RESULT,this._holder.options.session,!0),this._state=Ct.ROLLEDBACK},"A query is still in progress after transaction block has returned.")}async execute(e,t){return this._runOp("execute",()=>this._rawConn.fetch(e,t,z.OutputFormat.NONE,z.Cardinality.NO_RESULT,this._holder.options.session))}async query(e,t){return this._runOp("query",()=>this._rawConn.fetch(e,t,z.OutputFormat.BINARY,z.Cardinality.MANY,this._holder.options.session))}async queryJSON(e,t){return this._runOp("queryJSON",()=>this._rawConn.fetch(e,t,z.OutputFormat.JSON,z.Cardinality.MANY,this._holder.options.session))}async querySingle(e,t){return this._runOp("querySingle",()=>this._rawConn.fetch(e,t,z.OutputFormat.BINARY,z.Cardinality.AT_MOST_ONE,this._holder.options.session))}async querySingleJSON(e,t){return this._runOp("querySingleJSON",()=>this._rawConn.fetch(e,t,z.OutputFormat.JSON,z.Cardinality.AT_MOST_ONE,this._holder.options.session))}async queryRequiredSingle(e,t){return this._runOp("queryRequiredSingle",()=>this._rawConn.fetch(e,t,z.OutputFormat.BINARY,z.Cardinality.ONE,this._holder.options.session))}async queryRequiredSingleJSON(e,t){return this._runOp("queryRequiredSingleJSON",()=>this._rawConn.fetch(e,t,z.OutputFormat.JSON,z.Cardinality.ONE,this._holder.options.session))}};Me.Transaction=ro});var ao=w(fe=>{"use strict";var hf=fe&&fe.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),gf=fe&&fe.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),pf=fe&&fe.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&hf(e,r,t);return gf(e,r),e},bf=fe&&fe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(fe,"__esModule",{value:!0});fe.Client=fe.BaseClientPool=fe.ClientConnectionHolder=void 0;var _f=Ka(),de=pf(T()),ye=Tt(),wf=ut(),no=bf(Cr()),yf=$u(),mf=Ru(),vf=Fu(),ku=Kt(),Ln=class{constructor(e){Object.defineProperty(this,"_pool",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_connection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inUse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._pool=e,this._connection=null,this._options=null,this._inUse=null}get options(){var e;return(e=this._options)!==null&&e!==void 0?e:wf.Options.defaults()}async _getConnection(){return(!this._connection||this._connection.isClosed())&&(this._connection=await this._pool.getNewConnection()),this._connection}get connectionOpen(){return this._connection!==null&&!this._connection.isClosed()}async acquire(e){if(this._inUse)throw new de.InternalClientError("ClientConnectionHolder cannot be acquired, already in use");return this._options=e,this._inUse=new no.default,this}async release(){var e;if(this._inUse===null)throw new de.ClientError("ClientConnectionHolder.release() called on a free connection holder");this._options=null,await((e=this._connection)===null||e===void 0?void 0:e.resetState()),this._inUse.done||this._inUse.set(),this._inUse=null,this._pool.enqueue(this)}async _waitUntilReleasedAndClose(){var e;this._inUse&&await this._inUse.wait(),await((e=this._connection)===null||e===void 0?void 0:e.close())}terminate(){var e;(e=this._connection)===null||e===void 0||e.close()}async transaction(e){let t;for(let n=0;;++n){let i=await vf.Transaction._startTransaction(this),s=!1;try{t=await Promise.race([e(i),i._waitForConnAbort()]);try{await i._commit()}catch(a){throw s=!0,a}}catch(a){try{s||await i._rollback()}catch(o){if(!(o instanceof de.EdgeDBError))throw o}if(a instanceof de.EdgeDBError&&a.hasTag(de.SHOULD_RETRY)&&!(s&&a instanceof de.ClientConnectionError)){let o=this.options.retryOptions.getRuleForException(a);if(n+1>=o.attempts)throw a;await(0,ku.sleep)(o.backoff(n+1));continue}throw a}return t}}async retryingFetch(e,t,n,i){let s;for(let a=0;;++a){let o=await this._getConnection();try{s=await o.fetch(e,t,n,i,this.options.session)}catch(u){if(u instanceof de.EdgeDBError&&u.hasTag(de.SHOULD_RETRY)&&(o.getQueryCapabilities(e,n,i)===0||u instanceof de.TransactionConflictError)){let c=this.options.retryOptions.getRuleForException(u);if(a+1>=c.attempts)throw u;await(0,ku.sleep)(c.backoff(a+1));continue}throw u}return s}}async execute(e,t){return this.retryingFetch(e,t,ye.OutputFormat.NONE,ye.Cardinality.NO_RESULT)}async query(e,t){return this.retryingFetch(e,t,ye.OutputFormat.BINARY,ye.Cardinality.MANY)}async queryJSON(e,t){return this.retryingFetch(e,t,ye.OutputFormat.JSON,ye.Cardinality.MANY)}async querySingle(e,t){return this.retryingFetch(e,t,ye.OutputFormat.BINARY,ye.Cardinality.AT_MOST_ONE)}async querySingleJSON(e,t){return this.retryingFetch(e,t,ye.OutputFormat.JSON,ye.Cardinality.AT_MOST_ONE)}async queryRequiredSingle(e,t){return this.retryingFetch(e,t,ye.OutputFormat.BINARY,ye.Cardinality.ONE)}async queryRequiredSingleJSON(e,t){return this.retryingFetch(e,t,ye.OutputFormat.JSON,ye.Cardinality.ONE)}};fe.ClientConnectionHolder=Ln;var io=class{constructor(e,t){var n;Object.defineProperty(this,"_parseConnectArguments",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"_closing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_holders",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_userConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_suggestedConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_connectConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_codecsRegistry",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__normalizedConnectConfig",{enumerable:!0,configurable:!0,writable:!0,value:null}),this.validateClientOptions(t),this._codecsRegistry=new _f.CodecsRegistry,this._queue=new yf.LifoQueue,this._holders=[],this._userConcurrency=(n=t.concurrency)!==null&&n!==void 0?n:null,this._suggestedConcurrency=null,this._closing=null,this._connectConfig={...t},this._resizeHolderPool()}validateClientOptions(e){if(e.concurrency!=null&&(typeof e.concurrency!="number"||!Number.isInteger(e.concurrency)||e.concurrency<0))throw new de.InterfaceError(`invalid 'concurrency' value: expected integer greater than 0 (got ${JSON.stringify(e.concurrency)})`)}_getStats(){return{queueLength:this._queue.pending,openConnections:this._holders.filter(e=>e.connectionOpen).length}}async ensureConnected(){if(this._closing)throw new de.InterfaceError(this._closing.done?"The client is closed":"The client is closing");if(this._getStats().openConnections>0)return;let e=await this._queue.get();try{await e._getConnection()}finally{this._queue.push(e)}}get _concurrency(){var e,t;return(t=(e=this._userConcurrency)!==null&&e!==void 0?e:this._suggestedConcurrency)!==null&&t!==void 0?t:1}_resizeHolderPool(){let e=this._concurrency-this._holders.length;if(e>0)for(let t=0;t<e;t++){let n=new Ln(this);this._holders.push(n),this._queue.push(n)}else e<0}_getNormalizedConnectConfig(){var e;return(e=this.__normalizedConnectConfig)!==null&&e!==void 0?e:this.__normalizedConnectConfig=this._parseConnectArguments(this._connectConfig)}async getNewConnection(){var e;if(!((e=this._closing)===null||e===void 0)&&e.done)throw new de.InterfaceError("The client is closed");let t=await this._getNormalizedConnectConfig(),n=await(0,mf.retryingConnect)(this._connectWithTimeout,t,this._codecsRegistry),i=n.serverSettings.suggested_pool_concurrency;return i&&i!==this._suggestedConcurrency&&(this._suggestedConcurrency=i,this._resizeHolderPool()),n}async acquireHolder(e){if(this._closing)throw new de.InterfaceError(this._closing.done?"The client is closed":"The client is closing");let t=await this._queue.get();try{return await t.acquire(e)}catch(n){throw this._queue.push(t),n}}enqueue(e){this._queue.push(e)}async close(){if(this._closing)return await this._closing.wait();this._closing=new no.default,this._queue.cancelAllPending(new de.InterfaceError("The client is closing"));let e=setTimeout(()=>{console.warn("Client.close() is taking over 60 seconds to complete. Check if you have any unreleased connections left.")},6e4);try{await Promise.all(this._holders.map(t=>t._waitUntilReleasedAndClose()))}catch(t){throw this._terminate(),this._closing.setError(t),t}finally{clearTimeout(e)}this._closing.set()}_terminate(){for(let e of this._holders)e.terminate()}terminate(){var e;!((e=this._closing)===null||e===void 0)&&e.done||(this._queue.cancelAllPending(new de.InterfaceError("The client is closed")),this._terminate(),this._closing||(this._closing=new no.default,this._closing.set()))}isClosed(){return!!this._closing}};fe.BaseClientPool=io;var so=class r{constructor(e,t){Object.defineProperty(this,"pool",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pool=e,this.options=t}withTransactionOptions(e){return new r(this.pool,this.options.withTransactionOptions(e))}withRetryOptions(e){return new r(this.pool,this.options.withRetryOptions(e))}withSession(e){return new r(this.pool,this.options.withSession(e))}withModuleAliases(e){return new r(this.pool,this.options.withSession(this.options.session.withModuleAliases(e)))}withConfig(e){let t=this.options.session.withConfig(e);return new r(this.pool,this.options.withSession(t))}withGlobals(e){return new r(this.pool,this.options.withSession(this.options.session.withGlobals(e)))}async ensureConnected(){return await this.pool.ensureConnected(),this}isClosed(){return this.pool.isClosed()}async close(){await this.pool.close()}terminate(){this.pool.terminate()}async transaction(e){if(this.pool.isStateless)throw new de.EdgeDBError("cannot use 'transaction()' API on HTTP client");let t=await this.pool.acquireHolder(this.options);try{return await t.transaction(e)}finally{await t.release()}}async execute(e,t){let n=await this.pool.acquireHolder(this.options);try{return await n.execute(e,t)}finally{await n.release()}}async query(e,t){let n=await this.pool.acquireHolder(this.options);try{return await n.query(e,t)}finally{await n.release()}}async queryJSON(e,t){let n=await this.pool.acquireHolder(this.options);try{return await n.queryJSON(e,t)}finally{await n.release()}}async querySingle(e,t){let n=await this.pool.acquireHolder(this.options);try{return await n.querySingle(e,t)}finally{await n.release()}}async querySingleJSON(e,t){let n=await this.pool.acquireHolder(this.options);try{return await n.querySingleJSON(e,t)}finally{await n.release()}}async queryRequiredSingle(e,t){let n=await this.pool.acquireHolder(this.options);try{return await n.queryRequiredSingle(e,t)}finally{await n.release()}}async queryRequiredSingleJSON(e,t){let n=await this.pool.acquireHolder(this.options);try{return await n.queryRequiredSingleJSON(e,t)}finally{await n.release()}}};fe.Client=so});var Yu=w(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.validateCredentials=ct.readCredentialsFile=ct.getCredentialsPath=void 0;var Hu=xn(),Pe=T();async function Ef(r,e){return e.searchConfigDir("credentials",r+".json")}ct.getCredentialsPath=Ef;async function Of(r,e){try{let t=await e.readFileUtf8(r);return Wu(JSON.parse(t))}catch(t){throw new Pe.InterfaceError(`cannot read credentials file ${r}: ${t}`)}}ct.readCredentialsFile=Of;function Wu(r){let e=r.port;if(e!=null&&(typeof e!="number"||e<1||e>65535))throw new Pe.InterfaceError("invalid `port` value");let t=r.user;if(t==null)throw new Pe.InterfaceError("`user` key is required");if(typeof t!="string")throw new Pe.InterfaceError("`user` must be string");let n={user:t,port:e},i=r.host;if(i!=null){if(typeof i!="string")throw new Pe.InterfaceError("`host` must be string");n.host=i}let s=r.database;if(s!=null){if(typeof s!="string")throw new Pe.InterfaceError("`database` must be string");n.database=s}let a=r.password;if(a!=null){if(typeof a!="string")throw new Pe.InterfaceError("`password` must be string");n.password=a}let o=r.tls_ca;if(o!=null){if(typeof o!="string")throw new Pe.InterfaceError("`tls_ca` must be string");n.tlsCAData=o}let u=r.tls_cert_data;if(u!=null){if(typeof u!="string")throw new Pe.InterfaceError("`tls_cert_data` must be string");if(o!=null&&u!==o)throw new Pe.InterfaceError("both 'tls_ca' and 'tls_cert_data' are defined, and are not in agreement");n.tlsCAData=u}let c=r.tls_verify_hostname,d=r.tls_security;if(c!=null)if(typeof c=="boolean")c=c?"strict":"no_host_verification";else throw new Pe.InterfaceError("`tls_verify_hostname` must be boolean");if(d!=null&&(typeof d!="string"||!Hu.validTlsSecurityValues.includes(d)))throw new Pe.InterfaceError(`\`tls_security\` must be one of ${Hu.validTlsSecurityValues.map(h=>`"${h}"`).join(", ")}`);if(c&&d&&c!==d&&!(c==="no_host_verification"&&d==="insecure"))throw new Pe.InterfaceError("both 'tls_security' and 'tls_verify_hostname' are defined, and are not in agreement");return(d||c)&&(n.tlsSecurity=d??c),n}ct.validateCredentials=Wu});var lo=w(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.getEnv=he.HMAC=he.H=he.randomBytes=void 0;var oo;he.randomBytes=oo;var uo;he.H=uo;var co;he.HMAC=co;if(typeof crypto>"u"){let r=require("crypto");he.randomBytes=oo=e=>new Promise((t,n)=>{r.randomBytes(e,(i,s)=>{i?n(i):t(s)})}),he.H=uo=async e=>{let t=r.createHash("sha256");return t.update(e),t.digest()},he.HMAC=co=async(e,t)=>{let n=r.createHmac("sha256",e);return n.update(t),n.digest()}}else he.randomBytes=oo=async r=>crypto.getRandomValues(new Uint8Array(r)),he.H=uo=async r=>new Uint8Array(await crypto.subtle.digest("SHA-256",r)),he.HMAC=co=async(r,e)=>new Uint8Array(await crypto.subtle.sign("HMAC",await crypto.subtle.importKey("raw",r,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),e));function Cf(r,e=!1){return process.env[r]}he.getEnv=Cf});var Gu=w($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.crcHqx=void 0;var Sf=new Uint16Array([0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920]);function If(r,e){e&=65535;let t=r.length,n=0;for(;n<t;)e=e<<8&65280^Sf[e>>8^r[n++]];return e}$n.crcHqx=If});var xn=w(ie=>{"use strict";var Mf=ie&&ie.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Pf=ie&&ie.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Tf=ie&&ie.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Mf(e,r,t);return Pf(e,r),e};Object.defineProperty(ie,"__esModule",{value:!0});ie.parseDuration=ie.ResolvedConnectConfig=ie.getConnectArgumentsParser=ie.validTlsSecurityValues=void 0;var qn=Tf(T()),fo=Yu(),ue=lo(),ho=hn(),Df=pn(),x=T(),po=Y(),Af=Gu(),Vu=63;ie.validTlsSecurityValues=["insecure","no_host_verification","strict","default"];function Nf(r){return async e=>{var t;return{...await jf(e,r),connectTimeout:e.timeout,logging:(t=e.logging)!==null&&t!==void 0?t:!0}}}ie.getConnectArgumentsParser=Nf;var Rn=class{constructor(){Object.defineProperty(this,"_host",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_hostSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_port",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_portSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_database",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_databaseSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_user",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_userSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_password",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_passwordSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_secretKey",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_secretKeySource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_cloudProfile",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_cloudProfileSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tlsCAData",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tlsCADataSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tlsSecurity",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tlsSecuritySource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_waitUntilAvailable",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_waitUntilAvailableSource",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"serverSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this.setHost=this.setHost.bind(this),this.setPort=this.setPort.bind(this),this.setDatabase=this.setDatabase.bind(this),this.setUser=this.setUser.bind(this),this.setPassword=this.setPassword.bind(this),this.setSecretKey=this.setSecretKey.bind(this),this.setTlsCAData=this.setTlsCAData.bind(this),this.setTlsCAFile=this.setTlsCAFile.bind(this),this.setTlsSecurity=this.setTlsSecurity.bind(this),this.setWaitUntilAvailable=this.setWaitUntilAvailable.bind(this)}_setParam(e,t,n,i){return this[`_${e}`]===null&&(this[`_${e}Source`]=n,t!==null)?(this[`_${e}`]=i?i(t):t,!0):!1}async _setParamAsync(e,t,n,i){return this[`_${e}`]===null&&(this[`_${e}Source`]=n,t!==null)?(this[`_${e}`]=i?await i(t):t,!0):!1}setHost(e,t){return this._setParam("host",e,t,Ju)}setPort(e,t){return this._setParam("port",e,t,Bf)}setDatabase(e,t){return this._setParam("database",e,t,n=>{if(n==="")throw new x.InterfaceError(`invalid database name: '${n}'`);return n})}setUser(e,t){return this._setParam("user",e,t,n=>{if(n==="")throw new x.InterfaceError(`invalid user name: '${n}'`);return n})}setPassword(e,t){return this._setParam("password",e,t)}setSecretKey(e,t){return this._setParam("secretKey",e,t)}setCloudProfile(e,t){return this._setParam("cloudProfile",e,t)}setTlsCAData(e,t){return this._setParam("tlsCAData",e,t)}setTlsCAFile(e,t,n){return this._setParamAsync("tlsCAData",e,t,i=>n(i))}setTlsSecurity(e,t){return this._setParam("tlsSecurity",e,t,n=>{if(!ie.validTlsSecurityValues.includes(n))throw new x.InterfaceError(`invalid 'tlsSecurity' value: '${n}', must be one of ${ie.validTlsSecurityValues.map(s=>`'${s}'`).join(", ")}`);let i=(0,ue.getEnv)("EDGEDB_CLIENT_SECURITY");if(i!==void 0){if(!["default","insecure_dev_mode","strict"].includes(i))throw new x.InterfaceError(`invalid EDGEDB_CLIENT_SECURITY value: '${i}', must be one of 'default', 'insecure_dev_mode' or 'strict'`);if(i==="insecure_dev_mode")n==="default"&&(n="insecure");else if(i==="strict"){if(n==="insecure"||n==="no_host_verification")throw new x.InterfaceError(`'tlsSecurity' value (${n}) conflicts with EDGEDB_CLIENT_SECURITY value (${i}), 'tlsSecurity' value cannot be lower than security level set by EDGEDB_CLIENT_SECURITY`);n="strict"}}return n})}setWaitUntilAvailable(e,t){return this._setParam("waitUntilAvailable",e,t,Ku)}addServerSettings(e){this.serverSettings={...e,...this.serverSettings}}get address(){var e,t;return[(e=this._host)!==null&&e!==void 0?e:"localhost",(t=this._port)!==null&&t!==void 0?t:5656]}get database(){var e;return(e=this._database)!==null&&e!==void 0?e:"edgedb"}get user(){var e;return(e=this._user)!==null&&e!==void 0?e:"edgedb"}get password(){var e;return(e=this._password)!==null&&e!==void 0?e:void 0}get secretKey(){var e;return(e=this._secretKey)!==null&&e!==void 0?e:void 0}get cloudProfile(){var e;return(e=this._cloudProfile)!==null&&e!==void 0?e:"default"}get tlsSecurity(){return this._tlsSecurity&&this._tlsSecurity!=="default"?this._tlsSecurity:this._tlsCAData!==null?"no_host_verification":"strict"}get waitUntilAvailable(){var e;return(e=this._waitUntilAvailable)!==null&&e!==void 0?e:3e4}explainConfig(){let e=["Parameter          Value                                    Source","---------          -----                                    ------"],t=(n,i,s,a)=>{var o;let u=s===null,c=40-(u?10:0),d=String(i);d.length>c&&(d=d.slice(0,c-3)+"..."),e.push((o=n.padEnd(19," ")+(d+(u?" (default)":"")).padEnd(42," ")+a)!==null&&o!==void 0?o:"default")};return t("host",this.address[0],this._host,this._hostSource),t("port",this.address[1],this._port,this._portSource),t("database",this.database,this._database,this._databaseSource),t("user",this.user,this._user,this._userSource),t("password",this.password&&this.password.slice(0,3).padEnd(this.password.length,"*"),this._password,this._passwordSource),t("tlsCAData",this._tlsCAData&&this._tlsCAData.replace(/\r\n?|\n/,""),this._tlsCAData,this._tlsCADataSource),t("tlsSecurity",this.tlsSecurity,this._tlsSecurity,this._tlsSecuritySource),t("waitUntilAvailable",this.waitUntilAvailable,this._waitUntilAvailable,this._waitUntilAvailableSource),e.join(`
`)}};ie.ResolvedConnectConfig=Rn;function Bf(r){let e;if(typeof r=="string"){if(!/^\d*$/.test(r))throw new x.InterfaceError(`invalid port: ${r}`);if(e=parseInt(r,10),Number.isNaN(e))throw new x.InterfaceError(`invalid port: ${r}`)}else e=r;if(!Number.isInteger(e)||e<1||e>65535)throw new x.InterfaceError(`invalid port: ${r}`);return e}function Ju(r){if(r.includes("/"))throw new x.InterfaceError("unix socket paths not supported");if(!r.length||r.includes(","))throw new x.InterfaceError(`invalid host: '${r}'`);return r}function Ku(r){if(typeof r=="number"){if(r<0)throw new x.InterfaceError("invalid waitUntilAvailable duration, must be >= 0");return r}if(typeof r=="string")if(r.startsWith("P"))r=ho.Duration.from(r);else return(0,ho.parseHumanDurationString)(r);if(r instanceof ho.Duration){let e=(0,Df.checkValidEdgeDBDuration)(r);if(e)throw new x.InterfaceError(`invalid waitUntilAvailable duration, cannot have a '${e}' value`);if(r.sign<0)throw new x.InterfaceError("invalid waitUntilAvailable duration, must be >= 0");return r.milliseconds+r.seconds*1e3+r.minutes*6e4+r.hours*36e5}throw new x.InterfaceError("invalid duration")}ie.parseDuration=Ku;async function jf(r,e){let t=new Rn,n=!1,i=!1,[s,a]=r.instanceName==null&&r.dsn!=null&&!/^[a-z]+:\/\//i.test(r.dsn)?[void 0,r.dsn]:[r.dsn,r.instanceName],{hasCompoundOptions:o}=await go(t,{dsn:s,instanceName:a,credentials:r.credentials,credentialsFile:r.credentialsFile,host:r.host,port:r.port,database:r.database,user:r.user,password:r.password,secretKey:r.secretKey,tlsCA:r.tlsCA,tlsCAFile:r.tlsCAFile,tlsSecurity:r.tlsSecurity,serverSettings:r.serverSettings,waitUntilAvailable:r.waitUntilAvailable},{dsn:"'dsnOrInstanceName' option (parsed as dsn)",instanceName:r.instanceName!=null?"'instanceName' option":"'dsnOrInstanceName' option (parsed as instance name)",credentials:"'credentials' option",credentialsFile:"'credentialsFile' option",host:"'host' option",port:"'port' option",database:"'database' option",user:"'user' option",password:"'password' option",secretKey:"'secretKey' option",tlsCA:"'tlsCA' option",tlsCAFile:"'tlsCAFile' option",tlsSecurity:"'tlsSecurity' option",serverSettings:"'serverSettings' option",waitUntilAvailable:"'waitUntilAvailable' option"},"Cannot have more than one of the following connection options: 'dsn', 'instanceName', 'credentials', 'credentialsFile' or 'host'/'port'",e);if(!o){let u=(0,ue.getEnv)("EDGEDB_PORT");t._port===null&&u?.startsWith("tcp://")&&(console.warn("EDGEDB_PORT in 'tcp://host:port' format, so will be ignored"),u=void 0),{hasCompoundOptions:o,anyOptionsUsed:n}=await go(t,{dsn:(0,ue.getEnv)("EDGEDB_DSN"),instanceName:(0,ue.getEnv)("EDGEDB_INSTANCE"),credentials:(0,ue.getEnv)("EDGEDB_CREDENTIALS"),credentialsFile:(0,ue.getEnv)("EDGEDB_CREDENTIALS_FILE"),host:(0,ue.getEnv)("EDGEDB_HOST"),port:u,database:(0,ue.getEnv)("EDGEDB_DATABASE"),user:(0,ue.getEnv)("EDGEDB_USER"),password:(0,ue.getEnv)("EDGEDB_PASSWORD"),secretKey:(0,ue.getEnv)("EDGEDB_SECRET_KEY"),cloudProfile:(0,ue.getEnv)("EDGEDB_CLOUD_PROFILE"),tlsCA:(0,ue.getEnv)("EDGEDB_TLS_CA"),tlsCAFile:(0,ue.getEnv)("EDGEDB_TLS_CA_FILE"),tlsSecurity:(0,ue.getEnv)("EDGEDB_CLIENT_TLS_SECURITY"),waitUntilAvailable:(0,ue.getEnv)("EDGEDB_WAIT_UNTIL_AVAILABLE")},{dsn:"'EDGEDB_DSN' environment variable",instanceName:"'EDGEDB_INSTANCE' environment variable",credentials:"'EDGEDB_CREDENTIALS' environment variable",credentialsFile:"'EDGEDB_CREDENTIALS_FILE' environment variable",host:"'EDGEDB_HOST' environment variable",port:"'EDGEDB_PORT' environment variable",database:"'EDGEDB_DATABASE' environment variable",user:"'EDGEDB_USER' environment variable",password:"'EDGEDB_PASSWORD' environment variable",secretKey:"'EDGEDB_SECRET_KEY' environment variable",cloudProfile:"'EDGEDB_CLOUD_PROFILE' environment variable",tlsCA:"'EDGEDB_TLS_CA' environment variable",tlsCAFile:"'EDGEDB_TLS_CA_FILE' environment variable",tlsSecurity:"'EDGEDB_CLIENT_TLS_SECURITY' environment variable",waitUntilAvailable:"'EDGEDB_WAIT_UNTIL_AVAILABLE' environment variable"},"Cannot have more than one of the following connection environment variables: 'EDGEDB_DSN', 'EDGEDB_INSTANCE', 'EDGEDB_CREDENTIALS', 'EDGEDB_CREDENTIALS_FILE' or 'EDGEDB_HOST'",e)}if(!o){if(!e)throw new qn.ClientConnectionError("no connection options specified either by arguments to `createClient` API or environment variables; also cannot resolve from edgedb.toml in browser (or edge runtime) environment");let u=await e?.findProjectDir();if(!u)throw new qn.ClientConnectionError("no 'edgedb.toml' found and no connection options specified either via arguments to `createClient()` API or via environment variables EDGEDB_HOST, EDGEDB_INSTANCE, EDGEDB_DSN, EDGEDB_CREDENTIALS or EDGEDB_CREDENTIALS_FILE");let c=await e.findStashPath(u),d=await e.readFileUtf8(c,"instance-name").then(h=>h.trim()).catch(()=>null);if(d!==null){let[h,_]=await Promise.all([e.readFileUtf8(c,"cloud-profile").then(f=>f.trim()).catch(()=>{}),e.readFileUtf8(c,"database").then(f=>f.trim()).catch(()=>{})]);await go(t,{instanceName:d,cloudProfile:h,database:_},{instanceName:`project linked instance ('${d}')`,cloudProfile:`project defined cloud instance ('${h}')`,database:"project default database"},"",e),i=!0}else throw new qn.ClientConnectionError("Found 'edgedb.toml' but the project is not initialized. Run `edgedb project init`.")}return t.setTlsSecurity("default","default"),{connectionParams:t,inProject:async()=>await e?.findProjectDir(!1)!=null,fromEnv:n,fromProject:i}}async function go(r,e,t,n,i){var s,a,o,u,c,d,h,_,f,p,m,O,C,S,N,k,D,Oe,se,Ce;let y=!1,Ae=(s=i?.readFileUtf8)!==null&&s!==void 0?s:ae=>{throw new x.InterfaceError(`cannot read file "${ae}" in browser (or edge runtime) environment`)};if(e.tlsCA!=null&&e.tlsCAFile!=null)throw new x.InterfaceError(`Cannot specify both ${t.tlsCA} and ${t.tlsCAFile}`);y=r.setDatabase((a=e.database)!==null&&a!==void 0?a:null,t.database)||y,y=r.setUser((o=e.user)!==null&&o!==void 0?o:null,t.user)||y,y=r.setPassword((u=e.password)!==null&&u!==void 0?u:null,t.password)||y,y=r.setSecretKey((c=e.secretKey)!==null&&c!==void 0?c:null,t.secretKey)||y,y=r.setCloudProfile((d=e.cloudProfile)!==null&&d!==void 0?d:null,t.cloudProfile)||y,y=r.setTlsCAData((h=e.tlsCA)!==null&&h!==void 0?h:null,t.tlsCA)||y,y=await r.setTlsCAFile((_=e.tlsCAFile)!==null&&_!==void 0?_:null,t.tlsCAFile,Ae)||y,y=r.setTlsSecurity((f=e.tlsSecurity)!==null&&f!==void 0?f:null,t.tlsSecurity)||y,y=r.setWaitUntilAvailable((p=e.waitUntilAvailable)!==null&&p!==void 0?p:null,t.waitUntilAvailable)||y,r.addServerSettings((m=e.serverSettings)!==null&&m!==void 0?m:{});let Ne=[e.dsn,e.instanceName,e.credentials,e.credentialsFile,(O=e.host)!==null&&O!==void 0?O:e.port].filter(ae=>ae!==void 0).length;if(Ne>1)throw new x.InterfaceError(n);if(Ne===1){if(e.dsn!==void 0||e.host!==void 0||e.port!==void 0){let ae=e.dsn;if(ae===void 0){e.port!==void 0&&r.setPort(e.port,t.port);let _e=e.host!=null?Ju(e.host):"";ae=`edgedb://${_e.includes(":")?`[${encodeURI(_e)}]`:_e}`}await Uf(ae,r,e.dsn?t.dsn:e.host!==void 0?t.host:t.port,Ae)}else{let ae,_e;if(e.credentials!=null)ae=(0,fo.validateCredentials)(JSON.parse(e.credentials)),_e=t.credentials;else{if(!i&&!(!((C=e.instanceName)===null||C===void 0)&&C.includes("/")))throw new x.InterfaceError(`cannot ${e.credentialsFile?`read credentials file "${e.credentialsFile}"`:`resolve instance name "${e.instanceName}"`} in browser (or edge runtime) environment`);let ci=e.credentialsFile;if(ci===void 0)if(/^\w(-?\w)*$/.test(e.instanceName))ci=await(0,fo.getCredentialsPath)(e.instanceName,i),_e=t.instanceName;else{if(!/^([A-Za-z0-9](-?[A-Za-z0-9])*)\/([A-Za-z0-9](-?[A-Za-z0-9])*)$/.test(e.instanceName))throw new x.InterfaceError(`invalid DSN or instance name: '${e.instanceName}'`);return await Lf(r,e.instanceName,t.instanceName,i),{hasCompoundOptions:!0,anyOptionsUsed:!0}}else _e=t.credentialsFile;ae=await(0,fo.readCredentialsFile)(ci,i)}r.setHost((S=ae.host)!==null&&S!==void 0?S:null,_e),r.setPort((N=ae.port)!==null&&N!==void 0?N:null,_e),r.setDatabase((k=ae.database)!==null&&k!==void 0?k:null,_e),r.setUser((D=ae.user)!==null&&D!==void 0?D:null,_e),r.setPassword((Oe=ae.password)!==null&&Oe!==void 0?Oe:null,_e),r.setTlsCAData((se=ae.tlsCAData)!==null&&se!==void 0?se:null,_e),r.setTlsSecurity((Ce=ae.tlsSecurity)!==null&&Ce!==void 0?Ce:null,_e)}return{hasCompoundOptions:!0,anyOptionsUsed:!0}}return{hasCompoundOptions:!1,anyOptionsUsed:y}}async function Uf(r,e,t,n){let i=r,s=null,a="",o=/\[(.*?)(%25.+?)\]/.exec(r);o&&(s=o[1],a=decodeURI(o[2]),i=i.slice(0,o.index+s.length+1)+i.slice(o.index+s.length+o[2].length+1));let u;try{if(u=new URL(i),s!==null&&u.hostname!==`[${s}]`)throw new Error}catch{throw new x.InterfaceError(`invalid DSN or instance name: '${r}'`)}if(u.protocol!=="edgedb:")throw new x.InterfaceError(`invalid DSN: scheme is expected to be 'edgedb', got '${u.protocol.slice(0,-1)}'`);let c=new Map;for(let[p,m]of u.searchParams){if(c.has(p))throw new x.InterfaceError(`invalid DSN: duplicate query parameter '${p}'`);c.set(p,m)}async function d(p,m,O,C,S=N=>N){var N,k;if([m||null,c.get(p),c.get(`${p}_env`),c.get(`${p}_file`)].filter(D=>D!=null).length>1)throw new x.InterfaceError(`invalid DSN: more than one of ${m!==null?`'${p}', `:""}'?${p}=', '?${p}_env=' or '?${p}_file=' was specified ${i}`);if(O===null){let D=m||((N=c.get(p))!==null&&N!==void 0?N:null),Oe=t;if(D===null){let se=c.get(`${p}_env`);if(se!=null){if(D=(k=(0,ue.getEnv)(se,!0))!==null&&k!==void 0?k:null,D===null)throw new x.InterfaceError(`'${p}_env' environment variable '${se}' doesn't exist`);Oe+=` (${p}_env: ${se})`}}if(D===null){let se=c.get(`${p}_file`);se!=null&&(D=await n(se),Oe+=` (${p}_file: ${se})`)}D=D!==null?S(D):null,await C(D,Oe)}c.delete(p),c.delete(`${p}_env`),c.delete(`${p}_file`)}let h=/^\[.*\]$/.test(u.hostname)?u.hostname.slice(1,-1)+a:u.hostname;await d("host",h,e._host,e.setHost),await d("port",u.port,e._port,e.setPort);let _=p=>p.replace(/^\//,"");await d("database",_(u.pathname),e._database,e.setDatabase,_),await d("user",u.username,e._user,e.setUser),await d("password",u.password,e._password,e.setPassword),await d("secret_key",null,e._secretKey,e.setSecretKey),await d("tls_ca",null,e._tlsCAData,e.setTlsCAData),await d("tls_ca_file",null,e._tlsCAData,(p,m)=>e.setTlsCAFile(p,m,n)),await d("tls_security",null,e._tlsSecurity,e.setTlsSecurity),await d("wait_until_available",null,e._waitUntilAvailable,e.setWaitUntilAvailable);let f={};for(let[p,m]of c)f[p]=m;e.addServerSettings(f)}async function Lf(r,e,t,n){let i=e.toLowerCase(),[s,a]=i.split("/"),o=`${a}--${s}`;if(o.length>Vu)throw new x.InterfaceError(`invalid instance name: cloud instance name length cannot exceed ${Vu-1} characters: ${e}`);let u=r.secretKey;if(u==null)try{if(!n)throw new x.InterfaceError("Cannot get secret key from cloud profile in browser (or edge runtime) environment");let c=r.cloudProfile,d=await n.searchConfigDir("cloud-credentials",`${c}.json`),h=await n.readFileUtf8(d);if(u=JSON.parse(h).secret_key,!u)throw new x.InterfaceError(`Cloud profile '${c}' doesn't contain a secret key`);r.setSecretKey(u,`cloud-credentials/${c}.json`)}catch(c){throw new x.InterfaceError(`Cannot connect to cloud instances without a secret key: ${c}`)}try{let c=u.split(".");if(c.length<2)throw new x.InterfaceError("Invalid secret key: does not contain payload");let d=xf(c[1]).iss;if(!d)throw new x.InterfaceError("Invalid secret key: payload does not contain 'iss' value");let h=((0,Af.crcHqx)(po.utf8Encoder.encode(i),0)%100).toString(10).padStart(2,"0"),_=`${o}.c-${h}.i.${d}`;r.setHost(_,`resolved from 'secretKey' and ${t}`)}catch(c){throw c instanceof qn.EdgeDBError?c:new x.InterfaceError(`Invalid secret key: ${c}`)}}function xf(r){return JSON.parse(po.utf8Decoder.decode((0,po.decodeB64)(r.padEnd(Math.ceil(r.length/4)*4,"="))))}});var Qu=w(g=>{"use strict";var $f=g&&g.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),qf=g&&g.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Rf=g&&g.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&$f(e,r,t);return qf(e,r),e};Object.defineProperty(g,"__esModule",{value:!0});g.errorMapping=void 0;var b=Rf(T());g.errorMapping=new Map;g.errorMapping.set(16777216,b.InternalServerError);g.errorMapping.set(33554432,b.UnsupportedFeatureError);g.errorMapping.set(50331648,b.ProtocolError);g.errorMapping.set(50397184,b.BinaryProtocolError);g.errorMapping.set(50397185,b.UnsupportedProtocolVersionError);g.errorMapping.set(50397186,b.TypeSpecNotFoundError);g.errorMapping.set(50397187,b.UnexpectedMessageError);g.errorMapping.set(50462720,b.InputDataError);g.errorMapping.set(50462976,b.ParameterTypeMismatchError);g.errorMapping.set(50463232,b.StateMismatchError);g.errorMapping.set(50528256,b.ResultCardinalityMismatchError);g.errorMapping.set(50593792,b.CapabilityError);g.errorMapping.set(50594048,b.UnsupportedCapabilityError);g.errorMapping.set(50594304,b.DisabledCapabilityError);g.errorMapping.set(67108864,b.QueryError);g.errorMapping.set(67174400,b.InvalidSyntaxError);g.errorMapping.set(67174656,b.EdgeQLSyntaxError);g.errorMapping.set(67174912,b.SchemaSyntaxError);g.errorMapping.set(67175168,b.GraphQLSyntaxError);g.errorMapping.set(67239936,b.InvalidTypeError);g.errorMapping.set(67240192,b.InvalidTargetError);g.errorMapping.set(67240193,b.InvalidLinkTargetError);g.errorMapping.set(67240194,b.InvalidPropertyTargetError);g.errorMapping.set(67305472,b.InvalidReferenceError);g.errorMapping.set(67305473,b.UnknownModuleError);g.errorMapping.set(67305474,b.UnknownLinkError);g.errorMapping.set(67305475,b.UnknownPropertyError);g.errorMapping.set(67305476,b.UnknownUserError);g.errorMapping.set(67305477,b.UnknownDatabaseError);g.errorMapping.set(67305478,b.UnknownParameterError);g.errorMapping.set(67371008,b.SchemaError);g.errorMapping.set(67436544,b.SchemaDefinitionError);g.errorMapping.set(67436800,b.InvalidDefinitionError);g.errorMapping.set(67436801,b.InvalidModuleDefinitionError);g.errorMapping.set(67436802,b.InvalidLinkDefinitionError);g.errorMapping.set(67436803,b.InvalidPropertyDefinitionError);g.errorMapping.set(67436804,b.InvalidUserDefinitionError);g.errorMapping.set(67436805,b.InvalidDatabaseDefinitionError);g.errorMapping.set(67436806,b.InvalidOperatorDefinitionError);g.errorMapping.set(67436807,b.InvalidAliasDefinitionError);g.errorMapping.set(67436808,b.InvalidFunctionDefinitionError);g.errorMapping.set(67436809,b.InvalidConstraintDefinitionError);g.errorMapping.set(67436810,b.InvalidCastDefinitionError);g.errorMapping.set(67437056,b.DuplicateDefinitionError);g.errorMapping.set(67437057,b.DuplicateModuleDefinitionError);g.errorMapping.set(67437058,b.DuplicateLinkDefinitionError);g.errorMapping.set(67437059,b.DuplicatePropertyDefinitionError);g.errorMapping.set(67437060,b.DuplicateUserDefinitionError);g.errorMapping.set(67437061,b.DuplicateDatabaseDefinitionError);g.errorMapping.set(67437062,b.DuplicateOperatorDefinitionError);g.errorMapping.set(67437063,b.DuplicateViewDefinitionError);g.errorMapping.set(67437064,b.DuplicateFunctionDefinitionError);g.errorMapping.set(67437065,b.DuplicateConstraintDefinitionError);g.errorMapping.set(67437066,b.DuplicateCastDefinitionError);g.errorMapping.set(67437067,b.DuplicateMigrationError);g.errorMapping.set(67502080,b.SessionTimeoutError);g.errorMapping.set(67502336,b.IdleSessionTimeoutError);g.errorMapping.set(67502592,b.QueryTimeoutError);g.errorMapping.set(67504640,b.TransactionTimeoutError);g.errorMapping.set(67504641,b.IdleTransactionTimeoutError);g.errorMapping.set(83886080,b.ExecutionError);g.errorMapping.set(83951616,b.InvalidValueError);g.errorMapping.set(83951617,b.DivisionByZeroError);g.errorMapping.set(83951618,b.NumericOutOfRangeError);g.errorMapping.set(83951619,b.AccessPolicyError);g.errorMapping.set(83951620,b.QueryAssertionError);g.errorMapping.set(84017152,b.IntegrityError);g.errorMapping.set(84017153,b.ConstraintViolationError);g.errorMapping.set(84017154,b.CardinalityViolationError);g.errorMapping.set(84017155,b.MissingRequiredError);g.errorMapping.set(84082688,b.TransactionError);g.errorMapping.set(84082944,b.TransactionConflictError);g.errorMapping.set(84082945,b.TransactionSerializationError);g.errorMapping.set(84082946,b.TransactionDeadlockError);g.errorMapping.set(84148224,b.WatchError);g.errorMapping.set(100663296,b.ConfigurationError);g.errorMapping.set(117440512,b.AccessError);g.errorMapping.set(117506048,b.AuthenticationError);g.errorMapping.set(134217728,b.AvailabilityError);g.errorMapping.set(134217729,b.BackendUnavailableError);g.errorMapping.set(150994944,b.BackendError);g.errorMapping.set(150995200,b.UnsupportedBackendFeatureError);g.errorMapping.set(4026531840,b.LogMessage);g.errorMapping.set(4026597376,b.WarningMessage);g.errorMapping.set(4278190080,b.ClientError);g.errorMapping.set(4278255616,b.ClientConnectionError);g.errorMapping.set(4278255872,b.ClientConnectionFailedError);g.errorMapping.set(4278255873,b.ClientConnectionFailedTemporarilyError);g.errorMapping.set(4278256128,b.ClientConnectionTimeoutError);g.errorMapping.set(4278256384,b.ClientConnectionClosedError);g.errorMapping.set(4278321152,b.InterfaceError);g.errorMapping.set(4278321408,b.QueryArgumentError);g.errorMapping.set(4278321409,b.MissingArgumentError);g.errorMapping.set(4278321410,b.UnknownArgumentError);g.errorMapping.set(4278321411,b.InvalidArgumentError);g.errorMapping.set(4278386688,b.NoDataError);g.errorMapping.set(4278452224,b.InternalClientError)});var Xu=w(Xe=>{"use strict";var Ff=Xe&&Xe.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),kf=Xe&&Xe.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Hf=Xe&&Xe.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ff(e,r,t);return kf(e,r),e};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.resolveErrorCode=void 0;var Wf=Hf(T()),Fn=Qu();function Yf(r){let e;return e=Fn.errorMapping.get(r),e||(r=r&4294967040,e=Fn.errorMapping.get(r),e)||(r=r&4294901760,e=Fn.errorMapping.get(r),e)||(r=r&4278190080,e=Fn.errorMapping.get(r),e)?e:Wf.EdgeDBError}Xe.resolveErrorCode=Yf});var yo=w(Z=>{"use strict";var Gf=Z&&Z.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Vf=Z&&Z.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),tc=Z&&Z.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Gf(e,r,t);return Vf(e,r),e},rc=Z&&Z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Z,"__esModule",{value:!0});Z.BaseRawConnection=Z.Capabilities=Z.PROTO_VER_MIN=Z.PROTO_VER=void 0;var Te=_n(),Jf=wr(),Kf=Tn(),bo=Jt(),zu=Kt(),te=tc(T()),Qf=Xu(),$=Tt(),De=Y(),M=tc(Pt()),Zu=rc(Cr()),Xf=rc(Rs()),kn=ut();Z.PROTO_VER=[1,0];Z.PROTO_VER_MIN=[0,9];var lt;(function(r){r[r.TRANS_IDLE=0]="TRANS_IDLE",r[r.TRANS_ACTIVE=1]="TRANS_ACTIVE",r[r.TRANS_INTRANS=2]="TRANS_INTRANS",r[r.TRANS_INERROR=3]="TRANS_INERROR",r[r.TRANS_UNKNOWN=4]="TRANS_UNKNOWN"})(lt||(lt={}));var xe;(function(r){r[r.NONE=0]="NONE",r[r.MODIFICATONS=1]="MODIFICATONS",r[r.SESSION_CONFIG=2]="SESSION_CONFIG",r[r.TRANSACTION=4]="TRANSACTION",r[r.DDL=8]="DDL",r[r.PERSISTENT_CONFIG=16]="PERSISTENT_CONFIG",r[r.SET_GLOBAL=32]="SET_GLOBAL",r[r.ALL=4294967295]="ALL"})(xe=Z.Capabilities||(Z.Capabilities={}));var zf=(xe.ALL&~xe.TRANSACTION)>>>0,Sr=new Uint8Array(Array(8).fill(255));new DataView(Sr.buffer).setUint32(4,zf);var _o=(xe.ALL&~xe.TRANSACTION&~xe.SESSION_CONFIG&~xe.SET_GLOBAL)>>>0,ec=(_o|xe.SESSION_CONFIG|xe.SET_GLOBAL)>>>0,Ir;(function(r){r[r.INJECT_OUTPUT_TYPE_IDS=1]="INJECT_OUTPUT_TYPE_IDS",r[r.INJECT_OUTPUT_TYPE_NAMES=2]="INJECT_OUTPUT_TYPE_NAMES",r[r.INJECT_OUTPUT_OBJECT_IDS=4]="INJECT_OUTPUT_OBJECT_IDS"})(Ir||(Ir={}));var Zf=new Map([[84082689,84082945],[84082690,84082946]]),wo=class{constructor(e){Object.defineProperty(this,"connected",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lastStatus",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"codecsRegistry",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queryCodecCache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serverSecret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serverSettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serverXactStatus",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageWaiter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"connWaiter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"connAbortWaiter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_abortedWith",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"protocolVersion",{enumerable:!0,configurable:!0,writable:!0,value:Z.PROTO_VER}),Object.defineProperty(this,"isLegacyProtocol",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"stateCodec",{enumerable:!0,configurable:!0,writable:!0,value:Te.INVALID_CODEC}),Object.defineProperty(this,"stateCache",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"lastStateUpdate",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"adminUIMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.buffer=new De.ReadMessageBuffer,this.codecsRegistry=e,this.queryCodecCache=new Xf.default({capacity:1e3}),this.lastStatus=null,this.serverSecret=null,this.serverSettings={},this.serverXactStatus=lt.TRANS_UNKNOWN,this.messageWaiter=null,this.connWaiter=new Zu.default,this.connAbortWaiter=new Zu.default}throwNotImplemented(e){throw new te.InternalClientError(`method ${e} is not implemented`)}async _waitForMessage(){this.throwNotImplemented("_waitForMessage")}_sendData(e){this.throwNotImplemented("_sendData")}getConnAbortError(){var e;return(e=this._abortedWith)!==null&&e!==void 0?e:new te.InterfaceError("client has been closed")}_checkState(){if(this.isClosed())throw this.getConnAbortError()}_abortWithError(e){this._abortedWith=e,this._abort()}_ignoreHeaders(){let e=this.buffer.readInt16();for(;e;)this.buffer.readInt16(),this.buffer.readLenPrefixedBuffer(),e--}_abortWaiters(e){var t;this.connWaiter.done||this.connWaiter.setError(e),(t=this.messageWaiter)===null||t===void 0||t.setError(e),this.messageWaiter=null}_parseHeaders(){let e=new Map,t=this.buffer.readInt16();for(;t;){let n=this.buffer.readInt16(),i=this.buffer.readLenPrefixedBuffer();e.set(n,i),t--}return e}_parseDescribeTypeMessage(){let e=-1;if(this.isLegacyProtocol){let c=this._parseHeaders();if(c.has($.LegacyHeaderCodes.capabilities)){let d=c.get($.LegacyHeaderCodes.capabilities);e=Number(new DataView(d.buffer,d.byteOffset,d.byteLength).getBigInt64(0))}}else this._ignoreHeaders(),e=Number(this.buffer.readBigInt64());let t=this.buffer.readChar(),n=this.buffer.readUUID(),i=this.buffer.readLenPrefixedBuffer(),s=this.buffer.readUUID(),a=this.buffer.readLenPrefixedBuffer();this.buffer.finishMessage();let o=this.codecsRegistry.getCodec(n);o==null&&(o=this.codecsRegistry.buildCodec(i,this.protocolVersion));let u=this.codecsRegistry.getCodec(s);return u==null&&(u=this.codecsRegistry.buildCodec(a,this.protocolVersion)),[t,o,u,e,i,a]}_parseCommandCompleteMessage(){this._ignoreHeaders();let e;if(this.isLegacyProtocol)e=this.buffer.readString();else{this.buffer.readBigInt64(),e=this.buffer.readString();let t=this.buffer.readUUID(),n=this.buffer.readLenPrefixedBuffer();this.adminUIMode&&t===this.stateCodec.tid&&(this.lastStateUpdate=this.stateCodec.decode(new De.ReadBuffer(n)))}return this.buffer.finishMessage(),e}_parseErrorMessage(){var e;this.buffer.readChar();let t=this.buffer.readUInt32(),n=this.buffer.readString(),i=(0,Qf.resolveErrorCode)((e=Zf.get(t))!==null&&e!==void 0?e:t),s=new i(n);if(s._attrs=this._parseHeaders(),this.buffer.finishMessage(),s instanceof te.AuthenticationError)throw s;return s}_parseSyncMessage(){switch(this._parseHeaders(),this.buffer.readChar()){case M.$I:this.serverXactStatus=lt.TRANS_IDLE;break;case M.$T:this.serverXactStatus=lt.TRANS_INTRANS;break;case M.$E:this.serverXactStatus=lt.TRANS_INERROR;break;default:this.serverXactStatus=lt.TRANS_UNKNOWN}this.buffer.finishMessage()}_parseDataMessages(e,t){let n=De.ReadBuffer.alloc(),i=M.$D,s=this.buffer;if(Array.isArray(t))for(;s.takeMessageType(i);)s.consumeMessageInto(n),n.discard(6),t.push(e.decode(n)),n.finish();else for(;s.takeMessageType(i);){let a=s.consumeMessage();t.writeChar(i),t.writeInt32(a.length+4),t.writeBuffer(a)}}_parseServerSettings(e,t){switch(e){case"suggested_pool_concurrency":{this.serverSettings.suggested_pool_concurrency=parseInt(De.utf8Decoder.decode(t),10);break}case"system_config":{let n=new De.ReadBuffer(t),i=n.readInt32()-16,s=n.readUUID(),a=n.readBuffer(i),o=this.codecsRegistry.getCodec(s);o===null&&(o=this.codecsRegistry.buildCodec(a,this.protocolVersion)),n.discard(4);let u=o.decode(n);n.finish(),this.serverSettings.system_config=u;break}default:this.serverSettings[e]=t;break}}_parseDescribeStateMessage(){let e=this.buffer.readUUID(),t=this.buffer.readBuffer(this.buffer.readInt32()),n=this.codecsRegistry.getCodec(e);n===null&&(n=this.codecsRegistry.buildCodec(t,this.protocolVersion)),this.stateCodec=n,this.stateCache=null,this.buffer.finishMessage()}_fallthrough(){let e=this.buffer.getMessageType();switch(e){case M.$S:{let t=this.buffer.readString(),n=this.buffer.readLenPrefixedBuffer();this._parseServerSettings(t,n),this.buffer.finishMessage();break}case M.$L:{let t=this.buffer.readChar(),n=this.buffer.readUInt32(),i=this.buffer.readString();this._parseHeaders(),this.buffer.finishMessage(),console.info("SERVER MESSAGE",t,n,i);break}default:throw new te.UnexpectedMessageError(`unexpected message type ${e} ("${M.chr(e)}")`)}}async _legacyParse(e,t,n){let i=new De.WriteMessageBuffer,s=(0,zu.versionGreaterThanOrEqual)(this.protocolVersion,[0,14]);i.beginMessage(M.$P).writeLegacyHeaders({explicitObjectids:"true",allowCapabilities:Sr}).writeChar(t).writeChar(n?$.Cardinality.AT_MOST_ONE:$.Cardinality.MANY),i.writeString(""),i.writeString(e),i.endMessage(),i.writeSync(),this._sendData(i.unwrap());let a,o,u,c,d,h=-1,_=!0,f=null,p=null,m=null;for(;_;)switch(this.buffer.takeMessage()||await this._waitForMessage(),this.buffer.getMessageType()){case M.$1:{let C=this._parseHeaders();if(C.has($.LegacyHeaderCodes.capabilities)){let S=C.get($.LegacyHeaderCodes.capabilities);h=Number(new DataView(S.buffer,S.byteOffset,S.byteLength).getBigInt64(0))}a=this.buffer.readChar(),s?(o=this.buffer.readUUID(),p=this.buffer.readLenPrefixedBuffer(),u=this.buffer.readUUID(),m=this.buffer.readLenPrefixedBuffer()):(o=this.buffer.readUUID(),u=this.buffer.readUUID()),this.buffer.finishMessage();break}case M.$E:{f=this._parseErrorMessage(),f._query=e;break}case M.$Z:{this._parseSyncMessage(),_=!1;break}default:this._fallthrough()}if(f!=null)throw f;if(o==null||u==null)throw new te.ProtocolError("did not receive in/out type ids in Parse response");if(c=this.codecsRegistry.getCodec(o),d=this.codecsRegistry.getCodec(u),c==null&&p!=null&&(c=this.codecsRegistry.buildCodec(p,this.protocolVersion)),d==null&&m!=null&&(d=this.codecsRegistry.buildCodec(m,this.protocolVersion)),c==null||d==null||!s){if(s)throw new te.ProtocolError("in/out codecs were not sent");for(i.reset(),i.beginMessage(M.$D).writeInt16(0).writeChar(M.$T).writeString("").endMessage().writeSync(),this._sendData(i.unwrap()),_=!0;_;)switch(this.buffer.takeMessage()||await this._waitForMessage(),this.buffer.getMessageType()){case M.$T:{try{[a,c,d,h,p,m]=this._parseDescribeTypeMessage()}catch(C){f=C}break}case M.$E:{f=this._parseErrorMessage(),f._query=e;break}case M.$Z:{this._parseSyncMessage(),_=!1;break}default:this._fallthrough()}if(f!=null)throw f}if(a==null||d==null||c==null)throw new te.ProtocolError("failed to receive type information in response to a Parse message");return[a,c,d,h,p,m]}_encodeArgs(e,t){if((0,zu.versionGreaterThanOrEqual)(this.protocolVersion,[0,12])){if(t===Te.NULL_CODEC){if(e!=null)throw new te.QueryArgumentError("This query does not contain any query parameters, but query arguments were provided to the 'query*()' method");return Te.NullCodec.BUFFER}if(t instanceof Kf.ObjectCodec)return t.encodeArgs(e);throw new te.ProtocolError("invalid input codec")}else{if(t===bo.EMPTY_TUPLE_CODEC){if(e!=null)throw new te.QueryArgumentError("This query does not contain any query parameters, but query arguments were provided to the 'query*()' method");return bo.EmptyTupleCodec.BUFFER}if(t instanceof Jf.NamedTupleCodec||t instanceof bo.TupleCodec)return t.encodeArgs(e);throw new te.ProtocolError("invalid input codec")}}async _legacyExecuteFlow(e,t,n,i){let s=new De.WriteMessageBuffer;s.beginMessage(M.$E).writeLegacyHeaders({allowCapabilities:Sr}).writeString("").writeBuffer(this._encodeArgs(e,t)).endMessage().writeSync(),this._sendData(s.unwrap());let a=!0,o=null;for(;a;)switch(this.buffer.takeMessage()||await this._waitForMessage(),this.buffer.getMessageType()){case M.$D:{if(o==null)try{this._parseDataMessages(n,i)}catch(c){o=c,this.buffer.finishMessage()}else this.buffer.discardMessage();break}case M.$C:{this.lastStatus=this._parseCommandCompleteMessage();break}case M.$E:{o=this._parseErrorMessage();break}case M.$Z:{this._parseSyncMessage(),a=!1;break}default:this._fallthrough()}if(o!=null)throw o}async _legacyOptimisticExecuteFlow(e,t,n,i,s,a,o){let u=i===$.Cardinality.ONE||i===$.Cardinality.AT_MOST_ONE,c=new De.WriteMessageBuffer;c.beginMessage(M.$O),c.writeLegacyHeaders({explicitObjectids:"true",allowCapabilities:Sr}),c.writeChar(n),c.writeChar(u?$.Cardinality.AT_MOST_ONE:$.Cardinality.MANY),c.writeString(e),c.writeBuffer(s.tidBuffer),c.writeBuffer(a.tidBuffer),c.writeBuffer(this._encodeArgs(t,s)),c.endMessage(),c.writeSync(),this._sendData(c.unwrap());let d=!1,h=null,_=!0,f=null,p=-1;for(;_;)switch(this.buffer.takeMessage()||await this._waitForMessage(),this.buffer.getMessageType()){case M.$D:{if(h==null)try{this._parseDataMessages(a,o)}catch(O){h=O,this.buffer.finishMessage()}else this.buffer.discardMessage();break}case M.$C:{this.lastStatus=this._parseCommandCompleteMessage();break}case M.$Z:{this._parseSyncMessage(),_=!1;break}case M.$T:{try{[f,s,a,p]=this._parseDescribeTypeMessage();let O=this._getQueryCacheKey(e,n,i);this.queryCodecCache.set(O,[f,s,a,p]),d=!0}catch(O){h=O}break}case M.$E:{h=this._parseErrorMessage(),h._query=e;break}default:this._fallthrough()}if(h!=null)throw h;if(d)return this._validateFetchCardinality(f,n,i),await this._legacyExecuteFlow(t,s,a,o)}_encodeParseParams(e,t,n,i,s,a,o){var u,c;if(e.writeFlags(4294967295,a),e.writeFlags(0,0|(o?.injectObjectids?Ir.INJECT_OUTPUT_OBJECT_IDS:0)|(o?.injectTypeids?Ir.INJECT_OUTPUT_TYPE_IDS:0)|(o?.injectTypenames?Ir.INJECT_OUTPUT_TYPE_NAMES:0)),e.writeBigInt64((u=o?.implicitLimit)!==null&&u!==void 0?u:BigInt(0)),e.writeChar(n),e.writeChar(i===$.Cardinality.ONE||i===$.Cardinality.AT_MOST_ONE?$.Cardinality.AT_MOST_ONE:$.Cardinality.MANY),e.writeString(t),!this.adminUIMode&&s===kn.Session.defaults())e.writeBuffer(Te.NULL_CODEC.tidBuffer),e.writeInt32(0);else if(e.writeBuffer(this.stateCodec.tidBuffer),this.stateCodec===Te.INVALID_CODEC||this.stateCodec===Te.NULL_CODEC)e.writeInt32(0);else{if(((c=this.stateCache)===null||c===void 0?void 0:c[0])!==s){let d=new De.WriteBuffer;this.stateCodec.encode(d,s._serialise()),this.stateCache=[s,d.unwrap()]}e.writeBuffer(this.stateCache[1])}}async _parse(e,t,n,i,s=_o,a){let o=new De.WriteMessageBuffer;o.beginMessage(M.$P),o.writeUInt16(0),this._encodeParseParams(o,e,t,n,i,s,a),o.endMessage(),o.writeSync(),this._sendData(o.unwrap());let u=!0,c=null,d=null,h=-1,_=null,f=null,p=null,m=null;for(;u;)switch(this.buffer.takeMessage()||await this._waitForMessage(),this.buffer.getMessageType()){case M.$T:{try{[d,_,f,h,p,m]=this._parseDescribeTypeMessage();let C=this._getQueryCacheKey(e,t,n);this.queryCodecCache.set(C,[d,_,f,h])}catch(C){c=C}break}case M.$E:{c=this._parseErrorMessage(),c._query=e;break}case M.$s:{this._parseDescribeStateMessage();break}case M.$Z:{this._parseSyncMessage(),u=!1;break}default:this._fallthrough()}if(c!==null){if(c instanceof te.StateMismatchError)return this._parse(e,t,n,i,s,a);throw c}return[d,_,f,h,p,m]}async _executeFlow(e,t,n,i,s,a,o,u,c=_o,d){let h=new De.WriteMessageBuffer;h.beginMessage(M.$O),h.writeUInt16(0),this._encodeParseParams(h,e,n,i,s,c,d),h.writeBuffer(a.tidBuffer),h.writeBuffer(o.tidBuffer),a?h.writeBuffer(this._encodeArgs(t,a)):h.writeInt32(0),h.endMessage(),h.writeSync(),this._sendData(h.unwrap());let _=null,f=!0;for(;f;)switch(this.buffer.takeMessage()||await this._waitForMessage(),this.buffer.getMessageType()){case M.$D:{if(_==null)try{this._parseDataMessages(o,u)}catch(m){_=m,this.buffer.finishMessage()}else this.buffer.discardMessage();break}case M.$C:{this.lastStatus=this._parseCommandCompleteMessage();break}case M.$Z:{this._parseSyncMessage(),f=!1;break}case M.$T:{try{let[m,O,C,S]=this._parseDescribeTypeMessage(),N=this._getQueryCacheKey(e,n,i);this.queryCodecCache.set(N,[m,O,C,S]),o=C}catch(m){_=m}break}case M.$s:{this._parseDescribeStateMessage();break}case M.$E:{_=this._parseErrorMessage(),_._query=e;break}default:this._fallthrough()}if(_!=null){if(_ instanceof te.StateMismatchError)return this._executeFlow(e,t,n,i,s,a,o,u,c,d);throw _}}_getQueryCacheKey(e,t,n){let i=n===$.Cardinality.ONE||n===$.Cardinality.AT_MOST_ONE;return[t,i,e.length,e].join(";")}_validateFetchCardinality(e,t,n){if(n===$.Cardinality.ONE&&e===$.Cardinality.NO_RESULT)throw new te.NoDataError(`query executed via queryRequiredSingle${t===$.OutputFormat.JSON?"JSON":""}() returned no data`)}async fetch(e,t=null,n,i,s,a=!1){var o,u;if(this.isLegacyProtocol&&n===$.OutputFormat.NONE){if(t!=null)throw new te.InterfaceError("arguments in execute() is not supported in this version of EdgeDB. Upgrade to EdgeDB 2.0 or newer.");return this.legacyExecute(e,a)}this._checkState();let c=i===$.Cardinality.ONE,d=c||i===$.Cardinality.AT_MOST_ONE,h=n===$.OutputFormat.JSON,_=this._getQueryCacheKey(e,n,i),f=[];if(this.isLegacyProtocol){if(s!==kn.Session.defaults())throw new te.InterfaceError("setting session state is not supported in this version of EdgeDB. Upgrade to EdgeDB 2.0 or newer.");if(this.queryCodecCache.has(_)){let[p,m,O]=this.queryCodecCache.get(_);this._validateFetchCardinality(p,n,i),await this._legacyOptimisticExecuteFlow(e,t,n,i,m,O,f)}else{let[p,m,O,C]=await this._legacyParse(e,n,d);this._validateFetchCardinality(p,n,i),this.queryCodecCache.set(_,[p,m,O,C]),await this._legacyExecuteFlow(t,m,O,f)}}else{let[p,m,O]=(o=this.queryCodecCache.get(_))!==null&&o!==void 0?o:[];p&&this._validateFetchCardinality(p,n,i),(!m&&t!==null||this.stateCodec===Te.INVALID_CODEC&&s!==kn.Session.defaults())&&([p,m,O]=await this._parse(e,n,i,s,a?xe.ALL:void 0),this._validateFetchCardinality(p,n,i));try{await this._executeFlow(e,t,n,i,s,m??Te.NULL_CODEC,O??Te.NULL_CODEC,f,a?xe.ALL:void 0)}catch(C){if(C instanceof te.ParameterTypeMismatchError)[p,m,O]=this.queryCodecCache.get(_),await this._executeFlow(e,t,n,i,s,m??Te.NULL_CODEC,O??Te.NULL_CODEC,f,a?xe.ALL:void 0);else throw C}}if(n!==$.OutputFormat.NONE)if(d){if(c&&!f.length)throw new te.NoDataError("query returned no data");return(u=f[0])!==null&&u!==void 0?u:h?"null":null}else return f&&f.length?h?f[0]:f:h?"[]":f}getQueryCapabilities(e,t,n){var i,s;let a=this._getQueryCacheKey(e,t,n);return(s=(i=this.queryCodecCache.get(a))===null||i===void 0?void 0:i[3])!==null&&s!==void 0?s:null}async legacyExecute(e,t=!1){this._checkState();let n=new De.WriteMessageBuffer;n.beginMessage(M.$Q).writeLegacyHeaders({allowCapabilities:t?void 0:Sr}).writeString(e).endMessage(),this._sendData(n.unwrap());let i=null,s=!0;for(;s;)switch(this.buffer.takeMessage()||await this._waitForMessage(),this.buffer.getMessageType()){case M.$C:{this.lastStatus=this._parseCommandCompleteMessage();break}case M.$Z:{this._parseSyncMessage(),s=!1;break}case M.$E:{i=this._parseErrorMessage(),i._query=e;break}default:this._fallthrough()}if(i!=null)throw i}async resetState(){if(this.connected&&this.serverXactStatus!==lt.TRANS_IDLE)try{await this.fetch("rollback",void 0,$.OutputFormat.NONE,$.Cardinality.NO_RESULT,kn.Session.defaults(),!0)}catch{this._abortWithError(new te.ClientConnectionClosedError("failed to reset state"))}}_abort(){this.connected=!1,this._abortWaiters(this.getConnAbortError()),this.connAbortWaiter.done||this.connAbortWaiter.set()}isClosed(){return!this.connected}async close(){this._abort()}async rawParse(e,t,n){let i=await this._parse(e,$.OutputFormat.BINARY,$.Cardinality.MANY,t,ec,n);return[i[1],i[2],i[4],i[5],this.protocolVersion,i[3]]}async rawExecute(e,t,n,i,s,a=null){let o=new De.WriteBuffer;return await this._executeFlow(e,a,n?$.OutputFormat.BINARY:$.OutputFormat.NONE,$.Cardinality.MANY,t,s??Te.NULL_CODEC,n??Te.NULL_CODEC,o,ec,i),o.unwrap()}};Z.BaseRawConnection=wo});var Eo=w(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.XOR=F.getServerKey=F.getClientKey=F.getSaltedPassword=F.buildClientFinalMessage=F.parseServerFinalMessage=F.parseServerFirstMessage=F.buildClientFirstMessage=F.generateNonce=F.bufferEquals=F.saslprep=F.HMAC=F.H=void 0;var Ze=lo();Object.defineProperty(F,"H",{enumerable:!0,get:function(){return Ze.H}});Object.defineProperty(F,"HMAC",{enumerable:!0,get:function(){return Ze.HMAC}});var ze=Y(),$e=T(),eh=18;function mo(r){return r.normalize("NFKC")}F.saslprep=mo;function th(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}F.bufferEquals=th;function rh(r=eh){return(0,Ze.randomBytes)(r)}F.generateNonce=rh;function nh(r,e){let t=`n=${mo(e)},r=${(0,ze.encodeB64)(r)}`;return[`n,,${t}`,t]}F.buildClientFirstMessage=nh;function ih(r){let e=r.split(",");if(e.length<3)throw new $e.ProtocolError("malformed SCRAM message");let t=e[0];if(!t||t[0]!=="r")throw new $e.ProtocolError("malformed SCRAM message");let n=t.split("=",2)[1];if(!n)throw new $e.ProtocolError("malformed SCRAM message");let i=(0,ze.decodeB64)(n),s=e[1];if(!s||s[0]!=="s")throw new $e.ProtocolError("malformed SCRAM message");let a=s.split("=",2)[1];if(!a)throw new $e.ProtocolError("malformed SCRAM message");let o=(0,ze.decodeB64)(a),u=e[2];if(!u||u[0]!=="i")throw new $e.ProtocolError("malformed SCRAM message");let c=u.split("=",2)[1];if(!c||!c.match(/^[0-9]*$/))throw new $e.ProtocolError("malformed SCRAM message");let d=parseInt(c,10);if(d<=0)throw new $e.ProtocolError("malformed SCRAM message");return[i,o,d]}F.parseServerFirstMessage=ih;function sh(r){let e=r.split(",");if(e.length<1)throw new $e.ProtocolError("malformed SCRAM message");let t=e[0];if(!t||t[0]!=="v")throw new $e.ProtocolError("malformed SCRAM message");let n=t.split("=",2)[1];if(!n)throw new $e.ProtocolError("malformed SCRAM message");return(0,ze.decodeB64)(n)}F.parseServerFinalMessage=sh;async function ah(r,e,t,n,i,s){let a=`c=biws,r=${(0,ze.encodeB64)(s)}`,o=ze.utf8Encoder.encode(`${n},${i},${a}`),u=await nc(ze.utf8Encoder.encode(mo(r)),e,t),c=await ic(u),d=await(0,Ze.H)(c),h=await(0,Ze.HMAC)(d,o),_=vo(c,h),f=await sc(u),p=await(0,Ze.HMAC)(f,o);return[`${a},p=${(0,ze.encodeB64)(_)}`,p]}F.buildClientFinalMessage=ah;async function nc(r,e,t){let n=new Uint8Array(e.length+4);n.set(e),n.set([0,0,0,1],e.length);let i=await(0,Ze.HMAC)(r,n),s=i;for(let a=0;a<t-1;a++)s=await(0,Ze.HMAC)(r,s),i=vo(i,s);return i}F.getSaltedPassword=nc;function ic(r){return(0,Ze.HMAC)(r,ze.utf8Encoder.encode("Client Key"))}F.getClientKey=ic;function sc(r){return(0,Ze.HMAC)(r,ze.utf8Encoder.encode("Server Key"))}F.getServerKey=sc;function vo(r,e){let t=r.length;if(t!==e.length)throw new $e.ProtocolError("scram.XOR: buffers are of different lengths");let n=new Uint8Array(t);for(let i=0;i<t;i++)n[i]=r[i]^e[i];return n}F.XOR=vo});var uc=w(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.HTTPSCRAMAuth=void 0;var dt=T(),Hn=Y(),zt=Eo(),oh="/auth/token";async function uh(r,e,t){var n;let i=r+oh,s=await(0,zt.generateNonce)(),[a,o]=(0,zt.buildClientFirstMessage)(s,e),u=await fetch(i,{headers:{Authorization:`SCRAM-SHA-256 data=${ac(a)}`}}),c=u.headers.get("WWW-Authenticate");if(u.status!==401||!c){let Ce=await u.text();throw new dt.ProtocolError(`authentication failed: ${Ce}`)}if(!c.startsWith("SCRAM-SHA-256"))throw new dt.ProtocolError(`unsupported authentication scheme: ${c}`);let d=(n=c.split(/ (.+)?/,2)[1])!==null&&n!==void 0?n:"";if(d.length===0){let Ce=await u.text();throw new dt.ProtocolError(`authentication failed: ${Ce}`)}let{sid:h,data:_}=oc(d);if(!h||!_)throw new dt.ProtocolError(`authentication challenge missing attributes: expected "sid" and "data", got '${d}'`);let[f,p,m]=(0,zt.parseServerFirstMessage)(_),[O,C]=await(0,zt.buildClientFinalMessage)(t,p,m,o,_,f),S=await fetch(i,{headers:{Authorization:`SCRAM-SHA-256 sid=${h}, data=${ac(O)}`}}),N=S.headers.get("Authentication-Info");if(!S.ok||!N){let Ce=await S.text();throw new dt.ProtocolError(`authentication failed: ${Ce}`)}let{data:k,sid:D}=oc(N);if(!D||!k)throw new dt.ProtocolError(`authentication info missing attributes: expected "sid" and "data", got '${N}'`);if(D!==h)throw new dt.ProtocolError("SCRAM session id does not match");let Oe=(0,zt.parseServerFinalMessage)(k);if(!(0,zt.bufferEquals)(Oe,C))throw new dt.ProtocolError("server SCRAM proof does not match");return await S.text()}Wn.HTTPSCRAMAuth=uh;function ac(r){return(0,Hn.encodeB64)(Hn.utf8Encoder.encode(r))}function ch(r){return Hn.utf8Decoder.decode((0,Hn.decodeB64)(r))}function oc(r){var e;let t=new Map(r.length>0?r.split(",").map(a=>a.split(/=(.+)?/,2)).map(([a,o])=>[a.trim(),o.trim()]):[]),n=(e=t.get("sid"))!==null&&e!==void 0?e:null,i=t.get("data"),s=i?ch(i):null;return{sid:n,data:s}}});var lc=w(me=>{"use strict";var lh=me&&me.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),dh=me&&me.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),fh=me&&me.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&lh(e,r,t);return dh(e,r),e},hh=me&&me.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(me,"__esModule",{value:!0});me.FetchConnection=me.AdminUIFetchConnection=void 0;var Oo=yo(),gh=hh(Cr()),ph=fh(Pt()),Mr=T(),bh=uc(),_h=`application/x.edgedb.v_${Oo.PROTO_VER[0]}_${Oo.PROTO_VER[1]}.binary'`,Yn=class extends Oo.BaseRawConnection{constructor(e,t){super(t),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"addr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.addr=this._buildAddr()}_buildAddr(){this.throwNotImplemented("_buildAddr")}async _waitForMessage(){if(!this.buffer.takeMessage()){if(this.messageWaiter==null||this.messageWaiter.done)throw new Mr.InternalClientError("message waiter was not initialized before waiting for response");await this.messageWaiter.wait()}}async __sendData(e){if(this.buffer.takeMessage()){let t=this.buffer.getMessageType();throw new Mr.InternalClientError(`sending request before reading all data of the previous one: ${ph.chr(t)}`)}if(this.messageWaiter!=null&&!this.messageWaiter.done)throw new Mr.InternalClientError("sending request before waiting for completion of the previous one");this.messageWaiter=new gh.default;try{let t={"Content-Type":_h};this.config.user!==void 0&&(t["X-EdgeDB-User"]=this.config.user),this.config.token!==void 0&&(t.Authorization=`Bearer ${this.config.token}`);let n=await fetch(this.addr,{method:"post",body:e,headers:t});if(!n.ok)throw new Mr.ProtocolError(`fetch failed with status code ${n.status}: ${n.statusText}`);let i=await n.arrayBuffer(),s=new Uint8Array(i);try{this.buffer.feed(s)}catch(a){this.messageWaiter.setError(a)}if(!this.buffer.takeMessage())throw new Mr.ProtocolError("no binary protocol messages in the response");this.messageWaiter.set()}catch(t){this.messageWaiter.setError(t)}finally{this.messageWaiter=null}}_sendData(e){this.__sendData(e)}static create(e,t){let n=new this(e,t);return n.connected=!0,n.connWaiter.set(),n}},Co=class extends Yn{constructor(){super(...arguments),Object.defineProperty(this,"adminUIMode",{enumerable:!0,configurable:!0,writable:!0,value:!0})}_buildAddr(){let e=this.config;if(typeof e.address=="string")return`${e.address}/db/${e.database}`;let{address:t,tlsSecurity:n,database:i}=e;return`${`${n==="insecure"?"http":"https"}://${t[0]}:${t[1]}`}/db/${i}`}};me.AdminUIFetchConnection=Co;var cc=new WeakMap,So=class r extends Yn{_buildAddr(){let e=this.config;if(typeof e.address=="string")return`${e.address}/db/${e.database}`;let{address:t,tlsSecurity:n,database:i}=e;return`${`${n==="insecure"?"http":"https"}://${t[0]}:${t[1]}`}/db/${i}`}static async connectWithTimeout(e,t,n){let{connectionParams:{tlsSecurity:i,user:s,password:a="",secretKey:o}}=t,u=o??cc.get(t);if(!u){let h=`${i==="insecure"?"http":"https"}://${e[0]}:${e[1]}`;u=await(0,bh.HTTPSCRAMAuth)(h,s,a),cc.set(t,u)}let c=new r({address:e,tlsSecurity:i,database:t.connectionParams.database,user:t.connectionParams.user,token:u},n);return c.connected=!0,c.connWaiter.set(),c}};me.FetchConnection=So});var fc=w(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.createHttpClient=ft.createClient=ft.FetchClientPool=void 0;var dc=ao(),wh=xn(),yh=T(),mh=lc(),vh=ut(),Eh=(0,wh.getConnectArgumentsParser)(null),Gn=class extends dc.BaseClientPool{constructor(){super(...arguments),Object.defineProperty(this,"isStateless",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_connectWithTimeout",{enumerable:!0,configurable:!0,writable:!0,value:mh.FetchConnection.connectWithTimeout})}};ft.FetchClientPool=Gn;function Oh(){throw new yh.EdgeDBError("'createClient()' cannot be used in browser (or edge runtime) environment, use 'createHttpClient()' API instead")}ft.createClient=Oh;function Ch(r){return new dc.Client(new Gn(Eh,typeof r=="string"?{dsn:r}:r??{}),vh.Options.defaults())}ft.createHttpClient=Ch});var Tr=w(P=>{"use strict";var Sh=P&&P.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ih=P&&P.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Zt=P&&P.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Sh(e,r,t);return Ih(e,r),e},Mh=P&&P.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(P,"__esModule",{value:!0});P.srcDir=P.exit=P.homeDir=P.input=P.exists=P.walk=P.hashSHA1toHex=P.readDir=P.watch=P.hasFSReadPermission=P.readFileUtf8=P.process=P.tls=P.fs=P.net=P.path=void 0;var Ph=Zt(require("crypto")),St=require("fs");Object.defineProperty(P,"fs",{enumerable:!0,get:function(){return St.promises}});var Th=Zt(require("net"));P.net=Th;var Dh=Zt(require("os")),Io=Zt(require("path"));P.path=Io;var Ah=Zt(require("tls"));P.tls=Ah;var Pr=Mh(require("process"));P.process=Pr.default;var Nh=Zt(require("readline")),Bh=require("stream");async function jh(...r){return await St.promises.readFile(Io.join(...r),{encoding:"utf8"})}P.readFileUtf8=jh;function Uh(){return!0}P.hasFSReadPermission=Uh;function Lh(r){return St.promises.watch(r,{recursive:!0})}P.watch=Lh;async function xh(r){return St.promises.readdir(r)}P.readDir=xh;function $h(r){return Ph.createHash("sha1").update(r).digest("hex")}P.hashSHA1toHex=$h;async function hc(r,e){let{match:t,skip:n=[]}=e||{};try{await St.promises.access(r)}catch{return[]}let i=await St.promises.readdir(r,{withFileTypes:!0}),s=await Promise.all(i.map(a=>{let o=Io.resolve(r,a.name);return n&&n.some(u=>u.test(o))?[]:a.isDirectory()?hc(o,e):t&&!t.some(u=>u.test(o))?[]:[o]}));return Array.prototype.concat(...s)}P.walk=hc;async function qh(r){try{return await St.promises.access(r),!0}catch{return!1}}P.exists=qh;function Rh(r,e){let t=!1,n=e?.silent?new Bh.Writable({write(s,a,o){t||Pr.default.stdout.write(s,a),o()}}):Pr.default.stdout,i=Nh.createInterface({input:Pr.default.stdin,output:n});return new Promise((s,a)=>{i.question(r,o=>{i.close(),s(o)}),t=!0})}P.input=Rh;P.homeDir=Dh.homedir;function Fh(r){Pr.default.exit(r)}P.exit=Fh;function kh(){return __dirname}P.srcDir=kh});var gc=w(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.searchConfigDir=er.isWindows=void 0;var ve=Tr();er.isWindows=process.platform==="win32";var Vn;process.platform==="darwin"?Vn=()=>ve.path.join((0,ve.homeDir)(),"Library","Application Support","edgedb"):process.platform==="win32"?Vn=()=>{var r;let e=(r=process.env.LOCALAPPDATA)!==null&&r!==void 0?r:ve.path.join((0,ve.homeDir)(),"AppData","Local");return ve.path.join(e,"EdgeDB","config")}:Vn=()=>{let r=process.env.XDG_CONFIG_HOME;return(!r||!ve.path.isAbsolute(r))&&(r=ve.path.join((0,ve.homeDir)(),".config")),ve.path.join(r,"edgedb")};async function Hh(...r){let e=ve.path.join(Vn(),...r);if(await(0,ve.exists)(e))return e;let t=ve.path.join((0,ve.homeDir)(),".edgedb",...r);return await(0,ve.exists)(t)?t:e}er.searchConfigDir=Hh});var bc=w(pe=>{"use strict";var Wh=pe&&pe.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yh=pe&&pe.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Gh=pe&&pe.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Wh(e,r,t);return Yh(e,r),e};Object.defineProperty(pe,"__esModule",{value:!0});pe.parseConnectArguments=pe.serverUtils=pe.findStashPath=void 0;var et=Tr(),Mo=Gh(gc()),Vh=xn(),Jn=new Map;async function Jh(r=!0){if(!r&&!(0,et.hasFSReadPermission)())return null;let e=process.cwd();if(Jn.has(e))return Jn.get(e);let t=e,n=(await et.fs.stat(t)).dev;for(;;){if(await(0,et.exists)(et.path.join(t,"edgedb.toml")))return Jn.set(e,t),t;let i=et.path.join(t,"..");if(i===t||(await et.fs.stat(i)).dev!==n)return Jn.set(e,null),null;t=i}}async function pc(r){let e=await et.fs.realpath(r);Mo.isWindows&&!e.startsWith("\\\\")&&(e="\\\\?\\"+e);let t=(0,et.hashSHA1toHex)(e),i=et.path.basename(e)+"-"+t;return Mo.searchConfigDir("projects",i)}pe.findStashPath=pc;pe.serverUtils={findProjectDir:Jh,findStashPath:pc,readFileUtf8:et.readFileUtf8,searchConfigDir:Mo.searchConfigDir};pe.parseConnectArguments=(0,Vh.getConnectArgumentsParser)(pe.serverUtils)});var Bo=w(qe=>{"use strict";var Kh=qe&&qe.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Qh=qe&&qe.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),No=qe&&qe.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Kh(e,r,t);return Qh(e,r),e},Xh=qe&&qe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(qe,"__esModule",{value:!0});qe.RawConnection=void 0;var ht=Tr(),Po=yo(),Kn=Kt(),To=Y(),zh=Xh(Cr()),be=No(Pt()),tr=No(Eo()),re=No(T()),rr;(function(r){r[r.AUTH_OK=0]="AUTH_OK",r[r.AUTH_SASL=10]="AUTH_SASL",r[r.AUTH_SASL_CONTINUE=11]="AUTH_SASL_CONTINUE",r[r.AUTH_SASL_FINAL=12]="AUTH_SASL_FINAL"})(rr||(rr={}));var Do=new WeakMap;function Zh(r){if(Do.has(r))return Do.get(r);let e=r.tlsSecurity,t={ALPNProtocols:["edgedb-binary"],servername:r.address[0],rejectUnauthorized:e!=="insecure"};return Do.set(r,t),r._tlsCAData!==null&&(t.ca=r._tlsCAData),e==="no_host_verification"&&(t.checkServerIdentity=(n,i)=>{let s=ht.tls.checkServerIdentity(n,i);if(s!==void 0&&!s.message.startsWith("Hostname/IP does not match certificate"))return s}),t}var Ao=class extends Po.BaseRawConnection{constructor(e,t,n){super(n),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"paused",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=t,this.paused=!1,this.sock=e,this.sock.setNoDelay(),this.sock.on("error",this._onError.bind(this)),this.sock.on("data",this._onData.bind(this)),ht.tls.TLSSocket&&this.sock instanceof ht.tls.TLSSocket?this.sock.on("secureConnect",this._onConnect.bind(this)):this.sock.on("connect",this._onConnect.bind(this)),this.sock.on("close",this._onClose.bind(this))}_onConnect(){this.connWaiter.set()}_onClose(){if(!this.connected)return;let e=new re.ClientConnectionClosedError("the connection has been aborted");(!this.connWaiter.done||this.messageWaiter)&&this._abortWaiters(e),this.buffer.takeMessage()&&this.buffer.getMessageType()===be.$E&&(e.source=this._parseErrorMessage()),this._abortWithError(e)}_onError(e){let t=new re.ClientConnectionClosedError(`network error: ${e}`);t.source=e;try{this._abortWaiters(t)}finally{this._abortWithError(t)}}_onData(e){try{this.buffer.feed(e)}catch(t){this.messageWaiter&&(this.messageWaiter.setError(t),this.messageWaiter=null),this._abortWithError(t)}this.messageWaiter&&this.buffer.takeMessage()&&(this.messageWaiter.set(),this.messageWaiter=null)}async _waitForMessage(){if(!this.buffer.takeMessage()){this.paused&&(this.paused=!1,this.sock.resume()),this.sock.ref(),this.messageWaiter=new zh.default;try{await this.messageWaiter.wait()}finally{this.sock.unref()}}}_sendData(e){this.sock.write(e)}static newSock(e,t){if(typeof e=="string")return ht.net.createConnection(e);let[n,i]=e;if(t==null)return ht.net.createConnection(i,n);let s={...t,host:n,port:i};return ht.tls.connect(s)}_abort(){this.sock&&this.connected&&this.sock.destroy(),super._abort()}async close(){return this.sock&&this.connected&&this.sock.write(new To.WriteMessageBuffer().beginMessage(be.$X).endMessage().unwrap()),await super.close()}static async connectWithTimeout(e,t,n,i=!0){let s=this.newSock(e,i?Zh(t.connectionParams):void 0),a=new this(s,t,n),o=a.connect(),u=null,c=!1;t.connectTimeout&&(u=setTimeout(()=>{a.connected||(c=!0,a.sock.destroy(new re.ClientConnectionTimeoutError(`connection timed out (${t.connectTimeout}ms)`)))},t.connectTimeout));try{await o}catch(d){if(a._abort(),c&&d instanceof re.ClientConnectionClosedError)throw new re.ClientConnectionTimeoutError(`connection timed out (${t.connectTimeout}ms)`);if(d instanceof re.EdgeDBError)throw d;{let h;switch(d.code){case"EPROTO":if(i===!0)try{return this.connectWithTimeout(e,t,n,!1)}catch{}h=new re.ClientConnectionFailedError(`${d.message}
Attempted to connect using the following credentials:
${t.connectionParams.explainConfig()}
`);break;case"ECONNREFUSED":case"ECONNABORTED":case"ECONNRESET":case"ENOTFOUND":case"ENOENT":h=new re.ClientConnectionFailedTemporarilyError(`${d.message}
Attempted to connect using the following credentials:
${t.connectionParams.explainConfig()}
`);break;default:h=new re.ClientConnectionFailedError(`${d.message}
Attempted to connect using the following credentials:
${t.connectionParams.explainConfig()}
`);break}throw h.source=d,h}}finally{u!=null&&clearTimeout(u)}return a}async connect(){if(await this.connWaiter.wait(),this.sock instanceof ht.tls.TLSSocket&&this.sock.alpnProtocol!=="edgedb-binary")throw new re.ClientConnectionFailedError("The server doesn't support the edgedb-binary protocol.");let e=new To.WriteMessageBuffer;e.beginMessage(be.$V).writeInt16(this.protocolVersion[0]).writeInt16(this.protocolVersion[1]);let t={user:this.config.connectionParams.user,database:this.config.connectionParams.database};this.config.connectionParams.secretKey!=null&&(t.secret_key=this.config.connectionParams.secretKey),e.writeInt16(Object.keys(t).length);for(let[n,i]of Object.entries(t))e.writeString(n).writeString(i);for(e.writeInt16(0),e.endMessage(),this.sock.write(e.unwrap());;)switch(this.buffer.takeMessage()||await this._waitForMessage(),this.buffer.getMessageType()){case be.$v:{let i=this.buffer.readInt16(),s=this.buffer.readInt16();this._parseHeaders(),this.buffer.finishMessage();let a=[i,s];if((0,Kn.versionGreaterThan)(a,Po.PROTO_VER)||(0,Kn.versionGreaterThan)(Po.PROTO_VER_MIN,a))throw new re.UnsupportedProtocolVersionError(`the server requested an unsupported version of the protocol ${i}.${s}`);this.protocolVersion=[i,s],this.isLegacyProtocol=!(0,Kn.versionGreaterThanOrEqual)(this.protocolVersion,[1,0]);break}case be.$R:{let i=this.buffer.readInt32();if(i===rr.AUTH_OK)this.buffer.finishMessage();else if(i===rr.AUTH_SASL)await this._authSasl();else throw new re.ProtocolError(`unsupported authentication method requested by the server: ${i}`);break}case be.$K:{this.serverSecret=this.buffer.readBuffer(32),this.buffer.finishMessage();break}case be.$E:throw this._parseErrorMessage();case be.$s:{this._parseDescribeStateMessage();break}case be.$Z:{if(this._parseSyncMessage(),!(this.sock instanceof ht.tls.TLSSocket)&&typeof Deno>"u"&&(0,Kn.versionGreaterThanOrEqual)(this.protocolVersion,[0,11])){let[i,s]=this.protocolVersion;throw new re.ProtocolError(`the protocol version requires TLS: ${i}.${s}`)}this.connected=!0;return}default:this._fallthrough()}}async _authSasl(){let e=this.buffer.readInt32();if(e<=0)throw new re.ProtocolError("the server requested SASL authentication but did not offer any methods");let t=[],n=!1;for(let C=0;C<e;C++){let S=this.buffer.readString();S==="SCRAM-SHA-256"&&(n=!0),t.push(S)}if(this.buffer.finishMessage(),!n)throw new re.ProtocolError(`the server offered the following SASL authentication methods: ${t.join(", ")}, neither are supported.`);let i=await tr.generateNonce(),[s,a]=tr.buildClientFirstMessage(i,this.config.connectionParams.user),o=new To.WriteMessageBuffer;o.beginMessage(be.$p).writeString("SCRAM-SHA-256").writeString(s).endMessage(),this.sock.write(o.unwrap()),await this._ensureMessage(be.$R,"SASLContinue");let u=this.buffer.readInt32();if(u!==rr.AUTH_SASL_CONTINUE)throw new re.ProtocolError(`expected SASLContinue from the server, received ${u}`);let c=this.buffer.readString();this.buffer.finishMessage();let[d,h,_]=tr.parseServerFirstMessage(c),[f,p]=await tr.buildClientFinalMessage(this.config.connectionParams.password||"",h,_,a,c,d);if(o.reset().beginMessage(be.$r).writeString(f).endMessage(),this.sock.write(o.unwrap()),await this._ensureMessage(be.$R,"SASLFinal"),u=this.buffer.readInt32(),u!==rr.AUTH_SASL_FINAL)throw new re.ProtocolError(`expected SASLFinal from the server, received ${u}`);let m=this.buffer.readString();this.buffer.finishMessage();let O=tr.parseServerFinalMessage(m);if(!tr.bufferEquals(O,p))throw new re.ProtocolError("server SCRAM proof does not match")}async _ensureMessage(e,t){this.buffer.takeMessage()||await this._waitForMessage();let n=this.buffer.getMessageType();switch(n){case be.$E:throw this._parseErrorMessage();case e:return;default:throw new re.UnexpectedMessageError(`expected ${t} from the server, received ${be.chr(n)}`)}}};qe.RawConnection=Ao});var Lo=w(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.createHttpClient=nr.createClient=void 0;var Uo=ao(),e0=fc(),wc=bc(),yc=ut(),_c=Bo(),jo=class extends Uo.BaseClientPool{constructor(){super(...arguments),Object.defineProperty(this,"isStateless",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_connectWithTimeout",{enumerable:!0,configurable:!0,writable:!0,value:_c.RawConnection.connectWithTimeout.bind(_c.RawConnection)})}};function t0(r){return new Uo.Client(new jo(wc.parseConnectArguments,typeof r=="string"?{dsn:r}:r??{}),yc.Options.defaults())}nr.createClient=t0;function r0(r){return new Uo.Client(new e0.FetchClientPool(wc.parseConnectArguments,typeof r=="string"?{dsn:r}:r??{}),yc.Options.defaults())}nr.createHttpClient=r0});var Ec=w(j=>{"use strict";var mc=j&&j.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),n0=j&&j.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),i0=j&&j.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&mc(e,r,t)},vc=j&&j.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&mc(e,r,t);return n0(e,r),e};Object.defineProperty(j,"__esModule",{value:!0});j._plugJSBI=j._ReadBuffer=j._CodecsRegistry=j.Range=j.ConfigMemory=j.DateDuration=j.RelativeDuration=j.Duration=j.LocalTime=j.LocalDate=j.LocalDateTime=void 0;var ir=hn();Object.defineProperty(j,"LocalDateTime",{enumerable:!0,get:function(){return ir.LocalDateTime}});Object.defineProperty(j,"LocalDate",{enumerable:!0,get:function(){return ir.LocalDate}});Object.defineProperty(j,"LocalTime",{enumerable:!0,get:function(){return ir.LocalTime}});Object.defineProperty(j,"Duration",{enumerable:!0,get:function(){return ir.Duration}});Object.defineProperty(j,"RelativeDuration",{enumerable:!0,get:function(){return ir.RelativeDuration}});Object.defineProperty(j,"DateDuration",{enumerable:!0,get:function(){return ir.DateDuration}});var s0=Oa();Object.defineProperty(j,"ConfigMemory",{enumerable:!0,get:function(){return s0.ConfigMemory}});var a0=Aa();Object.defineProperty(j,"Range",{enumerable:!0,get:function(){return a0.Range}});i0(T(),j);var o0=vc(Ka()),u0=vc(Y());j._CodecsRegistry=o0.CodecsRegistry;j._ReadBuffer=u0.ReadBuffer;var c0=gt();j._plugJSBI=c0.plugJSBI});var Oc=w(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.OperatorKind=ce.SelectModifierKind=ce.ExpressionKind=ce.TypeKind=ce.Cardinality=void 0;var l0;(function(r){r.AtMostOne="AtMostOne",r.One="One",r.Many="Many",r.AtLeastOne="AtLeastOne",r.Empty="Empty"})(l0=ce.Cardinality||(ce.Cardinality={}));var d0;(function(r){r.scalar="scalar",r.enum="enum",r.object="object",r.namedtuple="namedtuple",r.tuple="tuple",r.array="array",r.range="range"})(d0=ce.TypeKind||(ce.TypeKind={}));var f0;(function(r){r.Set="Set",r.Array="Array",r.Tuple="Tuple",r.NamedTuple="NamedTuple",r.TuplePath="TuplePath",r.PathNode="PathNode",r.PathLeaf="PathLeaf",r.Literal="Literal",r.Cast="Cast",r.Select="Select",r.Update="Update",r.Delete="Delete",r.Insert="Insert",r.InsertUnlessConflict="InsertUnlessConflict",r.Function="Function",r.Operator="Operator",r.For="For",r.ForVar="ForVar",r.TypeIntersection="TypeIntersection",r.Alias="Alias",r.With="With",r.WithParams="WithParams",r.Param="Param",r.OptionalParam="OptionalParam",r.Detached="Detached",r.Global="Global",r.PolyShapeElement="PolyShapeElement",r.Group="Group"})(f0=ce.ExpressionKind||(ce.ExpressionKind={}));var h0;(function(r){r.filter="filter",r.order_by="order_by",r.offset="offset",r.limit="limit"})(h0=ce.SelectModifierKind||(ce.SelectModifierKind={}));var g0;(function(r){r.Infix="Infix",r.Postfix="Postfix",r.Prefix="Prefix",r.Ternary="Ternary"})(g0=ce.OperatorKind||(ce.OperatorKind={}))});var Qn=w(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.util=void 0;var p0;(function(r){function e(a,o){throw o??new Error(`${a} is supposed to be of "never" type`)}r.assertNever=e;function t(a){if(!a.includes("::"))throw new Error(`Invalid FQN ${a}`);let o=a.split("::");return{mod:o.slice(0,-1).join("::"),name:o[o.length-1]}}r.splitName=t;function n(a){if(a.includes("::"))throw new Error(`toIdent: invalid name ${a}`);return a.replace(/([^a-zA-Z0-9_]+)/g,"_")}r.toIdent=n,r.deduplicate=a=>[...new Set(a)],r.getFromArrayMap=(a,o)=>a[o]||[],r.defineProperty=(a,o,u)=>Object.defineProperty(a,o,u),r.defineGetter=(a,o,u)=>Object.defineProperty(a,o,{get:u,enumerable:!0}),r.defineMethod=(a,o,u)=>(a[o]=u.bind(a),a);function i(a,o){return Array.prototype.concat(...a.map(o))}r.flatMap=i;function s(a){let o={};for(let u of Object.keys(a))u.startsWith("$")||(o[u]=a[u]);return o}r.omitDollarPrefixed=s})(p0=Dr.util||(Dr.util={}))});var Sc=w(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0})});var sr=w(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.StrictMap=void 0;var xo=class extends Map{get(e){if(!this.has(e))throw new Error(`key "${e}" is not found`);return super.get(e)}};Xn.StrictMap=xo});var Ic=w(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:!0});zn.reservedKeywords=void 0;zn.reservedKeywords=new Set(["__edgedbsys__","__edgedbtpl__","__source__","__std__","__subject__","__type__","abort","alter","analyze","and","anyarray","anytuple","anytype","begin","case","check","commit","configure","create","deallocate","declare","delete","describe","detached","discard","distinct","do","drop","else","empty","end","execute","exists","explain","extending","fetch","filter","for","get","global","grant","group","if","ilike","import","in","insert","introspect","is","like","limit","listen","load","lock","match","module","move","not","notify","offset","optional","or","order","over","partition","policy","populate","prepare","raise","refresh","reindex","release","reset","revoke","rollback","select","set","single","start","typeof","union","update","variadic","when","window","with"])});var Zn=w(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.types=Ee.topoSort=Ee.getTypes=Ee.typeMapping=void 0;var $o=sr(),It={id:"00000000-0000-0000-0000-0000000001ff",name:"std::number",is_abstract:!1,is_seq:!1,kind:"scalar",enum_values:null,material_id:null,bases:[]};Ee.typeMapping=new Map([["00000000-0000-0000-0000-000000000103",It],["00000000-0000-0000-0000-000000000104",It],["00000000-0000-0000-0000-000000000105",It],["00000000-0000-0000-0000-000000000106",It],["00000000-0000-0000-0000-000000000107",It]]);async function Mc(r,e){var t,n,i,s,a;let o=e?.debug===!0,c=await r.queryRequiredSingle("select sys::get_version().major;")>=2,d=`
    WITH
      MODULE schema,

      material_scalars := (
        SELECT ScalarType
        FILTER NOT .abstract
           AND NOT EXISTS .enum_values
           AND NOT EXISTS (SELECT .ancestors FILTER NOT .abstract)
      )

    SELECT Type {
      id,
      name :=
        array_join(array_agg([IS ObjectType].union_of.name), ' | ')
        IF EXISTS [IS ObjectType].union_of
        ELSE .name,
      is_abstract := .abstract,

      kind := 'object' IF Type IS ObjectType ELSE
              'scalar' IF Type IS ScalarType ELSE
              'array' IF Type IS Array ELSE
              'tuple' IF Type IS Tuple ELSE
              ${c?"'range' IF Type IS Range ELSE":""}
              'unknown',

      [IS ScalarType].enum_values,
      is_seq := 'std::sequence' in [IS ScalarType].ancestors.name,
      # for sequence (abstract type that has non-abstract ancestor)
      single material_id := (
        SELECT x := Type[IS ScalarType].ancestors
        FILTER x IN material_scalars
        LIMIT 1
      ).id,

      [IS InheritingObject].bases: {
        id
      } ORDER BY @index ASC,

      [IS ObjectType].union_of,
      [IS ObjectType].intersection_of,
      [IS ObjectType].pointers: {
        card := ("One" IF .required ELSE "AtMostOne") IF <str>.cardinality = "One" ELSE ("AtLeastOne" IF .required ELSE "Many"),
        name,
        target_id := .target.id,
        kind := 'link' IF .__type__.name = 'schema::Link' ELSE 'property',
        is_exclusive := exists (select .constraints filter .name = 'std::exclusive'),
        is_computed := len(.computed_fields) != 0,
        is_readonly := .readonly,
        has_default := EXISTS .default or ("std::sequence" in .target[IS ScalarType].ancestors.name),
        [IS Link].pointers: {
          card := ("One" IF .required ELSE "AtMostOne") IF <str>.cardinality = "One" ELSE ("AtLeastOne" IF .required ELSE "Many"),
          name := '@' ++ .name,
          target_id := .target.id,
          kind := 'link' IF .__type__.name = 'schema::Link' ELSE 'property',
          is_computed := len(.computed_fields) != 0,
          is_readonly := .readonly
        } filter .name != '@source' and .name != '@target',
      } FILTER @is_owned,
      exclusives := assert_distinct((
        [is schema::ObjectType].constraints
        union
        [is schema::ObjectType].pointers.constraints
      ) {
        target := (.subject[is schema::Property].name ?? .subject[is schema::Link].name ?? .subjectexpr)
      } filter .name = 'std::exclusive'),
      backlinks := (
         SELECT DETACHED Link
         FILTER .target = Type
           AND NOT EXISTS .source[IS ObjectType].union_of
        ) {
        card := "AtMostOne"
          IF
          EXISTS (select .constraints filter .name = 'std::exclusive')
          ELSE
          "Many",
        name := '<' ++ .name ++ '[is ' ++ assert_exists(.source.name) ++ ']',
        stub := .name,
        target_id := .source.id,
        kind := 'link',
        is_exclusive := (EXISTS (select .constraints filter .name = 'std::exclusive')) AND <str>.cardinality = "One",
      },
      backlink_stubs := array_agg((
        WITH
          stubs := DISTINCT (SELECT DETACHED Link FILTER .target = Type).name,
          baseObjectId := (SELECT DETACHED ObjectType FILTER .name = 'std::BaseObject' LIMIT 1).id
        FOR stub in { stubs }
        UNION (
          SELECT {
            card := "Many",
            name := '<' ++ stub,
            target_id := baseObjectId,
            kind := 'link',
            is_exclusive := false,
          }
        )
      )),
      array_element_id := [IS Array].element_type.id,

      tuple_elements := (SELECT [IS Tuple].element_types {
        target_id := .type.id,
        name
      } ORDER BY @index ASC),
      ${c?"range_element_id := [IS Range].element_type.id,":""}
    }
    ORDER BY .name;
  `,h=JSON.parse(await r.queryJSON(d));o&&console.log(JSON.stringify(h,null,2));for(let f of h){if(Array.isArray(f.backlinks))for(let p of f.backlinks){let m=p.name.match(/\[is (.+)\]/)[1];m.split("::").length===2&&m.startsWith("default::")&&(p.name=p.name.replace(/\[is (.+)\]/,`[is ${m.slice(9)}]`))}switch(f.kind){case"scalar":Ee.typeMapping.has(f.id)&&(f.cast_type=Ee.typeMapping.get(f.id).id),f.is_seq&&(f.cast_type=It.id),f.name!=="std::sequence"&&((t=f.bases[0])===null||t===void 0?void 0:t.id)===f.material_id&&(f.cast_type=(i=(n=Ee.typeMapping.get(f.material_id))===null||n===void 0?void 0:n.id)!==null&&i!==void 0?i:f.material_id);break;case"range":f.range_element_id=(a=(s=Ee.typeMapping.get(f.range_element_id))===null||s===void 0?void 0:s.id)!==null&&a!==void 0?a:f.range_element_id;break;case"object":let p={};for(let C of f.pointers)p[C.name]=C;let m=f.exclusives,O=[];for(let C of m){let S=C.target;if(S in p&&O.push({[C.target]:p[C.target]}),S[0]==="("&&S[S.length-1]===")"){let N=S.slice(1,-1).split(" ").map(D=>(D=D.trim(),D[0]==="."&&(D=D.slice(1)),D[D.length-1]===","&&(D=D.slice(0,-1)),D)),k={};if(!N.every(D=>D in p))continue;for(let D of N)k[D]=p[D];O.push(k)}}f.exclusives=O;break}}h.push(It);let _=Pc(h);for(let[f,p]of _)if(p.kind==="object"&&p.union_of.length){let m=p.union_of.map(({id:N})=>{let k=_.get(N);if(k.kind!=="object")throw new Error(`type '${k.name}' of union '${p.name}' is not an object type`);return k}),[O,...C]=m,S=C.map(N=>new Set(N.pointers.map(k=>k.name)));for(let N of O.pointers)S.every(k=>k.has(N.name))&&p.pointers.push(N);p.backlinks=[],p.backlink_stubs=[]}return _}Ee.getTypes=Mc;Ee.types=Mc;function Pc(r){let e=new $o.StrictMap,t=new $o.StrictMap;for(let o of r)e.set(o.id,o);for(let o of r)if(!(o.kind!=="object"&&o.kind!=="scalar"))for(let{id:u}of o.bases){if(!e.has(u))throw new Error(`reference to an unknown object type: ${u}`);t.has(o.id)||t.set(o.id,new Set),t.get(o.id).add(u)}let n=new Set,i=new Set,s=new $o.StrictMap,a=o=>{if(n.has(o.name)){let u=Array.from(n).slice(1,2);throw new Error(`dependency cycle between ${o.name} and ${u}`)}if(!i.has(o.id)){if(n.add(o.name),t.has(o.id))for(let u of t.get(o.id).values())a(e.get(u));s.set(o.id,o),i.add(o.id),n.delete(o.name)}};for(let o of r)a(o);return s}Ee.topoSort=Pc});var Dc=w(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});ei.casts=void 0;var Tc=Zn(),Ar=(r,e,t=new Set)=>{let n=new Set;return t.has(r)?[]:(t.add(r),(e[r]||[]).map(i=>{n.add(i);for(let s of Ar(i,e,t))n.add(s)}),[...n])},b0=async(r,e)=>{var t,n,i,s,a,o,u,c;let d=await r.queryJSON(`WITH MODULE schema
        SELECT Cast {
            id,
            source := .from_type { id, name },
            target := .to_type { id, name },
            allow_assignment,
            allow_implicit,
        }
        FILTER .from_type IS ScalarType
        AND .to_type IS ScalarType
        # AND .from_type.is_abstract = false
        # AND .to_type.is_abstract = false
        `),h=JSON.parse(d),_=new Set,f={},p={},m={},O={},C={},S={},N={};for(let y of h)(Tc.typeMapping.has(y.source.id)||Tc.typeMapping.has(y.target.id))&&(y.allow_implicit=!1,y.allow_assignment=!1),f[y.source.id]=y.source,f[y.target.id]=y.target,_.add(y.source.id),_.add(y.target.id),p[y.id]=y,m[y.source.id]=m[y.source.id]||[],m[y.source.id].push(y.target.id),(y.allow_assignment||y.allow_implicit)&&((t=S[a=y.source.id])!==null&&t!==void 0||(S[a]=[]),S[y.source.id].push(y.target.id),(n=N[o=y.target.id])!==null&&n!==void 0||(N[o]=[]),N[y.target.id].push(y.source.id)),y.allow_implicit&&((i=O[u=y.source.id])!==null&&i!==void 0||(O[u]=[]),O[y.source.id].push(y.target.id),(s=C[c=y.target.id])!==null&&s!==void 0||(C[c]=[]),C[y.target.id].push(y.source.id));let k={},D={},Oe={},se={},Ce={};for(let y of[..._])k[y]=m[y]||[],D[y]=Ar(y,O),Oe[y]=Ar(y,C),se[y]=Ar(y,S),Ce[y]=Ar(y,N);if(e?.debug===!0){console.log(`
IMPLICIT`);for(let[y,Ae]of Object.entries(D))console.log(`${f[y].name} implicitly castable to: [${Ae.map(Ne=>f[Ne].name).join(", ")}]`);console.log("");for(let[y,Ae]of Object.entries(Oe))console.log(`${f[y].name} implicitly castable from: [${Ae.map(Ne=>f[Ne].name).join(", ")}]`);console.log(`
ASSIGNABLE TO`);for(let[y,Ae]of Object.entries(se))console.log(`${f[y].name} assignable to: [${Ae.map(Ne=>f[Ne].name).join(", ")}]`);console.log(`
ASSIGNABLE BY`);for(let[y,Ae]of Object.entries(Ce))console.log(`${f[y].name} assignable by: [${Ae.map(Ne=>f[Ne].name).join(", ")}]`);console.log(`
EXPLICIT`);for(let[y,Ae]of Object.entries(k))console.log(`${f[y].name} castable to: [${Ae.map(Ne=>f[Ne].name).join(", ")}]`)}return{castsById:p,typesById:f,castMap:k,implicitCastMap:D,implicitCastFromMap:Oe,assignmentCastMap:se,assignableByMap:Ce}};ei.casts=b0});var qo=w(ar=>{"use strict";Object.defineProperty(ar,"__esModule",{value:!0});ar.replaceNumberTypes=ar.functions=void 0;var _0=sr(),ti=Zn(),w0=async r=>{var e;let t=await r.queryJSON(`
    with module schema
    select Function {
      id,
      name,
      annotations: {
        name,
        @value
      } filter .name = 'std::description',
      return_type: {id, name},
      return_typemod,
      params: {
        name,
        type: {id, name},
        kind,
        typemod,
        hasDefault := exists .default,
      } order by @index,
      preserves_optionality,
    } filter .internal = false
  `),n=new _0.StrictMap,i=new Set;for(let s of JSON.parse(t)){let{name:a}=s;n.has(a)||n.set(a,[]);let o={...s,description:(e=s.annotations[0])===null||e===void 0?void 0:e["@value"]};Ac(o);let u=y0(o);i.has(u)||(n.get(a).push(o),i.add(u))}return n};ar.functions=w0;function Ac(r){if(ti.typeMapping.has(r.return_type.id)){let e=ti.typeMapping.get(r.return_type.id);r.return_type={id:e.id,name:e.name}}for(let e of r.params)if(ti.typeMapping.has(e.type.id)){let t=ti.typeMapping.get(e.type.id);e.type={id:t.id,name:t.name}}}ar.replaceNumberTypes=Ac;function y0(r){return JSON.stringify({name:r.name,return_type:r.return_type.id,return_typemod:r.return_typemod,params:r.params.map(e=>JSON.stringify({kind:e.kind,type:e.type.id,typemod:e.typemod,hasDefault:!!e.hasDefault})).sort(),preserves_optionality:r.preserves_optionality})}});var Nc=w(ri=>{"use strict";Object.defineProperty(ri,"__esModule",{value:!0});ri.globals=void 0;async function m0(r){let e=new Map;if(await r.queryRequiredSingle("select sys::get_version().major;")===1)return e;let n=`
    WITH
      MODULE schema
    SELECT schema::Global {
      id,
      name,
      target_id := .target.id,
      card := ("One" IF .required ELSE "One" IF EXISTS .default ELSE "AtMostOne")
        IF <str>.cardinality = "One" ELSE
        ("AtLeastOne" IF .required ELSE "Many"),
      has_default := exists .default,
    }
    ORDER BY .name;
  `,i=JSON.parse(await r.queryJSON(n));for(let s of i)e.set(s.id,s);return e}ri.globals=m0});var Bc=w(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.operators=void 0;var v0=sr(),E0=qo(),O0=Qn(),C0=async r=>{var e,t;let n=await r.queryJSON(`
    with module schema
    select Operator {
      id,
      name,
      annotations: {
        name,
        @value
      } filter .name in {'std::identifier', 'std::description'},
      operator_kind,
      return_type: {id, name},
      return_typemod,
      params: {
        name,
        type: {id, name},
        kind,
        typemod,
      } order by @index,
    } filter not .internal and not .abstract
  `),i=new v0.StrictMap,s=new Set;for(let a of JSON.parse(n)){let o=(e=a.annotations.find(_=>_.name==="std::identifier"))===null||e===void 0?void 0:e["@value"];if(!o)continue;let{mod:u}=O0.util.splitName(a.name),c=`${u}::${o}`;i.has(c)||i.set(c,[]);let d={...a,name:c,kind:a.operator_kind,originalName:a.name,description:(t=a.annotations.find(_=>_.name==="std::description"))===null||t===void 0?void 0:t["@value"],annotations:void 0};(0,E0.replaceNumberTypes)(d);let h=S0(d);s.has(h)||(i.get(c).push(d),s.add(h))}return i};ni.operators=C0;function S0(r){return JSON.stringify({name:r.name,return_type:r.return_type.id,return_typemod:r.return_typemod,params:r.params.map(e=>JSON.stringify({kind:e.kind,type:e.type.id,typemod:e.typemod,hasDefault:!!e.hasDefault})).sort(),operator_kind:r.operator_kind})}});var jc=w(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.scalars=void 0;var I0=sr(),M0=async r=>{let e=await r.queryJSON(`with module schema
select InheritingObject {
  id,
  name,
  is_abstract,
  bases: { id, name },
  ancestors: { id, name },
  children := .<bases[IS Type] { id, name },
  descendants := .<ancestors[IS Type] { id, name }
}
FILTER
  InheritingObject IS ScalarType OR
  InheritingObject IS ObjectType;
`),t=new I0.StrictMap;for(let n of JSON.parse(e))t.set(n.id,n);return t};ii.scalars=M0});var Uc=w(Re=>{"use strict";var P0=Re&&Re.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),or=Re&&Re.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&P0(e,r,t)};Object.defineProperty(Re,"__esModule",{value:!0});or(Dc(),Re);or(qo(),Re);or(Nc(),Re);or(Bc(),Re);or(jc(),Re);or(Zn(),Re)});var Rc=w(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.analyzeQuery=void 0;var T0=Sn(),si=yt(),D0=xa(),Lc=V(),A0=wr(),xc=Tn(),N0=vn(),B0=_n(),j0=Ra(),U0=Jt(),ur=Tt(),$c=ut();async function L0(r,e){let t,i=await r.pool.acquireHolder($c.Options.defaults());try{t=await(await i._getConnection())._parse(e,ur.OutputFormat.BINARY,ur.Cardinality.MANY,$c.Session.defaults())}finally{await i.release()}let s=t[0],a=t[1],o=t[2],u=new Set,c=Nr(a,{indent:"",optionalNulls:!0,imports:u});return{result:qc(Nr(o,{indent:"",optionalNulls:!1,imports:u}),s),args:c,cardinality:s,query:e,imports:u}}ai.analyzeQuery=L0;function qc(r,e){switch(e){case ur.Cardinality.MANY:return`${r}[]`;case ur.Cardinality.ONE:return r;case ur.Cardinality.AT_MOST_ONE:return`${r} | null`;case ur.Cardinality.AT_LEAST_ONE:return`[(${r}), ...(${r})[]]`}throw Error(`unexpected cardinality: ${e}`)}function Nr(r,e){if(r instanceof B0.NullCodec)return"null";if(r instanceof Lc.ScalarCodec)return r instanceof D0.EnumCodec?`(${r.values.map(t=>JSON.stringify(t)).join(" | ")})`:(r.importedType&&e.imports.add(r.tsType),r.tsType);if(r instanceof xc.ObjectCodec||r instanceof A0.NamedTupleCodec){let t=r instanceof xc.ObjectCodec?r.getFields():r.getNames().map(i=>({name:i,cardinality:si.ONE})),n=r.getSubcodecs();return`{
${t.map((i,s)=>{let a=n[s];if(a instanceof j0.SetCodec){if(!(i.cardinality===si.MANY||i.cardinality===si.AT_LEAST_ONE))throw Error("subcodec is SetCodec, but upper cardinality is one");a=a.getSubcodecs()[0]}return`${e.indent}  ${JSON.stringify(i.name)}${e.optionalNulls&&i.cardinality===si.AT_MOST_ONE?"?":""}: ${qc(Nr(a,{...e,indent:e.indent+"  "}),i.cardinality)};`}).join(`
`)}
${e.indent}}`}if(r instanceof T0.ArrayCodec)return`${Nr(r.getSubcodecs()[0],e)}[]`;if(r instanceof U0.TupleCodec)return`[${r.getSubcodecs().map(t=>Nr(t,e)).join(", ")}]`;if(r instanceof N0.RangeCodec){let t=r.getSubcodecs()[0];if(!(t instanceof Lc.ScalarCodec))throw Error("expected range subtype to be scalar type");return e.imports.add("Range"),`Range<${t.tsType}>`}throw Error(`Unexpected codec kind: ${r.getKind()}`)}});var kc=w(ne=>{"use strict";var Fc=ne&&ne.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),x0=ne&&ne.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Mt=ne&&ne.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Fc(e,r,t)},$0=ne&&ne.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Fc(e,r,t);return x0(e,r),e};Object.defineProperty(ne,"__esModule",{value:!0});ne.introspect=void 0;Mt(Oc(),ne);Mt(Qn(),ne);Mt(Sc(),ne);Mt(Qn(),ne);Mt(sr(),ne);Mt(Ic(),ne);ne.introspect=$0(Uc());Mt(Rc(),ne)});var Ro=w(U=>{"use strict";var Hc=U&&U.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),q0=U&&U.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Wc=U&&U.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Hc(e,r,t);return q0(e,r),e},R0=U&&U.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Hc(e,r,t)};Object.defineProperty(U,"__esModule",{value:!0});U.$=U.defaultBackoff=U.Session=U.RetryOptions=U.RetryCondition=U.IsolationLevel=U._RawConnection=U.adapter=U.createHttpClient=U.createClient=void 0;var F0=Lo();U.default=F0.createClient;var Yc=Lo();Object.defineProperty(U,"createClient",{enumerable:!0,get:function(){return Yc.createClient}});Object.defineProperty(U,"createHttpClient",{enumerable:!0,get:function(){return Yc.createHttpClient}});var k0=Wc(Tr());U.adapter=k0;var H0=Bo();Object.defineProperty(U,"_RawConnection",{enumerable:!0,get:function(){return H0.RawConnection}});var oi=ut();Object.defineProperty(U,"IsolationLevel",{enumerable:!0,get:function(){return oi.IsolationLevel}});Object.defineProperty(U,"RetryCondition",{enumerable:!0,get:function(){return oi.RetryCondition}});Object.defineProperty(U,"RetryOptions",{enumerable:!0,get:function(){return oi.RetryOptions}});Object.defineProperty(U,"Session",{enumerable:!0,get:function(){return oi.Session}});var W0=ut();Object.defineProperty(U,"defaultBackoff",{enumerable:!0,get:function(){return W0.defaultBackoff}});R0(Ec(),U);U.$=Wc(kc())});var Y0={};zc(Y0,{CRUDService:()=>Fo,createClient:()=>Gc.createClient});module.exports=Zc(Y0);var ui=Ho(Ro(),1),Gc=Ho(Ro(),1),Fo=class{constructor(e){this.config=e;this.create=async e=>await this.client.transaction(async t=>{let{id:n}=await this.e.insert(this.eType,e).run(t);return await this.e.select(this.eType,()=>({...this.eFields,filter_single:{id:n}})).run(t)});this.updateById=async(e,t)=>await this.e.update(this.eType,()=>({set:t,filter_single:{id:e}})).run(this.client);this.findAll=async()=>await this.e.select(this.eType,()=>({...this.eFields})).run(this.client);this.findById=async e=>await this.e.select(this.eType,()=>({...this.eFields,filter_single:{id:e}})).run(this.client);this.deleteById=async e=>await this.e.delete(this.eType,()=>({filter_single:{id:e}})).run(this.client);this.findByField=async(e,t)=>await this.e.select(this.eType,i=>({...this.eFields,filter_single:this.e.op(i[e],"=",this.e.uuid(t))})).run(this.client);this.findAllByField=async(e,t)=>await this.e.select(this.eType,i=>({...this.eFields,filter:this.e.op(i[e],"=",this.e.uuid(t))})).run(this.client);this.findByFields=async e=>await this.e.select(this.eType,()=>({...this.eFields,filter_single:e})).run(this.client);e.client&&("options"in e.client||(this.client=(0,ui.default)(e.client)),this.client=this.client.withConfig({session_idle_transaction_timeout:ui.Duration.from({seconds:10}),allow_bare_ddl:"AlwaysAllow"}).withRetryOptions({attempts:3,backoff:t=>2**t*100+Math.random()*100})),this.e=this.config.edgedb,this.typeName=this.config.type,this.eType=this.e[this.typeName],this.eFields=this.eType["*"]}};0&&(module.exports={CRUDService,createClient});
/*! Bundled license information:

edgedb/dist/primitives/chars.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/compat.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/ifaces.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2020-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/primitives/buffer.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/errors/index.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/primitives/lru.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/consts.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/ifaces.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/boolean.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/numbers.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/numerics.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/text.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/uuid.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/bytes.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/json.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/datatypes/dateutil.js:
  (*!
   * Portions Copyright (c) 2019 MagicStack Inc. and the EdgeDB authors.
   * Portions Copyright (c) 2001-2019 Python Software Foundation.
   * All rights reserved.
   * Licence: PSFL https://docs.python.org/3/license.html
   *)

edgedb/dist/datatypes/datetime.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/datetime.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/datatypes/memory.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/memory.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/pgvector.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/codecs.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/tuple.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/datatypes/range.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/range.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/namedtuple.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/array.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/enum.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/object.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/set.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/utils.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2020-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/sparseObject.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/codecs/registry.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/primitives/event.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2021-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/primitives/queues.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2020-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/retry.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/baseClient.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2020-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/conUtils.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/errors/map.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/errors/resolve.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/baseConn.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/scram.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/fetchConn.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2022-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/rawConn.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/index.shared.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/reflection/strictMap.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2020-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/reflection/index.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2020-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

edgedb/dist/index.node.js:
  (*!
   * This source file is part of the EdgeDB open source project.
   *
   * Copyright 2019-present MagicStack Inc. and the EdgeDB authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
//# sourceMappingURL=index.cjs.map